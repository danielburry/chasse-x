"use strict";var me=Object.defineProperty,A=Object.getOwnPropertySymbols,ue=Object.prototype.hasOwnProperty,fe=Object.prototype.propertyIsEnumerable,U=(g,m,r)=>m in g?me(g,m,{enumerable:!0,configurable:!0,writable:!0,value:r}):g[m]=r,$=(g,m)=>{for(var r in m||(m={}))ue.call(m,r)&&U(g,r,m[r]);if(A)for(var r of A(m))fe.call(m,r)&&U(g,r,m[r]);return g};(self.webpackChunkchasse_pwa_front=self.webpackChunkchasse_pwa_front||[]).push([[9114],{49114:(g,m,r)=>{r.r(m),r.d(m,{default:()=>pe});var V=r(15861),o=r(17626),X=(r(29132),r(88879)),I=(r(65787),r(74333)),H=r(26584),Z=r(58817),f=r(62208),K=r(99959),Q=r(94113),E=r(14889),l=r(77712),S=(r(90912),r(68653)),R=r(76898),Y=r(99433),L=r(55915),k=r(13924),q=r(37053),_=r(32258),ee=(r(85931),r(8314),r(28705)),D=r(44917),G=r(552),P=r(99555),F=r(51815),te=r(82706);let h=class extends((0,G.h)((0,P.M)(D.Z))){constructor(e){super(e),this.elevationInfo=null,this.graphics=new F.J,this.screenSizePerspectiveEnabled=!0,this.type="graphics",this.internal=!1}destroy(){this.removeAll(),this.graphics.destroy()}add(e){return this.graphics.add(e),this}addMany(e){return this.graphics.addMany(e),this}removeAll(){return this.graphics.removeAll(),this}remove(e){this.graphics.remove(e)}removeMany(e){this.graphics.removeMany(e)}on(e,t){return super.on(e,t)}graphicChanged(e){this.emit("graphic-update",e)}};(0,o._)([(0,l.Cb)({type:te.ZP})],h.prototype,"elevationInfo",void 0),(0,o._)([(0,l.Cb)((0,ee.z)(F.J,"graphics"))],h.prototype,"graphics",void 0),(0,o._)([(0,l.Cb)({type:["show","hide"]})],h.prototype,"listMode",void 0),(0,o._)([(0,l.Cb)()],h.prototype,"screenSizePerspectiveEnabled",void 0),(0,o._)([(0,l.Cb)({readOnly:!0})],h.prototype,"type",void 0),(0,o._)([(0,l.Cb)({constructOnly:!0})],h.prototype,"internal",void 0),h=(0,o._)([(0,R.j)("esri.layers.GraphicsLayer")],h);const re=h;var oe=r(1476),ie=r(49286),ae=r(6647),W=r(36255),le=r(88493),ne=r(52068),z=r(57213),se=r(35540),O=r(65234),w=r(2004);function J(e){return e.layers.some(t=>null!=t.layerDefinition.visibilityField)}const B=new W.Z({name:"OBJECTID",alias:"OBJECTID",type:"oid",nullable:!1,editable:!1}),ye=new W.Z({name:"title",alias:"Title",type:"string",nullable:!0,editable:!0});let b=class extends re{constructor(e){super(e),this.visibilityMode="inherited"}initialize(){for(const e of this.graphics)e.sourceLayer=this.layer;this.graphics.on("after-add",e=>{e.item.sourceLayer=this.layer}),this.graphics.on("after-remove",e=>{e.item.sourceLayer=null})}get sublayers(){return this.graphics}};(0,o._)([(0,l.Cb)({readOnly:!0})],b.prototype,"sublayers",null),(0,o._)([(0,l.Cb)()],b.prototype,"layer",void 0),(0,o._)([(0,l.Cb)()],b.prototype,"layerId",void 0),(0,o._)([(0,l.Cb)({readOnly:!0})],b.prototype,"visibilityMode",void 0),b=(0,o._)([(0,R.j)("esri.layers.MapNotesLayer.MapNotesSublayer")],b);const j=[{geometryType:"polygon",geometryTypeJSON:"esriGeometryPolygon",id:"polygonLayer",layerId:0,title:"Polygons",identifyingSymbol:(new le.Z).toJSON()},{geometryType:"polyline",geometryTypeJSON:"esriGeometryPolyline",id:"polylineLayer",layerId:1,title:"Polylines",identifyingSymbol:(new ne.Z).toJSON()},{geometryType:"multipoint",geometryTypeJSON:"esriGeometryMultipoint",id:"multipointLayer",layerId:2,title:"Multipoints",identifyingSymbol:(new z.Z).toJSON()},{geometryType:"point",geometryTypeJSON:"esriGeometryPoint",id:"pointLayer",layerId:3,title:"Points",identifyingSymbol:(new z.Z).toJSON()},{geometryType:"point",geometryTypeJSON:"esriGeometryPoint",id:"textLayer",layerId:4,title:"Text",identifyingSymbol:(new se.Z).toJSON()}];let a=class extends((0,G.h)((0,P.M)((0,ie.q)((0,ae.I)((0,K.R)(D.Z)))))){constructor(e){super(e),this.capabilities={operations:{supportsMapNotesEditing:!0}},this.featureCollections=null,this.featureCollectionJSON=null,this.featureCollectionType="notes",this.legendEnabled=!1,this.minScale=0,this.maxScale=0,this.spatialReference=O.Z.WGS84,this.sublayers=new I.Z(j.map(t=>new b({id:t.id,layerId:t.layerId,title:t.title,layer:this}))),this.title="Map Notes",this.type="map-notes",this.visibilityMode="inherited"}readCapabilities(e,t,i){return{operations:{supportsMapNotesEditing:!J(t)&&"portal-item"!==(null==i?void 0:i.origin)}}}readFeatureCollections(e,t,i){if(!J(t))return null;const n=t.layers.map(y=>{const s=new _.default;return s.read(y,i),s});return new I.Z({items:n})}readLegacyfeatureCollectionJSON(e,t){return J(t)?(0,Z.d9)(t.featureCollection):null}readFullExtent(e,t){if(!t.layers.length||t.layers.every(n=>!n.layerDefinition.extent))return new w.Z({xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:O.Z.WGS84});const i=O.Z.fromJSON(t.layers[0].layerDefinition.spatialReference);return t.layers.reduce((n,y)=>{const s=y.layerDefinition.extent;return s?w.Z.fromJSON(s).union(n):n},new w.Z({spatialReference:i}))}readMinScale(e,t){for(const i of t.layers)if(null!=i.layerDefinition.minScale)return i.layerDefinition.minScale;return 0}readMaxScale(e,t){for(const i of t.layers)if(null!=i.layerDefinition.maxScale)return i.layerDefinition.maxScale;return 0}get multipointLayer(){return this._findSublayer("multipointLayer")}get pointLayer(){return this._findSublayer("pointLayer")}get polygonLayer(){return this._findSublayer("polygonLayer")}get polylineLayer(){return this._findSublayer("polylineLayer")}readSpatialReference(e,t){return t.layers.length?O.Z.fromJSON(t.layers[0].layerDefinition.spatialReference):O.Z.WGS84}readSublayers(e,t,i){var s,p;if(J(t))return null;const n=[];let y=t.layers.reduce((d,u)=>{var c;return Math.max(d,null!=(c=u.layerDefinition.id)?c:-1)},-1)+1;for(const{layerDefinition:d,featureSet:u}of t.layers){const c=null!=(s=d.geometryType)?s:u.geometryType,v=null!=(p=d.id)?p:y++,C=j.find(N=>{var T,M,x;return c===N.geometryTypeJSON&&(null==(x=null==(M=null==(T=d.drawingInfo)?void 0:T.renderer)?void 0:M.symbol)?void 0:x.type)===N.identifyingSymbol.type});if(C){const N=new b({id:C.id,title:d.name,layerId:v,layer:this,graphics:u.features.map(({geometry:T,symbol:M,attributes:x,popupInfo:de})=>X.Z.fromJSON({attributes:x,geometry:T,symbol:M,popupTemplate:de}))});n.push(N)}}return new I.Z(n)}writeSublayers(e,t,i,n){var c;const{minScale:y,maxScale:s}=this;if((0,f.Wi)(e))return;const p=e.some(v=>v.graphics.length>0);if(!this.capabilities.operations.supportsMapNotesEditing)return void(p&&(null==(c=null==n?void 0:n.messages)||c.push(new H.Z("map-notes-layer:editing-not-supported","New map notes cannot be added to this layer"))));const d=[];let u=this.spatialReference.toJSON();e:for(const v of e)for(const C of v.graphics)if((0,f.pC)(C.geometry)){u=C.geometry.spatialReference.toJSON();break e}for(const v of j){const C=e.find(N=>v.id===N.id);this._writeMapNoteSublayer(d,C,v,y,s,u,n)}(0,Q.RB)("featureCollection.layers",d,t)}get textLayer(){return this._findSublayer("textLayer")}load(e){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Feature Collection"]},e)),Promise.resolve(this)}read(e,t){"featureCollection"in e&&(e=(0,Z.d9)(e),Object.assign(e,e.featureCollection)),super.read(e,t)}beforeSave(){var e=this;return(0,V.Z)(function*(){if((0,f.Wi)(e.sublayers))return;let t=null;const i=[];for(const y of e.sublayers)for(const s of y.graphics)if((0,f.pC)(s.geometry)){const p=s.geometry;t?(0,q.fS)(p.spatialReference,t)||((0,L.Up)(p.spatialReference,t)||(0,L.kR)()||(yield(0,L.zD)()),s.geometry=(0,L.iV)(p,t)):t=p.spatialReference,i.push(s)}const n=yield(0,k.aX)(i.map(y=>y.geometry));i.forEach((y,s)=>y.geometry=n[s])})()}_findSublayer(e){var t,i;return(0,f.Wi)(this.sublayers)?null:null!=(i=null==(t=this.sublayers)?void 0:t.find(n=>n.id===e))?i:null}_writeMapNoteSublayer(e,t,i,n,y,s,p){const d=[];if(!(0,f.Wi)(t)){for(const u of t.graphics)this._writeMapNote(d,u,i.geometryType,p);this._normalizeObjectIds(d,B),e.push({layerDefinition:{name:t.title,drawingInfo:{renderer:{type:"simple",symbol:(0,Z.d9)(i.identifyingSymbol)}},id:t.layerId,geometryType:i.geometryTypeJSON,minScale:n,maxScale:y,objectIdField:"OBJECTID",fields:[B.toJSON(),ye.toJSON()],spatialReference:s},featureSet:{features:d,geometryType:i.geometryTypeJSON}})}}_writeMapNote(e,t,i,n){var u,c;if((0,f.Wi)(t))return;const{geometry:y,symbol:s,popupTemplate:p}=t;if((0,f.Wi)(y))return;if(y.type!==i)return void(null==(u=null==n?void 0:n.messages)||u.push(new E.Z("map-notes-layer:invalid-geometry-type",`Geometry "${y.type}" cannot be saved in "${i}" layer`,{graphic:t})));if((0,f.Wi)(s))return void(null==(c=null==n?void 0:n.messages)||c.push(new E.Z("map-notes-layer:no-symbol","Skipping map notes with no symbol",{graphic:t})));const d={attributes:$({},t.attributes),geometry:y.toJSON(),symbol:s.toJSON()};(0,f.pC)(p)&&(d.popupInfo=p.toJSON()),e.push(d)}_normalizeObjectIds(e,t){const i=t.name;let n=(0,oe.S)(i,e)+1;const y=new Set;for(const s of e){s.attributes||(s.attributes={});const{attributes:p}=s;(null==p[i]||y.has(p[i]))&&(p[i]=n++),y.add(p[i])}}};(0,o._)([(0,l.Cb)({readOnly:!0})],a.prototype,"capabilities",void 0),(0,o._)([(0,S.r)(["portal-item","web-map"],"capabilities",["layers"])],a.prototype,"readCapabilities",null),(0,o._)([(0,l.Cb)({readOnly:!0})],a.prototype,"featureCollections",void 0),(0,o._)([(0,S.r)(["web-map","portal-item"],"featureCollections",["layers"])],a.prototype,"readFeatureCollections",null),(0,o._)([(0,l.Cb)({readOnly:!0,json:{origins:{"web-map":{write:{enabled:!0,target:"featureCollection"}}}}})],a.prototype,"featureCollectionJSON",void 0),(0,o._)([(0,S.r)(["web-map","portal-item"],"featureCollectionJSON",["featureCollection"])],a.prototype,"readLegacyfeatureCollectionJSON",null),(0,o._)([(0,l.Cb)({readOnly:!0,json:{read:!1,write:{enabled:!0,ignoreOrigin:!0}}})],a.prototype,"featureCollectionType",void 0),(0,o._)([(0,l.Cb)({json:{write:!1}})],a.prototype,"fullExtent",void 0),(0,o._)([(0,S.r)(["web-map","portal-item"],"fullExtent",["layers"])],a.prototype,"readFullExtent",null),(0,o._)([(0,l.Cb)({readOnly:!0,json:{origins:{"web-map":{write:{target:"featureCollection.showLegend",overridePolicy(){return{enabled:null!=this.featureCollectionJSON}}}}}}})],a.prototype,"legendEnabled",void 0),(0,o._)([(0,l.Cb)({type:["show","hide"]})],a.prototype,"listMode",void 0),(0,o._)([(0,l.Cb)({type:Number,nonNullable:!0,json:{write:!1}})],a.prototype,"minScale",void 0),(0,o._)([(0,S.r)(["web-map","portal-item"],"minScale",["layers"])],a.prototype,"readMinScale",null),(0,o._)([(0,l.Cb)({type:Number,nonNullable:!0,json:{write:!1}})],a.prototype,"maxScale",void 0),(0,o._)([(0,S.r)(["web-map","portal-item"],"maxScale",["layers"])],a.prototype,"readMaxScale",null),(0,o._)([(0,l.Cb)({readOnly:!0})],a.prototype,"multipointLayer",null),(0,o._)([(0,l.Cb)({value:"ArcGISFeatureLayer",type:["ArcGISFeatureLayer"]})],a.prototype,"operationalLayerType",void 0),(0,o._)([(0,l.Cb)({readOnly:!0})],a.prototype,"pointLayer",null),(0,o._)([(0,l.Cb)({readOnly:!0})],a.prototype,"polygonLayer",null),(0,o._)([(0,l.Cb)({readOnly:!0})],a.prototype,"polylineLayer",null),(0,o._)([(0,l.Cb)({type:O.Z})],a.prototype,"spatialReference",void 0),(0,o._)([(0,S.r)(["web-map","portal-item"],"spatialReference",["layers"])],a.prototype,"readSpatialReference",null),(0,o._)([(0,l.Cb)({readOnly:!0,json:{origins:{"web-map":{write:{ignoreOrigin:!0}}}}})],a.prototype,"sublayers",void 0),(0,o._)([(0,S.r)("web-map","sublayers",["layers"])],a.prototype,"readSublayers",null),(0,o._)([(0,Y.c)("web-map","sublayers")],a.prototype,"writeSublayers",null),(0,o._)([(0,l.Cb)({readOnly:!0})],a.prototype,"textLayer",null),(0,o._)([(0,l.Cb)()],a.prototype,"title",void 0),(0,o._)([(0,l.Cb)({readOnly:!0,json:{read:!1}})],a.prototype,"type",void 0),a=(0,o._)([(0,R.j)("esri.layers.MapNotesLayer")],a);const pe=a}}]);