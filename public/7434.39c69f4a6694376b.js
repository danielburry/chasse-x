"use strict";var z=Object.defineProperty,G=Object.defineProperties,Q=Object.getOwnPropertyDescriptors,j=Object.getOwnPropertySymbols,J=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable,L=(d,a,e)=>a in d?z(d,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):d[a]=e,W=(d,a)=>{for(var e in a||(a={}))J.call(a,e)&&L(d,e,a[e]);if(j)for(var e of j(a))N.call(a,e)&&L(d,e,a[e]);return d},w=(d,a)=>G(d,Q(a));(self.webpackChunkchasse_pwa_front=self.webpackChunkchasse_pwa_front||[]).push([[7434],{67434:(d,a,e)=>{e.r(a),e.d(a,{default:()=>g});var p=e(15861),m=e(17626),c=(e(8314),e(62208)),u=(e(63290),e(90912),e(85931),e(82255),e(76898)),M=e(84682),D=e(36859),B=e(39351),A=e(13112),E=e(55376);class h{constructor(s,n){this.offset=s,this.extent=n}}let y=class extends A.Z{constructor(){super(...arguments),this.type="heatmap",this._tileKeyToFeatureSets=new Map}initialize(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))])}update(r,s){var n=this;return(0,p.Z)(function*(){const _=s.schema.processors[0];"heatmap"===_.type&&(0,M.Hg)(n._schema,_)&&(r.mesh=!0,n._schema=_)})()}onTileUpdate(r){for(const s of r.removed)this._tileKeyToFeatureSets.delete(s.key.id)}onTileClear(r){return this._tileKeyToFeatureSets.delete(r.key.id),this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:r.id,data:{clear:!0}})}onTileMessage(r,s,n){var _=this;return(0,p.Z)(function*(){_._tileKeyToFeatureSets.has(r.key.id)||_._tileKeyToFeatureSets.set(r.key.id,new Map);const t=_._tileKeyToFeatureSets.get(r.key.id);if((0,c.pC)(s.addOrUpdate)&&s.addOrUpdate.hasFeatures&&t.set(s.addOrUpdate.instance,s),s.end){const l=[],v=function S(r){const s=r.key,n=new Map,_=256,t=B.I_,l=r.tileInfoView.tileInfo.isWrappable;return n.set((0,E.M)(s,-1,-1,l).id,new h([-t,-t],[t-_,t-_,t,t])),n.set((0,E.M)(s,0,-1,l).id,new h([0,-t],[0,t-_,t,t])),n.set((0,E.M)(s,1,-1,l).id,new h([t,-t],[0,t-_,_,t])),n.set((0,E.M)(s,-1,0,l).id,new h([-t,0],[t-_,0,t,t])),n.set((0,E.M)(s,1,0,l).id,new h([t,0],[0,0,_,t])),n.set((0,E.M)(s,-1,1,l).id,new h([-t,t],[t-_,0,t,_])),n.set((0,E.M)(s,0,1,l).id,new h([0,t],[0,0,t,_])),n.set((0,E.M)(s,1,1,l).id,new h([t,t],[0,0,_,_])),n}(r);_._tileKeyToFeatureSets.forEach((R,C)=>{if(C===r.key.id)R.forEach(U=>(0,c.yw)(U.addOrUpdate,K=>l.push(K)));else if(v.has(C)){const U=v.get(C),[K,V]=U.offset;R.forEach(Z=>(0,c.yw)(Z.addOrUpdate,x=>{const H=x.transform(K,V,1,1);l.push(H)}))}});const I=(0,D.QM)(l,_._schema.mesh,512,512),k=[I.matrix];return _.remoteClient.invoke("tileRenderer.onTileData",{tileKey:r.key.id,intensityInfo:I},w(W({},n),{transferList:k}))}})()}onTileError(r,s,n){return this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:r.id,error:s},n)}};y=(0,m._)([(0,u.j)("esri.views.2d.layers.features.processors.HeatmapProcessor")],y);const g=y},55376:(d,a,e)=>{function T(c,f,O,P){const i=c.clone(),u=1<<i.level,M=i.col+f,D=i.row+O;return P&&M<0?(i.col=M+u,i.world-=1):M>=u?(i.col=M-u,i.world+=1):i.col=M,i.row=D,i}e.d(a,{M:()=>T}),e(81340)}}]);