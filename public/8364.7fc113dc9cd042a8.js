"use strict";var Ne=Object.defineProperty,re=Object.getOwnPropertySymbols,Le=Object.prototype.hasOwnProperty,Ae=Object.prototype.propertyIsEnumerable,se=(Q,U,T)=>U in Q?Ne(Q,U,{enumerable:!0,configurable:!0,writable:!0,value:T}):Q[U]=T,Zt=(Q,U)=>{for(var T in U||(U={}))Le.call(U,T)&&se(Q,T,U[T]);if(re)for(var T of re(U))Ae.call(U,T)&&se(Q,T,U[T]);return Q};(self.webpackChunkchasse_pwa_front=self.webpackChunkchasse_pwa_front||[]).push([[8364],{36243:(Q,U,T)=>{T.d(U,{Z:()=>R});class R{constructor(N){this._array=[],N<=0&&console.error("strideInBytes must be positive!"),this._stride=N}get array(){return this._array}get index(){return 4*this._array.length/this._stride}get itemSize(){return this._stride}get sizeInBytes(){return 4*this._array.length}reset(){this.array.length=0}toBuffer(){return new Uint32Array(this._array).buffer}static i1616to32(N,q){return 65535&N|q<<16}static i8888to32(N,q,i,a){return 255&N|(255&q)<<8|(255&i)<<16|a<<24}static i8816to32(N,q,i){return 255&N|(255&q)<<8|i<<16}}},919:(Q,U,T)=>{var R,v,N,q,i,a;T.d(U,{Fr:()=>i,_K:()=>q,al:()=>v}),(a=R||(R={}))[a.UNKNOWN=0]="UNKNOWN",a[a.FILL_VERTEX=1]="FILL_VERTEX",a[a.FILL_DD_VERTEX=2]="FILL_DD_VERTEX",a[a.FILL_INDEX=3]="FILL_INDEX",a[a.OUTLINE_VERTEX=4]="OUTLINE_VERTEX",a[a.OUTLINE_DD_VERTEX=5]="OUTLINE_DD_VERTEX",a[a.OUTLINE_INDEX=6]="OUTLINE_INDEX",a[a.LINE_VERTEX=7]="LINE_VERTEX",a[a.LINE_DD_VERTEX=8]="LINE_DD_VERTEX",a[a.LINE_INDEX=9]="LINE_INDEX",a[a.ICON_VERTEX=10]="ICON_VERTEX",a[a.ICON_DD_VERTEX=11]="ICON_DD_VERTEX",a[a.ICON_INDEX=12]="ICON_INDEX",a[a.TEXT_VERTEX=13]="TEXT_VERTEX",a[a.TEXT_DD_VERTEX=14]="TEXT_DD_VERTEX",a[a.TEXT_INDEX=15]="TEXT_INDEX",a[a.CIRCLE_VERTEX=16]="CIRCLE_VERTEX",a[a.CIRCLE_INDEX=17]="CIRCLE_INDEX",function(a){a[a.FILL=1]="FILL",a[a.LINE=2]="LINE",a[a.SYMBOL=3]="SYMBOL",a[a.CIRCLE=4]="CIRCLE"}(v||(v={})),function(a){a[a.BACKGROUND=0]="BACKGROUND",a[a.OPAQUE=1]="OPAQUE",a[a.TRANSLUCENT=2]="TRANSLUCENT",a[a.SYMBOLS=3]="SYMBOLS",a[a.HITTEST=4]="HITTEST"}(N||(N={})),function(a){a[a.BACKGROUND=0]="BACKGROUND",a[a.FILL=1]="FILL",a[a.OUTLINE=2]="OUTLINE",a[a.LINE=3]="LINE",a[a.ICON=4]="ICON",a[a.CIRCLE=5]="CIRCLE",a[a.TEXT=6]="TEXT",a[a.TILEINFO=7]="TILEINFO"}(q||(q={})),function(a){a[a.PAINTER_CHANGED=0]="PAINTER_CHANGED",a[a.LAYOUT_CHANGED=1]="LAYOUT_CHANGED",a[a.LAYER_CHANGED=2]="LAYER_CHANGED",a[a.LAYER_REMOVED=3]="LAYER_REMOVED",a[a.SPRITES_CHANGED=4]="SPRITES_CHANGED"}(i||(i={}))},77928:(Q,U,T)=>{T.d(U,{Et:()=>Ie,sj:()=>Re,Le:()=>Te,_L:()=>ve,gf:()=>we,jG:()=>De,nj:()=>be});var i,a,o,R=T(7547),v=T(919),N=T(62208),q=T(36243);(o=i||(i={}))[o.R8_SIGNED=0]="R8_SIGNED",o[o.R8_UNSIGNED=1]="R8_UNSIGNED",o[o.R16_SIGNED=2]="R16_SIGNED",o[o.R16_UNSIGNED=3]="R16_UNSIGNED",o[o.R8G8_SIGNED=4]="R8G8_SIGNED",o[o.R8G8_UNSIGNED=5]="R8G8_UNSIGNED",o[o.R16G16_SIGNED=6]="R16G16_SIGNED",o[o.R16G16_UNSIGNED=7]="R16G16_UNSIGNED",o[o.R8G8B8A8_SIGNED=8]="R8G8B8A8_SIGNED",o[o.R8G8B8A8_UNSIGNED=9]="R8G8B8A8_UNSIGNED",o[o.R8G8B8A8_COLOR=10]="R8G8B8A8_COLOR",o[o.R16G16B16A16_DASHARRAY=11]="R16G16B16A16_DASHARRAY",o[o.R16G16B16A16_PATTERN=12]="R16G16B16A16_PATTERN",function(o){o[o.UNIFORM=0]="UNIFORM",o[o.DATA_DRIVEN=1]="DATA_DRIVEN",o[o.INTERPOLATED_DATA_DRIVEN=2]="INTERPOLATED_DATA_DRIVEN",o[o.UNUSED=3]="UNUSED"}(a||(a={}));var l=T(67969),h=T(40852);class g{constructor(t){this._locations=new Map,this._key=t}get key(){return this._key}get type(){return 7&this._key}defines(){return[]}getStride(){return this._layoutInfo||this._buildAttributesInfo(),this._stride}getAttributeLocations(){return 0===this._locations.size&&this._buildAttributesInfo(),this._locations}getLayoutInfo(){return this._layoutInfo||this._buildAttributesInfo(),this._layoutInfo}getEncodingInfos(){return this._propertyEncodingInfo||this._buildAttributesInfo(),this._propertyEncodingInfo}getUniforms(){return this._uniforms||this._buildAttributesInfo(),this._uniforms}getShaderHeader(){return this._shaderHeader||this._buildAttributesInfo(),this._shaderHeader}getShaderMain(){return this._shaderMain||this._buildAttributesInfo(),this._shaderMain}setDataUniforms(t,e,r,s,n){const p=this.getUniforms();for(const u of p){const{name:c,type:y,getValue:m}=u,f=m(r,e,s,n);if(null!==f)switch(y){case"float":t.setUniform1f(c,f);break;case"vec2":t.setUniform2fv(c,f);break;case"vec4":t.setUniform4fv(c,f)}}}encodeAttributes(t,e,r,s){var m;const n=this.attributesInfo(),p=this.getEncodingInfos(),u=[];let c=0,y=0;for(const f of Object.keys(p)){const _=p[f],{type:w,precisionFactor:D,isLayout:K}=n[f],C=K?r.getLayoutProperty(f):r.getPaintProperty(f),nt=null==(m=C.interpolator)?void 0:m.getInterpolationRange(e);let O=0;for(const Y of _){const{offset:S,bufferElementsToAdd:Z}=Y;if(Z>0){for(let B=0;B<Z;B++)u.push(0);c+=y,y=Y.bufferElementsToAdd}const G=null!=s?s:C.getValue(nt?nt[O]:e,t);switch(w){case i.R8_SIGNED:case i.R8_UNSIGNED:u[c]|=this._encodeByte(G*(D||1),8*S);break;case i.R16_SIGNED:case i.R16_UNSIGNED:u[c]|=this._encodeShort(G*(D||1),8*S);break;case i.R8G8_SIGNED:case i.R8G8_UNSIGNED:u[c]|=this._encodeByte(G*(D||1),8*S),u[c]|=this._encodeByte(G*(D||1),8*S+8);break;case i.R16G16_SIGNED:case i.R16G16_UNSIGNED:u[c]|=this._encodeShort(G*(D||1),8*S),u[c]|=this._encodeShort(G*(D||1),8*S+16);break;case i.R8G8B8A8_SIGNED:case i.R8G8B8A8_UNSIGNED:u[c]|=this._encodeByte(G*(D||1),8*S),u[c]|=this._encodeByte(G*(D||1),8*S+8),u[c]|=this._encodeByte(G*(D||1),8*S+16),u[c]|=this._encodeByte(G*(D||1),8*S+24);break;case i.R8G8B8A8_COLOR:u[c]=this._encodeColor(G);break;case i.R16G16B16A16_DASHARRAY:case i.R16G16B16A16_PATTERN:this._encodePattern(c,u,G);break;default:throw new Error("Unsupported encoding type")}O++}}return u}getAtributeState(t){let e=0;const r=3+2*t;return e|=this._bit(r),e|=this._bit(r+1)<<1,e}_buildAttributesInfo(){const t=[],e={},r={};let s=-1;const n=this.attributesInfo(),p=this.attributes();let u=-1;for(const f of p){u++;const _=this.getAtributeState(u);if(_===a.UNIFORM||_===a.UNUSED)continue;const w=n[f],D=[];e[f]=D;const K=w.type;for(let C=0;C<_;C++){const{dataType:nt,bytesPerElement:O,count:Y,normalized:S}=g._encodingInfo[K],Z=O*Y,G=`${nt}-${!0===S}`;let B=r[G],W=0;if(!B||B.count+Y>4)s++,B={dataIndex:s,count:0,offset:0},4!==Y&&(r[G]=B),t.push({location:-1,name:"a_data_"+s,count:Y,type:nt,normalized:S}),W=Math.ceil(Math.max(Z/4,1));else{const J=t[B.dataIndex];J.count+=Y,W=Math.ceil(Math.max(J.count*O/4,1))-Math.ceil(Math.max(B.offset/4,1))}D.push({dataIndex:B.dataIndex,offset:B.offset,bufferElementsToAdd:W}),B.offset+=Z,B.count+=Y}}for(const f of t)switch(f.type){case l.g.BYTE:case l.g.UNSIGNED_BYTE:f.count=4;break;case l.g.SHORT:case l.g.UNSIGNED_SHORT:f.count+=f.count%2}this._buildVertexBufferLayout(t);let c=0;const y=this._layoutInfo.geometry;for(const f of y)this._locations.set(f.name,c++);const m=this._layoutInfo.opacity;if(m)for(const f of m)this._locations.set(f.name,c++);this._buildShaderInfo(t,e),this._propertyEncodingInfo=e}_buildVertexBufferLayout(t){const e={},r=this.geometryInfo();let s=r[0].stride;if(0===t.length)e.geometry=r;else{const n=[];let p=s;for(const u of t)s+=E(u.type)*u.count;for(const u of r)n.push(new h.G(u.name,u.count,u.type,u.offset,s,u.normalized));for(const u of t)n.push(new h.G(u.name,u.count,u.type,p,s,u.normalized)),p+=E(u.type)*u.count;e.geometry=n}this.opacityInfo()&&(e.opacity=this.opacityInfo()),this._layoutInfo=e,this._stride=s}_buildShaderInfo(t,e){let r="\n",s="\n";const n=[];for(const y of t)r+=`attribute ${this._getType(y.count)} ${y.name};\n`;const p=this.attributes(),u=this.attributesInfo();let c=-1;for(const y of p){c++;const{name:m,type:f,precisionFactor:_,isLayout:w}=u[y],D=_&&1!==_?" * "+1/_:"",{bytesPerElement:K,count:C}=g._encodingInfo[f],nt=O=>`a_data_${O.dataIndex}${I(C,O.offset,K)}`;switch(this.getAtributeState(c)){case a.UNIFORM:{const O=this._getType(C),Y=`u_${m}`;n.push({name:Y,type:O,getValue:(S,Z,G,B)=>{const W=w?S.getLayoutValue(y,Z):S.getPaintValue(y,Z);if(f===i.R16G16B16A16_DASHARRAY){const J=S.getDashKey(W,S.getLayoutValue("line-cap",Z)),yt=B.getMosaicItemPosition(J,!1);if((0,N.Wi)(yt))return null;const{tl:ft,br:ee}=yt;return[ft[0],ee[1],ee[0],ft[1]]}if(f===i.R16G16B16A16_PATTERN){const J=B.getMosaicItemPosition(W,!y.includes("line-"));if((0,N.Wi)(J))return null;const{tl:yt,br:ft}=J;return[yt[0],ft[1],ft[0],yt[1]]}if(f===i.R8G8B8A8_COLOR){const J=W[3];return[J*W[0],J*W[1],J*W[2],J]}return W}}),r+=`uniform ${O} ${Y};\n`,s+=`${O} ${m} = ${Y};\n`}break;case a.DATA_DRIVEN:{const O=nt(e[y][0]);s+=`${this._getType(C)} ${m} = ${O}${D};\n`}break;case a.INTERPOLATED_DATA_DRIVEN:{const O=`u_t_${m}`;n.push({name:O,type:"float",getValue:(Z,G,B,W)=>(w?Z.getLayoutProperty(y):Z.getPaintProperty(y)).interpolator.interpolationUniformValue(B,G)}),r+=`uniform float ${O};\n`;const Y=nt(e[y][0]),S=nt(e[y][1]);s+=`${this._getType(C)} ${m} = mix(${Y}${D}, ${S}${D}, ${O});\n`}}}this._shaderHeader=r,this._shaderMain=s,this._uniforms=n}_bit(t){return(this._key&1<<t)>>t}_getType(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4"}throw new Error("Invalid count")}_encodeColor(t){const e=255*t[3];return q.Z.i8888to32(t[0]*e,t[1]*e,t[2]*e,e)}_encodePattern(t,e,r){if(!r||!r.rect)return;const n=r.rect,p=r.width,u=r.height;e[t]=this._encodeShort(n.x+2,0),e[t]|=this._encodeShort(n.y+2+u,16),e[t+1]=this._encodeShort(n.x+2+p,0),e[t+1]|=this._encodeShort(n.y+2,16)}_encodeByte(t,e){return(255&t)<<e}_encodeShort(t,e){return(65535&t)<<e}}g._encodingInfo={[i.R8_SIGNED]:{dataType:l.g.BYTE,bytesPerElement:1,count:1,normalized:!1},[i.R8_UNSIGNED]:{dataType:l.g.UNSIGNED_BYTE,bytesPerElement:1,count:1,normalized:!1},[i.R16_SIGNED]:{dataType:l.g.SHORT,bytesPerElement:2,count:1,normalized:!1},[i.R16_UNSIGNED]:{dataType:l.g.UNSIGNED_SHORT,bytesPerElement:2,count:1,normalized:!1},[i.R8G8_SIGNED]:{dataType:l.g.BYTE,bytesPerElement:1,count:2,normalized:!1},[i.R8G8_UNSIGNED]:{dataType:l.g.UNSIGNED_BYTE,bytesPerElement:1,count:2,normalized:!1},[i.R16G16_SIGNED]:{dataType:l.g.SHORT,bytesPerElement:2,count:2,normalized:!1},[i.R16G16_UNSIGNED]:{dataType:l.g.UNSIGNED_SHORT,bytesPerElement:2,count:2,normalized:!1},[i.R8G8B8A8_SIGNED]:{dataType:l.g.BYTE,bytesPerElement:1,count:4,normalized:!1},[i.R8G8B8A8_UNSIGNED]:{dataType:l.g.UNSIGNED_BYTE,bytesPerElement:1,count:4,normalized:!1},[i.R8G8B8A8_COLOR]:{dataType:l.g.UNSIGNED_BYTE,bytesPerElement:1,count:4,normalized:!0},[i.R16G16B16A16_DASHARRAY]:{dataType:l.g.UNSIGNED_SHORT,bytesPerElement:2,count:4,normalized:!1},[i.R16G16B16A16_PATTERN]:{dataType:l.g.UNSIGNED_SHORT,bytesPerElement:2,count:4,normalized:!1}};const E=o=>{switch(o){case l.g.FLOAT:case l.g.INT:case l.g.UNSIGNED_INT:return 4;case l.g.SHORT:case l.g.UNSIGNED_SHORT:return 2;case l.g.BYTE:case l.g.UNSIGNED_BYTE:return 1}},I=(o,t,e)=>{const r=t/e;if(1===o)switch(r){case 0:return".x";case 1:return".y";case 2:return".z";case 3:return".w"}else if(2===o)switch(r){case 0:return".xy";case 1:return".yz";case 2:return".zw"}else if(3===o)switch(r){case 0:return".xyz";case 1:return".yzw"}return""};class A extends g{constructor(t){super(t)}geometryInfo(){return A.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return A.ATTRIBUTES}attributesInfo(){return A.ATTRIBUTES_INFO}}A.ATTRIBUTES=[],A.GEOMETRY_LAYOUT=[new h.G("a_pos",2,l.g.BYTE,0,2)],A.ATTRIBUTES_INFO={};class F extends g{constructor(t){super(t)}geometryInfo(){return F.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return F.ATTRIBUTES}attributesInfo(){return F.ATTRIBUTES_INFO}}F.ATTRIBUTES=["circle-radius","circle-color","circle-opacity","circle-stroke-width","circle-stroke-color","circle-stroke-opacity","circle-blur"],F.GEOMETRY_LAYOUT=[new h.G("a_pos",2,l.g.SHORT,0,4)],F.ATTRIBUTES_INFO={"circle-radius":{name:"radius",type:i.R8_UNSIGNED},"circle-color":{name:"color",type:i.R8G8B8A8_COLOR},"circle-opacity":{name:"opacity",type:i.R8_UNSIGNED,precisionFactor:100},"circle-stroke-width":{name:"stroke_width",type:i.R8_UNSIGNED,precisionFactor:4},"circle-stroke-color":{name:"stroke_color",type:i.R8G8B8A8_COLOR},"circle-stroke-opacity":{name:"stroke_opacity",type:i.R8_UNSIGNED,precisionFactor:100},"circle-blur":{name:"blur",type:i.R8_UNSIGNED,precisionFactor:32}};class z extends g{constructor(t){super(t)}geometryInfo(){return z.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return z.ATTRIBUTES}attributesInfo(){return z.ATTRIBUTES_INFO}}z.ATTRIBUTES=["fill-color","fill-opacity","fill-pattern"],z.GEOMETRY_LAYOUT=[new h.G("a_pos",2,l.g.SHORT,0,4)],z.ATTRIBUTES_INFO={"fill-color":{name:"color",type:i.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:i.R8_UNSIGNED,precisionFactor:100},"fill-pattern":{name:"tlbr",type:i.R16G16B16A16_PATTERN,isOptional:!0}};class V extends g{constructor(t,e){super(t),this.usefillColor=e}geometryInfo(){return V.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return this.usefillColor?V.ATTRIBUTES_FILL:V.ATTRIBUTES_OUTLINE}attributesInfo(){return this.usefillColor?V.ATTRIBUTES_INFO_FILL:V.ATTRIBUTES_INFO_OUTLINE}}V.ATTRIBUTES_OUTLINE=["fill-outline-color","fill-opacity"],V.ATTRIBUTES_FILL=["fill-color","fill-opacity"],V.GEOMETRY_LAYOUT=[new h.G("a_pos",2,l.g.SHORT,0,8),new h.G("a_offset",2,l.g.BYTE,4,8),new h.G("a_xnormal",2,l.g.BYTE,6,8)],V.ATTRIBUTES_INFO_OUTLINE={"fill-outline-color":{name:"color",type:i.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:i.R8_UNSIGNED,precisionFactor:100}},V.ATTRIBUTES_INFO_FILL={"fill-color":{name:"color",type:i.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:i.R8_UNSIGNED,precisionFactor:100}};class et extends g{constructor(t){super(t)}geometryInfo(){return et.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return et.ATTRIBUTES}attributesInfo(){return et.ATTRIBUTES_INFO}}et.ATTRIBUTES=["line-blur","line-color","line-gap-width","line-offset","line-opacity","line-width","line-pattern","line-dasharray"],et.GEOMETRY_LAYOUT=[new h.G("a_pos",2,l.g.SHORT,0,16),new h.G("a_extrude_offset",4,l.g.BYTE,4,16),new h.G("a_dir_normal",4,l.g.BYTE,8,16),new h.G("a_accumulatedDistance",2,l.g.UNSIGNED_SHORT,12,16)],et.ATTRIBUTES_INFO={"line-width":{name:"width",type:i.R8_UNSIGNED,precisionFactor:2},"line-gap-width":{name:"gap_width",type:i.R8_UNSIGNED,precisionFactor:2},"line-offset":{name:"offset",type:i.R8_SIGNED,precisionFactor:2},"line-color":{name:"color",type:i.R8G8B8A8_COLOR},"line-opacity":{name:"opacity",type:i.R8_UNSIGNED,precisionFactor:100},"line-blur":{name:"blur",type:i.R8_UNSIGNED,precisionFactor:4},"line-pattern":{name:"tlbr",type:i.R16G16B16A16_PATTERN,isOptional:!0},"line-dasharray":{name:"tlbr",type:i.R16G16B16A16_DASHARRAY,isOptional:!0}};const Wt=[new h.G("a_pos",2,l.g.SHORT,0,16),new h.G("a_vertexOffset",2,l.g.SHORT,4,16),new h.G("a_texAngleRange",4,l.g.UNSIGNED_BYTE,8,16),new h.G("a_levelInfo",4,l.g.UNSIGNED_BYTE,12,16)],Jt=[new h.G("a_opacityInfo",1,l.g.UNSIGNED_BYTE,0,1)];class at extends g{constructor(t){super(t)}geometryInfo(){return Wt}opacityInfo(){return Jt}attributes(){return at.ATTRIBUTES}attributesInfo(){return at.ATTRIBUTES_INFO}}at.ATTRIBUTES=["icon-color","icon-opacity","icon-halo-blur","icon-halo-color","icon-halo-width","icon-size"],at.ATTRIBUTES_INFO={"icon-color":{name:"color",type:i.R8G8B8A8_COLOR},"icon-opacity":{name:"opacity",type:i.R8_UNSIGNED,precisionFactor:100},"icon-halo-color":{name:"halo_color",type:i.R8G8B8A8_COLOR},"icon-halo-width":{name:"halo_width",type:i.R8_UNSIGNED,precisionFactor:4},"icon-halo-blur":{name:"halo_blur",type:i.R8_UNSIGNED,precisionFactor:4},"icon-size":{name:"size",type:i.R8_UNSIGNED,precisionFactor:32,isLayout:!0}};class it extends g{constructor(t){super(t)}geometryInfo(){return Wt}opacityInfo(){return Jt}attributes(){return it.ATTRIBUTES}attributesInfo(){return it.ATTRIBUTES_INFO}}it.ATTRIBUTES=["text-color","text-opacity","text-halo-blur","text-halo-color","text-halo-width","text-size"],it.ATTRIBUTES_INFO={"text-color":{name:"color",type:i.R8G8B8A8_COLOR},"text-opacity":{name:"opacity",type:i.R8_UNSIGNED,precisionFactor:100},"text-halo-color":{name:"halo_color",type:i.R8G8B8A8_COLOR},"text-halo-width":{name:"halo_width",type:i.R8_UNSIGNED,precisionFactor:4},"text-halo-blur":{name:"halo_blur",type:i.R8_UNSIGNED,precisionFactor:4},"text-size":{name:"size",type:i.R8_UNSIGNED,isLayout:!0}};var x=T(91558),ut=T(78260),ne=T(78041),M=T(86575);const Qt={kind:"null"},b={kind:"number"},j={kind:"string"},k={kind:"boolean"},rt={kind:"color"},gt={kind:"object"},st={kind:"value"};function ht(o,t){return{kind:"array",itemType:o,n:t}}const ae=[Qt,b,j,k,rt,gt,ht(st)];function ct(o){if("array"===o.kind){const t=ct(o.itemType);return"number"==typeof o.n?`array<${t}, ${o.n}>`:"value"===o.itemType.kind?"array":`array<${t}>`}return o.kind}function dt(o){if(null===o)return Qt;if("string"==typeof o)return j;if("boolean"==typeof o)return k;if("number"==typeof o)return b;if(o instanceof x.Z)return rt;if(Array.isArray(o)){let t;for(const e of o){const r=dt(e);if(t){if(t!==r){t=st;break}}else t=r}return ht(t||st,o.length)}return"object"==typeof o?gt:st}function Dt(o,t){if("array"===t.kind)return"array"===o.kind&&(0===o.n&&"value"===o.itemType.kind||Dt(o.itemType,t.itemType))&&("number"!=typeof t.n||t.n===o.n);if("value"===t.kind)for(const e of ae)if(Dt(o,e))return!0;return t.kind===o.kind}function Rt(o){if(null===o)return"";const t=typeof o;return"string"===t?o:"number"===t||"boolean"===t?String(o):o instanceof x.Z?o.toString():JSON.stringify(o)}var vt=T(97938);class ie{constructor(t){this.parent=t,this.vars={}}add(t,e){this.vars[t]=e}get(t){return this.vars[t]?this.vars[t]:this.parent?this.parent.get(t):null}}class bt{constructor(){this.type=st}static parse(t){if(t.length>1)throw new Error('"id" does not expect arguments');return new bt}evaluate(t,e){return null==t?void 0:t.id}}class Nt{constructor(){this.type=j}static parse(t){if(t.length>1)throw new Error('"geometry-type" does not expect arguments');return new Nt}evaluate(t,e){if(!t)return null;switch(t.type){case vt.V.Point:return"Point";case vt.V.LineString:return"LineString";case vt.V.Polygon:return"Polygon";default:return null}}}class Lt{constructor(){this.type=gt}static parse(t){if(t.length>1)throw new Error('"properties" does not expect arguments');return new Lt}evaluate(t,e){return null==t?void 0:t.values}}class mt{constructor(){this.type=b}static parse(t){if(t.length>1)throw new Error('"zoom" does not expect arguments');return new mt}evaluate(t,e){return e}}class X{constructor(t,e,r){this.lhs=t,this.rhs=e,this.compare=r,this.type=k}static parse(t,e,r){if(3!==t.length&&4!==t.length)throw new Error(`"${t[0]}" expects 2 or 3 arguments`);if(4===t.length)throw new Error(`"${t[0]}" collator not supported`);return new X(d(t[1],e),d(t[2],e),r)}evaluate(t,e){return this.compare(this.lhs.evaluate(t,e),this.rhs.evaluate(t,e))}}class At{constructor(t){this.arg=t,this.type=k}static parse(t,e){if(2!==t.length)throw new Error('"!" expects 1 argument');return new At(d(t[1],e))}evaluate(t,e){return!this.arg.evaluate(t,e)}}class St{constructor(t){this.args=t,this.type=k}static parse(t,e){const r=[];for(let s=1;s<t.length;s++)r.push(d(t[s],e));return new St(r)}evaluate(t,e){for(const r of this.args)if(!r.evaluate(t,e))return!1;return!0}}class xt{constructor(t){this.args=t,this.type=k}static parse(t,e){const r=[];for(let s=1;s<t.length;s++)r.push(d(t[s],e));return new xt(r)}evaluate(t,e){for(const r of this.args)if(r.evaluate(t,e))return!0;return!1}}class Pt{constructor(t){this.args=t,this.type=k}static parse(t,e){const r=[];for(let s=1;s<t.length;s++)r.push(d(t[s],e));return new Pt(r)}evaluate(t,e){for(const r of this.args)if(r.evaluate(t,e))return!1;return!0}}class Ut{constructor(t,e,r){this.type=t,this.args=e,this.fallback=r}static parse(t,e,r){if(t.length<4)throw new Error('"case" expects at least 3 arguments');if(t.length%2==1)throw new Error('"case" expects an odd number of arguments');let s;const n=[];for(let u=1;u<t.length-1;u+=2){const c=d(t[u],e),y=d(t[u+1],e,r);s||(s=y.type),n.push({condition:c,output:y})}const p=d(t[t.length-1],e,r);return s||(s=p.type),new Ut(s,n,p)}evaluate(t,e){for(const r of this.args)if(r.condition.evaluate(t,e))return r.output.evaluate(t,e);return this.fallback.evaluate(t,e)}}class Ot{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)throw new Error('"coalesce" expects at least 1 argument');let r;const s=[];for(let n=1;n<t.length;n++){const p=d(t[n],e);r||(r=p.type),s.push(p)}return new Ot(r,s)}evaluate(t,e){for(const r of this.args){const s=r.evaluate(t,e);if(null!==s)return s}return null}}class Gt{constructor(t,e,r,s,n){this.type=t,this.input=e,this.labels=r,this.outputs=s,this.fallback=n}static parse(t,e){if(t.length<3)throw new Error('"match" expects at least 3 arguments');if(t.length%2==0)throw new Error('"case" expects an even number of arguments');let r;const s=d(t[1],e),n=[],p={};let u;for(let c=2;c<t.length-1;c+=2){let y=t[c];Array.isArray(y)||(y=[y]);for(const f of y){const _=typeof f;if("string"!==_&&"number"!==_)throw new Error('"match" requires string or number literal as labels');if(u){if(_!==u)throw new Error('"match" requires labels to have the same type')}else u=_;p[f]=n.length}const m=d(t[c+1],e);r||(r=m.type),n.push(m)}return new Gt(r,s,p,n,d(t[t.length-1],e))}evaluate(t,e){const r=this.input.evaluate(t,e);return(this.outputs[this.labels[r]]||this.fallback).evaluate(t,e)}}class tt{constructor(t,e,r,s,n){this.operator=t,this.type=e,this.interpolation=r,this.input=s,this.stops=n}static parse(t,e,r){const s=t[0];if(t.length<5)throw new Error(`"${s}" expects at least 4 arguments`);const n=t[1];if(!Array.isArray(n)||0===n.length)throw new Error(`"${n}" is not a valid interpolation`);switch(n[0]){case"linear":if(1!==n.length)throw new Error("Linear interpolation cannot have parameters");break;case"exponential":if(2!==n.length||"number"!=typeof n[1])throw new Error("Exponential interpolation requires one numeric argument");break;case"cubic-bezier":if(5!==n.length)throw new Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1");for(let y=1;y<5;y++){const m=n[y];if("number"!=typeof m||m<0||m>1)throw new Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1")}break;default:throw new Error(`"${t[0]}" unknown interpolation type "${n[0]}"`)}if(t.length%2!=1)throw new Error(`"${s}" expects an even number of arguments`);const p=d(t[2],e,b);let u;"interpolate-hcl"===s||"interpolate-lab"===s?u=rt:r&&"value"!==r.kind&&(u=r);const c=[];for(let y=3;y<t.length;y+=2){const m=t[y];if("number"!=typeof m)throw new Error(`"${s}" requires stop inputs as literal numbers`);if(c.length&&c[c.length-1][0]>=m)throw new Error(`"${s}" requires strictly ascending stop inputs`);const f=d(t[y+1],e,u);u||(u=f.type),c.push([m,f])}if(u&&u!==rt&&u!==b&&("array"!==u.kind||u.itemType!==b))throw new Error(`"${s}" cannot interpolate type ${ct(u)}`);return new tt(s,u,n,p,c)}evaluate(t,e){const r=this.stops;if(1===r.length)return r[0][1].evaluate(t,e);const s=this.input.evaluate(t,e);if(s<=r[0][0])return r[0][1].evaluate(t,e);if(s>=r[r.length-1][0])return r[r.length-1][1].evaluate(t,e);let n=0;for(;++n<r.length&&!(s<r[n][0]););const c=tt.interpolationRatio(this.interpolation,s,r[n-1][0],r[n][0]),y=r[n-1][1].evaluate(t,e),m=r[n][1].evaluate(t,e);if("interpolate"===this.operator){if("array"===this.type.kind&&Array.isArray(y)&&Array.isArray(m))return y.map((f,_)=>(0,M.sX)(f,m[_],c));if("color"===this.type.kind&&y instanceof x.Z&&m instanceof x.Z){const f=new x.Z(y),_=new x.Z(m);return new x.Z([(0,M.sX)(f.r,_.r,c),(0,M.sX)(f.g,_.g,c),(0,M.sX)(f.b,_.b,c),(0,M.sX)(f.a,_.a,c)])}if("number"===this.type.kind&&"number"==typeof y&&"number"==typeof m)return(0,M.sX)(y,m,c);throw new Error(`"${this.operator}" cannot interpolate type ${ct(this.type)}`)}if("interpolate-hcl"===this.operator){const f=(0,ut.sJ)(y),_=(0,ut.sJ)(m),w=_.h-f.h,D=(0,ut.xr)({h:f.h+c*(w>180||w<-180?w-360*Math.round(w/360):w),c:(0,M.sX)(f.c,_.c,c),l:(0,M.sX)(f.l,_.l,c)});return new x.Z(Zt({a:(0,M.sX)(y.a,m.a,c)},D))}if("interpolate-lab"===this.operator){const f=(0,ut.Y3)(y),_=(0,ut.Y3)(m),w=(0,ut.xr)({l:(0,M.sX)(f.l,_.l,c),a:(0,M.sX)(f.a,_.a,c),b:(0,M.sX)(f.b,_.b,c)});return new x.Z(Zt({a:(0,M.sX)(y.a,m.a,c)},w))}throw new Error(`Unexpected operator "${this.operator}"`)}interpolationUniformValue(t,e){const r=this.stops;if(1===r.length||t>=r[r.length-1][0])return 0;let s=0;for(;++s<r.length&&!(t<r[s][0]););return tt.interpolationRatio(this.interpolation,e,r[s-1][0],r[s][0])}getInterpolationRange(t){const e=this.stops;if(1===e.length){const n=e[0][0];return[n,n]}const r=e[e.length-1][0];if(t>=r)return[r,r];let s=0;for(;++s<e.length&&!(t<e[s][0]););return[e[s-1][0],e[s][0]]}static interpolationRatio(t,e,r,s){let n=0;return"linear"===t[0]?n=tt._exponentialInterpolationRatio(e,1,r,s):"exponential"===t[0]?n=tt._exponentialInterpolationRatio(e,t[1],r,s):"cubic-bezier"===t[0]&&(n=(0,ne.n_)(t[1],t[2],t[3],t[4])(tt._exponentialInterpolationRatio(e,1,r,s),1e-5)),n<0?n=0:n>1&&(n=1),n}static _exponentialInterpolationRatio(t,e,r,s){const n=s-r;if(0===n)return 0;const p=t-r;return 1===e?p/n:(e**p-1)/(e**n-1)}}class Bt{constructor(t,e,r){this.type=t,this.input=e,this.stops=r}static parse(t,e){if(t.length<5)throw new Error('"step" expects at least 4 arguments');if(t.length%2!=1)throw new Error('"step" expects an even number of arguments');const r=d(t[1],e,b);let s;const n=[];n.push([-1/0,d(t[2],e)]);for(let p=3;p<t.length;p+=2){const u=t[p];if("number"!=typeof u)throw new Error('"step" requires stop inputs as literal numbers');if(n.length&&n[n.length-1][0]>=u)throw new Error('"step" requires strictly ascending stop inputs');const c=d(t[p+1],e);s||(s=c.type),n.push([u,c])}return new Bt(s,r,n)}evaluate(t,e){const r=this.stops;if(1===r.length)return r[0][1].evaluate(t,e);const s=this.input.evaluate(t,e);let n=0;for(;++n<r.length&&!(s<r[n][0]););return this.stops[n-1][1].evaluate(t,e)}}class kt{constructor(t,e){this.type=t,this.output=e}static parse(t,e,r){if(t.length<4)throw new Error('"let" expects at least 3 arguments');if(t.length%2==1)throw new Error('"let" expects an odd number of arguments');const s=new ie(e);for(let p=1;p<t.length-1;p+=2){const u=t[p];if("string"!=typeof u)throw new Error(`"let" requires a string to define variable names - found ${u}`);s.add(u,d(t[p+1],e))}const n=d(t[t.length-1],s,r);return new kt(n.type,n)}evaluate(t,e){return this.output.evaluate(t,e)}}class Ct{constructor(t,e){this.type=t,this.output=e}static parse(t,e,r){if(2!==t.length||"string"!=typeof t[1])throw new Error('"var" requires just one literal string argument');const s=e.get(t[1]);if(!s)throw new Error(`${t[1]} must be defined before being used in a "var" expression`);return new Ct(r||st,s)}evaluate(t,e){return this.output.evaluate(t,e)}}class Vt{constructor(t,e,r){this.type=t,this.index=e,this.array=r}static parse(t,e){if(3!==t.length)throw new Error('"at" expects 2 arguments');const r=d(t[1],e,b),s=d(t[2],e);return new Vt(s.type.itemType,r,s)}evaluate(t,e){const r=this.index.evaluate(t,e),s=this.array.evaluate(t,e);if(r<0||r>=s.length)throw new Error('"at" index out of bounds');if(r!==Math.floor(r))throw new Error('"at" index must be an integer');return s[r]}}class _t{constructor(t,e){this.key=t,this.obj=e,this.type=st}static parse(t,e){let r,s;switch(t.length){case 2:return r=d(t[1],e),new _t(r);case 3:return r=d(t[1],e),s=d(t[2],e),new _t(r,s);default:throw new Error('"get" expects 1 or 2 arguments')}}evaluate(t,e){const r=this.key.evaluate(t,e);return this.obj?this.obj.evaluate(t,e)[r]:null==t?void 0:t.values[r]}}class Et{constructor(t,e){this.key=t,this.obj=e,this.type=k}static parse(t,e){let r,s;switch(t.length){case 2:return r=d(t[1],e),new Et(r);case 3:return r=d(t[1],e),s=d(t[2],e),new Et(r,s);default:throw new Error('"has" expects 1 or 2 arguments')}}evaluate(t,e){const r=this.key.evaluate(t,e);return this.obj?r in this.obj.evaluate(t,e):!!(null==t?void 0:t.values[r])}}class Ft{constructor(t,e){this.key=t,this.vals=e,this.type=k}static parse(t,e){if(3!==t.length)throw new Error('"in" expects 2 arguments');return new Ft(d(t[1],e),d(t[2],e))}evaluate(t,e){const r=this.key.evaluate(t,e);return this.vals.evaluate(t,e).includes(r)}}class It{constructor(t,e,r){this.item=t,this.array=e,this.from=r,this.type=b}static parse(t,e){if(t.length<3||t.length>4)throw new Error('"index-of" expects 3 or 4 arguments');const r=d(t[1],e),s=d(t[2],e);if(4===t.length){const n=d(t[3],e,b);return new It(r,s,n)}return new It(r,s)}evaluate(t,e){const r=this.item.evaluate(t,e),s=this.array.evaluate(t,e);if(this.from){const n=this.from.evaluate(t,e);if(n!==Math.floor(n))throw new Error('"index-of" index must be an integer');return s.indexOf(r,n)}return s.indexOf(r)}}class zt{constructor(t){this.arg=t,this.type=b}static parse(t,e){if(2!==t.length)throw new Error('"length" expects 2 arguments');const r=d(t[1],e);return new zt(r)}evaluate(t,e){const r=this.arg.evaluate(t,e);if("string"==typeof r||Array.isArray(r))return r.length;throw new Error('"length" expects string or array')}}class Tt{constructor(t,e,r,s){this.type=t,this.array=e,this.from=r,this.to=s}static parse(t,e){if(t.length<3||t.length>4)throw new Error('"slice" expects 2 or 3 arguments');const r=d(t[1],e),s=d(t[2],e,b);if(s.type!==b)throw new Error('"slice" index must return a number');if(4===t.length){const n=d(t[3],e,b);if(n.type!==b)throw new Error('"slice" index must return a number');return new Tt(r.type,r,s,n)}return new Tt(r.type,r,s)}evaluate(t,e){const r=this.array.evaluate(t,e);if(!Array.isArray(r)&&"string"!=typeof r)throw new Error('"slice" input must be an array or a string');const s=this.from.evaluate(t,e);if(s<0||s>=r.length)throw new Error('"slice" index out of bounds');if(s!==Math.floor(s))throw new Error('"slice" index must be an integer');if(this.to){const n=this.to.evaluate(t,e);if(n<0||n>=r.length)throw new Error('"slice" index out of bounds');if(n!==Math.floor(n))throw new Error('"slice" index must be an integer');return r.slice(s,n)}return r.slice(s)}}class Mt{constructor(){this.type=k}static parse(t){if(1!==t.length)throw new Error('"has-id" expects no arguments');return new Mt}evaluate(t,e){return t&&void 0!==t.id}}class ${constructor(t,e){this.args=t,this.calculate=e,this.type=b}static parse(t,e,r){const s=t.slice(1).map(n=>d(n,e));return new $(s,r)}evaluate(t,e){let r;return this.args&&(r=this.args.map(s=>s.evaluate(t,e))),this.calculate(r)}}let P=(()=>{class o{constructor(e,r){this.args=e,this.calculate=r,this.type=b}static parse(e,r){const s=e.slice(1).map(n=>d(n,r));return new o(s,o.ops[e[0]])}evaluate(e,r){let s;return this.args&&(s=this.args.map(n=>n.evaluate(e,r))),this.calculate(s)}}return o.ops={abs:t=>Math.abs(t[0]),acos:t=>Math.acos(t[0]),asin:t=>Math.asin(t[0]),atan:t=>Math.atan(t[0]),ceil:t=>Math.ceil(t[0]),cos:t=>Math.cos(t[0]),e:()=>Math.E,floor:t=>Math.floor(t[0]),ln:t=>Math.log(t[0]),ln2:()=>Math.LN2,log10:t=>Math.log(t[0])/Math.LN10,log2:t=>Math.log(t[0])/Math.LN2,max:t=>Math.max(...t),min:t=>Math.min(...t),pi:()=>Math.PI,round:t=>Math.round(t[0]),sin:t=>Math.sin(t[0]),sqrt:t=>Math.sqrt(t[0]),tan:t=>Math.tan(t[0])},o})();class $t{constructor(t){this.args=t,this.type=j}static parse(t,e){return new $t(t.slice(1).map(r=>d(r,e)))}evaluate(t,e){return this.args.map(r=>r.evaluate(t,e)).join("")}}let qt=(()=>{class o{constructor(e,r){this.arg=e,this.calculate=r,this.type=j}static parse(e,r){if(2!==e.length)throw new Error(`${e[0]} expects 1 argument`);const s=d(e[1],r);return new o(s,o.ops[e[0]])}evaluate(e,r){return this.calculate(this.arg.evaluate(e,r))}}return o.ops={downcase:t=>t.toLowerCase(),upcase:t=>t.toUpperCase()},o})();class Yt{constructor(t){this.args=t,this.type=rt}static parse(t,e){if(4!==t.length)throw new Error('"rgb" expects 3 arguments');const r=t.slice(1).map(s=>d(s,e));return new Yt(r)}evaluate(t,e){const r=this._validate(this.args[0].evaluate(t,e)),s=this._validate(this.args[1].evaluate(t,e)),n=this._validate(this.args[2].evaluate(t,e));return new x.Z({r,g:s,b:n})}_validate(t){if("number"!=typeof t||t<0||t>255)throw new Error(`${t}: invalid color component`);return Math.round(t)}}class Xt{constructor(t){this.args=t,this.type=rt}static parse(t,e){if(5!==t.length)throw new Error('"rgba" expects 4 arguments');const r=t.slice(1).map(s=>d(s,e));return new Xt(r)}evaluate(t,e){const r=this._validate(this.args[0].evaluate(t,e)),s=this._validate(this.args[1].evaluate(t,e)),n=this._validate(this.args[2].evaluate(t,e)),p=this._validateAlpha(this.args[3].evaluate(t,e));return new x.Z({r,g:s,b:n,a:p})}_validate(t){if("number"!=typeof t||t<0||t>255)throw new Error(`${t}: invalid color component`);return Math.round(t)}_validateAlpha(t){if("number"!=typeof t||t<0||t>1)throw new Error(`${t}: invalid alpha color component`);return t}}class Ht{constructor(t){this.color=t,this.type=ht(b,4)}static parse(t,e){if(2!==t.length)throw new Error('"to-rgba" expects 1 argument');const r=d(t[1],e);return new Ht(r)}evaluate(t,e){return new x.Z(this.color.evaluate(t,e)).toRgba()}}class ot{constructor(t,e){this.type=t,this.args=e}static parse(t,e){const r=t[0];if(t.length<2)throw new Error(`${r} expects at least one argument`);let s,n=1;if("array"===r){if(t.length>2){switch(t[1]){case"string":s=j;break;case"number":s=b;break;case"boolean":s=k;break;default:throw new Error('"array" type argument must be string, number or boolean')}n++}else s=st;let u;if(t.length>3){if(u=t[2],null!==u&&("number"!=typeof u||u<0||u!==Math.floor(u)))throw new Error('"array" length argument must be a positive integer literal');n++}s=ht(s,u)}else switch(r){case"string":s=j;break;case"number":s=b;break;case"boolean":s=k;break;case"object":s=gt}const p=[];for(;n<t.length;n++){const u=d(t[n],e);p.push(u)}return new ot(s,p)}evaluate(t,e){let r;for(const s of this.args){const n=s.evaluate(t,e);if(r=dt(n),Dt(r,this.type))return n}throw new Error(`Expected ${ct(this.type)} but got ${ct(r)}`)}}let lt=(()=>{class o{constructor(e,r){this.type=e,this.args=r}static parse(e,r){const s=e[0],n=o.types[s];if(n===k||n===j){if(2!==e.length)throw new Error(`${s} expects one argument`)}else if(e.length<2)throw new Error(`${s} expects at least one argument`);const p=[];for(let u=1;u<e.length;u++){const c=d(e[u],r);p.push(c)}return new o(n,p)}evaluate(e,r){if(this.type===k)return Boolean(this.args[0].evaluate(e,r));if(this.type===j)return Rt(this.args[0].evaluate(e,r));if(this.type===b){for(const s of this.args){const n=Number(s.evaluate(e,r));if(!isNaN(n))return n}return null}if(this.type===rt){for(const s of this.args)try{const n=o.toColor(s.evaluate(e,r));if(n instanceof x.Z)return n}catch(n){}return null}}static toBoolean(e){return Boolean(e)}static toString(e){return Rt(e)}static toNumber(e){const r=Number(e);if(isNaN(r))throw new Error(`"${e}" is not a number`);return r}static toColor(e){if(e instanceof x.Z)return e;if("string"==typeof e){const r=x.Z.fromString(e);if(r)return r;throw new Error(`"${e}" is not a color`)}if(Array.isArray(e))return x.Z.fromArray(e);throw new Error(`"${e}" is not a color`)}}return o.types={"to-boolean":k,"to-color":rt,"to-number":b,"to-string":j},o})();class jt{constructor(t){this.val=t,this.type=dt(t)}static parse(t){if(2!==t.length)throw new Error('"literal" expects 1 argument');return new jt(t[1])}evaluate(t,e){return this.val}}class Kt{constructor(t){this.arg=t,this.type=j}static parse(t,e){if(2!==t.length)throw new Error('"typeof" expects 1 argument');return new Kt(d(t[1],e))}evaluate(t,e){return ct(dt(this.arg.evaluate(t,e)))}}function d(o,t,e){const r=typeof o;if("string"===r||"boolean"===r||"number"===r||null===o){if(e)switch(e.kind){case"string":"string"!==r&&(o=lt.toString(o));break;case"number":"number"!==r&&(o=lt.toNumber(o));break;case"color":o=lt.toColor(o)}o=["literal",o]}if(!Array.isArray(o)||0===o.length)throw new Error("Expression must be a non empty array");const s=o[0];if("string"!=typeof s)throw new Error("First element of expression must be a string");const n=te[s];if(void 0===n)throw new Error(`Invalid expression operator "${s}"`);if(!n)throw new Error(`Unimplemented expression operator "${s}"`);return n.parse(o,t,e)}const te={array:ot,boolean:ot,collator:null,format:null,image:null,literal:jt,number:ot,"number-format":null,object:ot,string:ot,"to-boolean":lt,"to-color":lt,"to-number":lt,"to-string":lt,typeof:Kt,accumulated:null,"feature-state":null,"geometry-type":Nt,id:bt,"line-progress":null,properties:Lt,at:Vt,get:_t,has:Et,in:Ft,"index-of":It,length:zt,slice:Tt,"!":At,"!=":class le extends X{static parse(t,e){return X.parse(t,e,(r,s)=>r!==s)}},"<":class ue extends X{static parse(t,e){return X.parse(t,e,(r,s)=>r<s)}},"<=":class ce extends X{static parse(t,e){return X.parse(t,e,(r,s)=>r<=s)}},"==":class oe extends X{static parse(t,e){return X.parse(t,e,(r,s)=>r===s)}},">":class he extends X{static parse(t,e){return X.parse(t,e,(r,s)=>r>s)}},">=":class pe extends X{static parse(t,e){return X.parse(t,e,(r,s)=>r>=s)}},all:St,any:xt,case:Ut,coalesce:Ot,match:Gt,within:null,interpolate:tt,"interpolate-hcl":tt,"interpolate-lab":tt,step:Bt,let:kt,var:Ct,concat:$t,downcase:qt,"is-supported-script":null,"resolved-locale":null,upcase:qt,rgb:Yt,rgba:Xt,"to-rgba":Ht,"-":class ye extends ${static parse(t,e){switch(t.length){case 2:return $.parse(t,e,r=>-r[0]);case 3:return $.parse(t,e,r=>r[0]-r[1]);default:throw new Error('"-" expects 1 or 2 arguments')}}},"*":class fe extends ${static parse(t,e){return $.parse(t,e,r=>{let s=1;for(const n of r)s*=n;return s})}},"/":class ge extends ${static parse(t,e){if(3===t.length)return $.parse(t,e,r=>r[0]/r[1]);throw new Error('"/" expects 2 arguments')}},"%":class de extends ${static parse(t,e){if(3===t.length)return $.parse(t,e,r=>r[0]%r[1]);throw new Error('"%" expects 2 arguments')}},"^":class me extends ${static parse(t,e){if(3===t.length)return $.parse(t,e,r=>r[0]**r[1]);throw new Error('"^" expects 1 or 2 arguments')}},"+":class _e extends ${static parse(t,e){return $.parse(t,e,r=>{let s=0;for(const n of r)s+=n;return s})}},abs:P,acos:P,asin:P,atan:P,ceil:P,cos:P,e:P,floor:P,ln:P,ln2:P,log10:P,log2:P,max:P,min:P,pi:P,round:P,sin:P,sqrt:P,tan:P,zoom:mt,"heatmap-density":null,"has-id":Mt,none:Pt};class H{constructor(t){this._expression=t}filter(t,e){if(!this._expression)return!0;try{return this._expression.evaluate(t,e)}catch(r){return console.log(r.message),!0}}static createFilter(t){if(!t)return null;this.isLegacyFilter(t)&&(t=this.convertLegacyFilter(t));try{const e=d(t,null,k);return new H(e)}catch(e){return console.log(e.message),null}}static isLegacyFilter(t){if(!Array.isArray(t)||0===t.length)return!0;switch(t[0]){case"==":case"!=":case">":case"<":case">=":case"<=":return 3===t.length&&"string"==typeof t[1]&&!Array.isArray(t[2]);case"in":return t.length>=3&&"string"==typeof t[1]&&!Array.isArray(t[2]);case"!in":case"none":case"!has":return!0;case"any":case"all":for(let e=1;e<t.length;e++)if(this.isLegacyFilter(t[e]))return!0;return!1;case"has":return 2===t.length&&("$id"===t[1]||"$type"===t[1]);default:return!1}}static convertLegacyFilter(t){if(!Array.isArray(t)||0===t.length)return!0;const e=t[0];if(1===t.length)return"any"!==e;switch(e){case"==":return H.convertComparison("==",t[1],t[2]);case"!=":return H.negate(H.convertComparison("==",t[1],t[2]));case">":case"<":case">=":case"<=":return H.convertComparison(e,t[1],t[2]);case"in":return H.convertIn(t[1],t.slice(2));case"!in":return H.negate(H.convertIn(t[1],t.slice(2)));case"any":case"all":case"none":return H.convertCombining(e,t.slice(1));case"has":return H.convertHas(t[1]);case"!has":return H.negate(H.convertHas(t[1]));default:throw new Error("Unexpected legacy filter.")}}static convertComparison(t,e,r){switch(e){case"$type":return[t,["geometry-type"],r];case"$id":return[t,["id"],r];default:return[t,["get",e],r]}}static convertIn(t,e){switch(t){case"$type":return["in",["geometry-type"],["literal",e]];case"$id":return["in",["id"],["literal",e]];default:return["in",["get",t],["literal",e]]}}static convertHas(t){switch(t){case"$type":return!0;case"$id":return["has-id"];default:return["has",t]}}static convertCombining(t,e){return[t].concat(e.map(this.convertLegacyFilter))}static negate(t){return["!",t]}}var L=T(1268);class wt{constructor(t,e){let r;switch(this.isDataDriven=!1,this.interpolator=null,t.type){case"number":case"color":r=!0;break;case"array":r="number"===t.value;break;default:r=!1}if(null==e&&(e=t.default),Array.isArray(e)&&e.length>0&&te[e[0]]){const n={number:b,color:rt,string:j,boolean:k,enum:j};try{const u=d(e,null,"array"===t.type?ht(n[t.value]||st,t.length):n[t.type]);this.getValue=this._buildExpression(u,t),this.isDataDriven=!0,u instanceof tt&&u.input instanceof mt&&(this.interpolator=u)}catch(p){console.log(p.message),this.getValue=this._buildSimple(t.default)}return}r&&"interval"===e.type&&(r=!1);const s=e&&e.stops&&e.stops.length>0;if(s)for(const n of e.stops)n[1]=this._validate(n[1],t);if(this.isDataDriven=!!e&&!!e.property,this.isDataDriven)if(void 0!==e.default&&(e.default=this._validate(e.default,t)),s)switch(e.type){case"identity":this.getValue=this._buildIdentity(e,t);break;case"categorical":this.getValue=this._buildCategorical(e,t);break;default:this.getValue=r?this._buildInterpolate(e,t):this._buildInterval(e,t)}else this.getValue=this._buildIdentity(e,t);else s?this.getValue=r?this._buildZoomInterpolate(e):this._buildZoomInterval(e):(e=this._validate(e,t),this.getValue=this._buildSimple(e))}_validate(t,e){if("number"===e.type){if(t<e.minimum)return e.minimum;if(t>e.maximum)return e.maximum}else"color"===e.type?t=wt._parseColor(t):"enum"===e.type?"string"==typeof t&&(t=e.values.indexOf(t)):"array"===e.type&&"enum"===e.value?t=t.map(r=>"string"==typeof r?e.values.indexOf(r):r):"string"===e.type&&(t=Rt(t));return t}_buildSimple(t){return()=>t}_buildExpression(t,e){return(r,s)=>{try{const n=t.evaluate(s,r);return void 0===n?e.default:this._validate(n,e)}catch(n){return console.log(n.message),e.default}}}_buildIdentity(t,e){return(r,s)=>{let n;return s&&(n=s.values[t.property]),void 0!==n&&(n=this._validate(n,e)),null!=n?n:void 0!==t.default?t.default:e.default}}_buildCategorical(t,e){return(r,s)=>{let n;return s&&(n=s.values[t.property]),n=this._categorical(n,t.stops),void 0!==n?n:void 0!==t.default?t.default:e.default}}_buildInterval(t,e){return(r,s)=>{let n;return s&&(n=s.values[t.property]),"number"==typeof n?this._interval(n,t.stops):void 0!==t.default?t.default:e.default}}_buildInterpolate(t,e){return(r,s)=>{let n;return s&&(n=s.values[t.property]),"number"==typeof n?this._interpolate(n,t.stops,t.base||1):void 0!==t.default?t.default:e.default}}_buildZoomInterpolate(t){return e=>this._interpolate(e,t.stops,t.base||1)}_buildZoomInterval(t){return e=>this._interval(e,t.stops)}_categorical(t,e){const r=e.length;for(let s=0;s<r;s++)if(e[s][0]===t)return e[s][1]}_interval(t,e){const r=e.length;let s=0;for(let n=0;n<r&&e[n][0]<=t;n++)s=n;return e[s][1]}_interpolate(t,e,r){let s,n;const p=e.length;for(let u=0;u<p;u++){const c=e[u];if(!(c[0]<=t)){n=c;break}s=c}if(s&&n){const u=n[0]-s[0],c=t-s[0],y=1===r?c/u:(r**c-1)/(r**u-1);if(Array.isArray(s[1])){const m=s[1],f=n[1],_=[];for(let w=0;w<m.length;w++)_.push((0,M.sX)(m[w],f[w],y));return _}return(0,M.sX)(s[1],n[1],y)}return s?s[1]:n?n[1]:void 0}static _isEmpty(t){for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}static _parseColor(t){return Array.isArray(t)?t:("string"==typeof t&&(t=new x.Z(t)),t instanceof x.Z&&!this._isEmpty(t)?x.Z.toUnitRGBA(t):void 0)}}var Ee=T(39351);class pt{constructor(t,e,r,s){switch(this.type=t,this.typeName=e.type,this.id=e.id,this.source=e.source,this.sourceLayer=e["source-layer"],this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,this.filter=e.filter,this.layout=e.layout,this.paint=e.paint,this.z=r,this.uid=s,t){case L.fR.BACKGROUND:this._layoutDefinition=L.f2.backgroundLayoutDefinition,this._paintDefinition=L.f2.backgroundPaintDefinition;break;case L.fR.FILL:this._layoutDefinition=L.f2.fillLayoutDefinition,this._paintDefinition=L.f2.fillPaintDefinition;break;case L.fR.LINE:this._layoutDefinition=L.f2.lineLayoutDefinition,this._paintDefinition=L.f2.linePaintDefinition;break;case L.fR.SYMBOL:this._layoutDefinition=L.f2.symbolLayoutDefinition,this._paintDefinition=L.f2.symbolPaintDefinition;break;case L.fR.CIRCLE:this._layoutDefinition=L.f2.circleLayoutDefinition,this._paintDefinition=L.f2.circlePaintDefinition}this._layoutProperties=this._parseLayout(this.layout),this._paintProperties=this._parsePaint(this.paint)}getFeatureFilter(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=H.createFilter(this.filter)}getLayoutProperty(t){return this._layoutProperties[t]}getPaintProperty(t){return this._paintProperties[t]}getLayoutValue(t,e,r){let s;const n=this._layoutProperties[t];return n&&(s=n.getValue(e,r)),void 0===s&&(s=this._layoutDefinition[t].default),s}getPaintValue(t,e,r){let s;const n=this._paintProperties[t];return n&&(s=n.getValue(e,r)),void 0===s&&(s=this._paintDefinition[t].default),s}isPainterDataDriven(){const t=this._paintProperties;if(t)for(const e in t)if(t[e].isDataDriven)return!0;return!1}_parseLayout(t){const e={};for(const r in t){const s=this._layoutDefinition[r];s&&(e[r]=new wt(s,t[r]))}return e}_parsePaint(t){const e={};for(const r in t){const s=this._paintDefinition[r];s&&(e[r]=new wt(s,t[r]))}return e}computeAttributesKey(t,e,r,s){let n=0,p=0;for(const u of e){let c=3;if(!u||u!==s){const y=r[u],{isLayout:m,isOptional:f}=y,_=m?this.getLayoutProperty(u):this.getPaintProperty(u);c=(null==_?void 0:_.interpolator)?2:(null==_?void 0:_.isDataDriven)?1:f&&!_?3:0}p|=c<<n,n+=2}return p<<3|t}}class Ie extends pt{constructor(t,e,r,s){super(t,e,r,s),this.backgroundMaterial=new A(this.computeAttributesKey(v._K.BACKGROUND,A.ATTRIBUTES,A.ATTRIBUTES_INFO))}}class Te extends pt{constructor(t,e,r,s){super(t,e,r,s);const n=this.getPaintProperty("fill-color"),p=this.getPaintProperty("fill-opacity"),u=this.getPaintProperty("fill-pattern");this.hasDataDrivenColor=null==n?void 0:n.isDataDriven,this.hasDataDrivenOpacity=null==p?void 0:p.isDataDriven,this.hasDataDrivenFill=this.hasDataDrivenColor||this.hasDataDrivenOpacity||(null==u?void 0:u.isDataDriven);const c=this.getPaintProperty("fill-outline-color");this.outlineUsesFillColor=!c,this.hasDataDrivenOutlineColor=null==c?void 0:c.isDataDriven,this.hasDataDrivenOutline=c?c.isDataDriven:!!n&&n.isDataDriven,this.hasDataDrivenOutline=(c?this.hasDataDrivenOutlineColor:this.hasDataDrivenColor)||this.hasDataDrivenOpacity,this.fillMaterial=new z(this.computeAttributesKey(v._K.FILL,z.ATTRIBUTES,z.ATTRIBUTES_INFO)),this.outlineMaterial=new V(this.computeAttributesKey(v._K.OUTLINE,this.outlineUsesFillColor?V.ATTRIBUTES_FILL:V.ATTRIBUTES_OUTLINE,this.outlineUsesFillColor?V.ATTRIBUTES_INFO_FILL:V.ATTRIBUTES_INFO_OUTLINE),this.outlineUsesFillColor)}}class we extends pt{constructor(t,e,r,s){var p,u,c,y,m,f,_,w,D;super(t,e,r,s);const n=this.getPaintProperty("line-pattern");if(this.lineMaterial=new et(this.computeAttributesKey(v._K.LINE,et.ATTRIBUTES,et.ATTRIBUTES_INFO,n?"line-dasharray":"")),this.hasDataDrivenLine=(null==(p=this.getPaintProperty("line-blur"))?void 0:p.isDataDriven)||(null==(u=this.getPaintProperty("line-color"))?void 0:u.isDataDriven)||(null==(c=this.getPaintProperty("line-gap-width"))?void 0:c.isDataDriven)||(null==(y=this.getPaintProperty("line-offset"))?void 0:y.isDataDriven)||(null==(m=this.getPaintProperty("line-opacity"))?void 0:m.isDataDriven)||(null==(f=this.getPaintProperty("line-pattern"))?void 0:f.isDataDriven)||(null==(_=this.getPaintProperty("line-dasharray"))?void 0:_.isDataDriven)||(null==(w=this.getLayoutProperty("line-cap"))?void 0:w.isDataDriven)||(null==(D=this.getPaintProperty("line-width"))?void 0:D.isDataDriven),this.canUseThinTessellation=!1,!this.hasDataDrivenLine){const K=this.getPaintProperty("line-width");if(!K||"number"==typeof K&&.5*K<Ee.tQ){const C=this.getPaintProperty("line-offset");(!C||"number"==typeof C&&0===C)&&(this.canUseThinTessellation=!0)}}}getDashKey(t,e){let r;switch(e){case R.RL.BUTT:r="Butt";break;case R.RL.ROUND:r="Round";break;case R.RL.SQUARE:r="Square";break;default:r="Butt"}return`dasharray-[${t.toString()}]-${r}`}}class De extends pt{constructor(t,e,r,s){var n,p,u,c,y,m,f,_,w,D,K,C;super(t,e,r,s),this.iconMaterial=new at(this.computeAttributesKey(v._K.ICON,at.ATTRIBUTES,at.ATTRIBUTES_INFO)),this.textMaterial=new it(this.computeAttributesKey(v._K.TEXT,it.ATTRIBUTES,it.ATTRIBUTES_INFO)),this.hasDataDrivenIcon=(null==(n=this.getPaintProperty("icon-color"))?void 0:n.isDataDriven)||(null==(p=this.getPaintProperty("icon-halo-blur"))?void 0:p.isDataDriven)||(null==(u=this.getPaintProperty("icon-halo-color"))?void 0:u.isDataDriven)||(null==(c=this.getPaintProperty("icon-halo-width"))?void 0:c.isDataDriven)||(null==(y=this.getPaintProperty("icon-opacity"))?void 0:y.isDataDriven)||(null==(m=this.getLayoutProperty("icon-size"))?void 0:m.isDataDriven),this.hasDataDrivenText=(null==(f=this.getPaintProperty("text-color"))?void 0:f.isDataDriven)||(null==(_=this.getPaintProperty("text-halo-blur"))?void 0:_.isDataDriven)||(null==(w=this.getPaintProperty("text-halo-color"))?void 0:w.isDataDriven)||(null==(D=this.getPaintProperty("text-halo-width"))?void 0:D.isDataDriven)||(null==(K=this.getPaintProperty("text-opacity"))?void 0:K.isDataDriven)||(null==(C=this.getLayoutProperty("text-size"))?void 0:C.isDataDriven)}}class Re extends pt{constructor(t,e,r,s){super(t,e,r,s),this.circleMaterial=new F(this.computeAttributesKey(v._K.CIRCLE,F.ATTRIBUTES,F.ATTRIBUTES_INFO))}}class ve{constructor(t,e,r){let s;this.allowOverlap=t.getLayoutValue("icon-allow-overlap",e),this.ignorePlacement=t.getLayoutValue("icon-ignore-placement",e),this.keepUpright=t.getLayoutValue("icon-keep-upright",e),this.optional=t.getLayoutValue("icon-optional",e),this.rotationAlignment=t.getLayoutValue("icon-rotation-alignment",e),this.rotationAlignment===L.aF.AUTO&&(this.rotationAlignment=r?L.aF.MAP:L.aF.VIEWPORT),s=t.getLayoutProperty("icon-anchor"),(null==s?void 0:s.isDataDriven)?this._anchorProp=s:this.anchor=t.getLayoutValue("icon-anchor",e),s=t.getLayoutProperty("icon-offset"),(null==s?void 0:s.isDataDriven)?this._offsetProp=s:this.offset=t.getLayoutValue("icon-offset",e),s=t.getLayoutProperty("icon-padding"),(null==s?void 0:s.isDataDriven)?this._paddingProp=s:this.padding=t.getLayoutValue("icon-padding",e),s=t.getLayoutProperty("icon-rotate"),(null==s?void 0:s.isDataDriven)?this._rotateProp=s:this.rotate=t.getLayoutValue("icon-rotate",e),s=t.getLayoutProperty("icon-size"),(null==s?void 0:s.isDataDriven)?this._sizeProp=s:this.size=t.getLayoutValue("icon-size",e)}update(t,e){this._anchorProp&&(this.anchor=this._anchorProp.getValue(t,e)),this._offsetProp&&(this.offset=this._offsetProp.getValue(t,e)),this._paddingProp&&(this.padding=this._paddingProp.getValue(t,e)),this._rotateProp&&(this.rotate=this._rotateProp.getValue(t,e)),this._sizeProp&&(this.size=this._sizeProp.getValue(t,e))}}class be{constructor(t,e,r){let s;this.allowOverlap=t.getLayoutValue("text-allow-overlap",e),this.ignorePlacement=t.getLayoutValue("text-ignore-placement",e),this.keepUpright=t.getLayoutValue("text-keep-upright",e),this.optional=t.getLayoutValue("text-optional",e),this.rotationAlignment=t.getLayoutValue("text-rotation-alignment",e),this.rotationAlignment===L.aF.AUTO&&(this.rotationAlignment=r?L.aF.MAP:L.aF.VIEWPORT),s=t.getLayoutProperty("text-anchor"),(null==s?void 0:s.isDataDriven)?this._anchorProp=s:this.anchor=t.getLayoutValue("text-anchor",e),s=t.getLayoutProperty("text-justify"),(null==s?void 0:s.isDataDriven)?this._justifyProp=s:this.justify=t.getLayoutValue("text-justify",e),s=t.getLayoutProperty("text-letter-spacing"),(null==s?void 0:s.isDataDriven)?this._letterSpacingProp=s:this.letterSpacing=t.getLayoutValue("text-letter-spacing",e),s=t.getLayoutProperty("text-line-height"),(null==s?void 0:s.isDataDriven)?this._lineHeightProp=s:this.lineHeight=t.getLayoutValue("text-line-height",e),s=t.getLayoutProperty("text-max-angle"),(null==s?void 0:s.isDataDriven)?this._maxAngleProp=s:this.maxAngle=t.getLayoutValue("text-max-angle",e),s=t.getLayoutProperty("text-max-width"),(null==s?void 0:s.isDataDriven)?this._maxWidthProp=s:this.maxWidth=t.getLayoutValue("text-max-width",e),s=t.getLayoutProperty("text-offset"),(null==s?void 0:s.isDataDriven)?this._offsetProp=s:this.offset=t.getLayoutValue("text-offset",e),s=t.getLayoutProperty("text-padding"),(null==s?void 0:s.isDataDriven)?this._paddingProp=s:this.padding=t.getLayoutValue("text-padding",e),s=t.getLayoutProperty("text-rotate"),(null==s?void 0:s.isDataDriven)?this._rotateProp=s:this.rotate=t.getLayoutValue("text-rotate",e),s=t.getLayoutProperty("text-size"),(null==s?void 0:s.isDataDriven)?this._sizeProp=s:this.size=t.getLayoutValue("text-size",e),s=t.getLayoutProperty("text-writing-mode"),(null==s?void 0:s.isDataDriven)?this._writingModeProp=s:this.writingMode=t.getLayoutValue("text-writing-mode",e)}update(t,e){this._anchorProp&&(this.anchor=this._anchorProp.getValue(t,e)),this._justifyProp&&(this.justify=this._justifyProp.getValue(t,e)),this._letterSpacingProp&&(this.letterSpacing=this._letterSpacingProp.getValue(t,e)),this._lineHeightProp&&(this.lineHeight=this._lineHeightProp.getValue(t,e)),this._maxAngleProp&&(this.maxAngle=this._maxAngleProp.getValue(t,e)),this._maxWidthProp&&(this.maxWidth=this._maxWidthProp.getValue(t,e)),this._offsetProp&&(this.offset=this._offsetProp.getValue(t,e)),this._paddingProp&&(this.padding=this._paddingProp.getValue(t,e)),this._rotateProp&&(this.rotate=this._rotateProp.getValue(t,e)),this._sizeProp&&(this.size=this._sizeProp.getValue(t,e)),this._writingModeProp&&(this.writingMode=this._writingModeProp.getValue(t,e))}}},78364:(Q,U,T)=>{T.d(U,{Z:()=>N});var R=T(1268),v=T(77928);class N{constructor(i){if(this._style=i,this.backgroundBucketIds=[],this._uidToLayer=new Map,this._layerByName={},this._runningId=0,i.layers||(i.layers=[]),this.version=parseFloat(i.version),this.layers=i.layers.map((a,l,h)=>this._create(a,l,h)).filter(a=>!!a),this.layers){let a;for(let l=0;l<this.layers.length;l++)a=this.layers[l],this._layerByName[a.id]=a,this._uidToLayer.set(a.uid,a),a.type===R.fR.BACKGROUND&&this.backgroundBucketIds.push(a.id)}this._identifyRefLayers()}isPainterDataDriven(i){const a=this._layerByName[i];return!!a&&a.isPainterDataDriven()}getStyleLayerId(i){return i>=this.layers.length?null:this.layers[i].id}getStyleLayerByUID(i){var a;return null!=(a=this._uidToLayer.get(i))?a:null}getStyleLayerIndex(i){const a=this._layerByName[i];return a?this.layers.indexOf(a):-1}setStyleLayer(i,a){if(!i||!i.id)return;const l=this._style;null!=a&&a>=this.layers.length&&(a=this.layers.length-1);let h,g=!0;const E=this._layerByName[i.id];if(E){const I=this.layers.indexOf(E);a||(a=I),a===I?(g=!1,h=N._recreateLayer(i,E),this.layers[a]=h,l.layers[a]=i):(this.layers.splice(I,1),l.layers.splice(I,1),h=this._create(i,a,this.layers),this.layers.splice(a,0,h),l.layers.splice(a,0,i))}else h=this._create(i,a,this.layers),!a||a>=this.layers.length?(this.layers.push(h),l.layers.push(i)):(this.layers.splice(a,0,h),l.layers.splice(a,0,i));this._layerByName[i.id]=h,this._uidToLayer.set(h.uid,h),g&&this._recomputeZValues(),this._identifyRefLayers()}getStyleLayer(i){const a=this._layerByName[i];return a?{type:a.typeName,id:a.id,source:a.source,"source-layer":a.sourceLayer,minzoom:a.minzoom,maxzoom:a.maxzoom,filter:a.filter,layout:a.layout,paint:a.paint}:null}deleteStyleLayer(i){const a=this._layerByName[i];if(a){delete this._layerByName[i],this._uidToLayer.delete(a.uid);const l=this.layers.indexOf(a);this.layers.splice(l,1),this._style.layers.splice(l,1),this._recomputeZValues(),this._identifyRefLayers()}}getLayerById(i){return this._layerByName[i]}getLayoutProperties(i){const a=this._layerByName[i];return a?a.layout:null}getPaintProperties(i){const a=this._layerByName[i];return a?a.paint:null}setPaintProperties(i,a){const l=this._layerByName[i];if(!l)return;const g=N._recreateLayer({type:l.typeName,id:l.id,source:l.source,"source-layer":l.sourceLayer,minzoom:l.minzoom,maxzoom:l.maxzoom,filter:l.filter,layout:l.layout,paint:a},l),E=this.layers.indexOf(l);this.layers[E]=g,this._style.layers[E].paint=a,this._layerByName[l.id]=g,this._uidToLayer.set(l.uid,g)}setLayoutProperties(i,a){const l=this._layerByName[i];if(!l)return;const g=N._recreateLayer({type:l.typeName,id:l.id,source:l.source,"source-layer":l.sourceLayer,minzoom:l.minzoom,maxzoom:l.maxzoom,filter:l.filter,layout:a,paint:l.paint},l),E=this.layers.indexOf(l);this.layers[E]=g,this._style.layers[E].layout=a,this._layerByName[l.id]=g,this._uidToLayer.set(l.uid,g)}setStyleLayerVisibility(i,a){const l=this._layerByName[i];if(!l)return;const h=l.layout||{};h.visibility=a;const E=N._recreateLayer({type:l.typeName,id:l.id,source:l.source,"source-layer":l.sourceLayer,minzoom:l.minzoom,maxzoom:l.maxzoom,filter:l.filter,layout:h,paint:l.paint},l),I=this.layers.indexOf(l);this.layers[I]=E,this._style.layers[I].layout=h,this._layerByName[l.id]=E,this._uidToLayer.set(l.uid,E)}getStyleLayerVisibility(i){var l,h;const a=this._layerByName[i];return a?null!=(h=null==(l=a.layout)?void 0:l.visibility)?h:"visible":"none"}_recomputeZValues(){const i=this.layers,a=1/(i.length+1);for(let l=0;l<i.length;l++)i[l].z=1-(1+l)*a}_identifyRefLayers(){const i=[],a=[];let l=0;for(const h of this.layers){const g=h.layout;if(h.type===R.fR.FILL){const E=h;let I=h.source+"|"+h.sourceLayer;I+="|"+(null==g?void 0:g.visibility),I+="|"+h.minzoom,I+="|"+h.maxzoom,I+="|"+JSON.stringify(h.filter),(E.hasDataDrivenFill||E.hasDataDrivenOutline)&&(I+="|"+l),i.push({key:I,layer:h})}else if(h.type===R.fR.LINE){const E=h;let I=h.source+"|"+h.sourceLayer;I+="|"+(null==g?void 0:g.visibility),I+="|"+h.minzoom,I+="|"+h.maxzoom,I+="|"+JSON.stringify(h.filter),I+="|"+(void 0!==g?g["line-cap"]:""),I+="|"+(void 0!==g?g["line-join"]:""),E.hasDataDrivenLine&&(I+="|"+l),a.push({key:I,layer:h})}++l}this._assignRefLayers(i),this._assignRefLayers(a)}_assignRefLayers(i){let a,l;i.sort((g,E)=>g.key<E.key?-1:g.key>E.key?1:0);const h=i.length;for(let g=0;g<h;g++){const E=i[g];if(E.key===a)E.layer.refLayerId=l;else if(a=E.key,l=E.layer.id,E.layer.type===R.fR.FILL){if(!E.layer.getPaintProperty("fill-outline-color"))for(let I=g+1;I<h;I++){const A=i[I];if(A.key!==a)break;if(A.layer.getPaintProperty("fill-outline-color")){i[g]=A,i[I]=E,l=A.layer.id;break}}}else if(E.layer.type===R.fR.LINE){let I=E.layer;for(let A=g+1;A<h;A++){const F=i[A];if(F.key!==a)break;const z=F.layer;(I.canUseThinTessellation&&!z.canUseThinTessellation||!I.canUseThinTessellation&&(z.getPaintProperty("line-pattern")||z.getPaintProperty("line-dasharray")))&&(I=z,i[g]=F,i[A]=E,l=F.layer.id)}}}}_create(i,a,l){const h=1-(1+a)*(1/(l.length+1)),g=this._runningId++;switch(i.type){case"background":return new v.Et(R.fR.BACKGROUND,i,h,g);case"fill":return new v.Le(R.fR.FILL,i,h,g);case"line":return new v.gf(R.fR.LINE,i,h,g);case"symbol":return new v.jG(R.fR.SYMBOL,i,h,g);case"raster":console.warn(`Unsupported vector tile raster layer ${i.id}`);case"circle":return new v.sj(R.fR.CIRCLE,i,h,g)}}static _recreateLayer(i,a){switch(i.type){case"background":return new v.Et(R.fR.BACKGROUND,i,a.z,a.uid);case"fill":return new v.Le(R.fR.FILL,i,a.z,a.uid);case"line":return new v.gf(R.fR.LINE,i,a.z,a.uid);case"symbol":return new v.jG(R.fR.SYMBOL,i,a.z,a.uid);case"raster":console.warn(`Unsupported vector tile raster layer ${i.id}`);case"circle":return new v.sj(R.fR.CIRCLE,i,a.z,a.uid)}}}}}]);