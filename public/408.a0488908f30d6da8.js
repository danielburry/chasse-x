"use strict";var $=Object.defineProperty,J=Object.defineProperties,Q=Object.getOwnPropertyDescriptors,N=Object.getOwnPropertySymbols,q=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable,H=(g,h,e)=>h in g?$(g,h,{enumerable:!0,configurable:!0,writable:!0,value:e}):g[h]=e,Y=(g,h)=>{for(var e in h||(h={}))q.call(h,e)&&H(g,e,h[e]);if(N)for(var e of N(h))k.call(h,e)&&H(g,e,h[e]);return g},G=(g,h)=>J(g,Q(h));(self.webpackChunkchasse_pwa_front=self.webpackChunkchasse_pwa_front||[]).push([[408],{60408:(g,h,e)=>{e.r(h),e.d(h,{default:()=>F});var t=e(17626),P=(e(63290),e(90912),e(85931),e(8314),e(82255),e(76898)),j=e(44589),y=e(67969);class R extends j.Z{constructor(){super(...arguments),this.requiresDedicatedFBO=!1}dispose(){}doRender(r){const d=this.createRenderParams(r),{context:a,painter:m,profiler:E}=d;this._prevFBO=a.getBoundFramebufferObject(),E.recordContainerStart(this.name);const L=this._getFbo(d),O=m.getRenderTarget();a.bindFramebuffer(L),m.setRenderTarget(L),a.setDepthWriteEnabled(!0),a.setColorMask(!0,!0,!0,!0),a.setClearColor(0,0,0,0),a.setClearDepth(1),a.clear(a.gl.COLOR_BUFFER_BIT|a.gl.DEPTH_BUFFER_BIT),a.setDepthWriteEnabled(!1);for(const w of this.children)w.beforeRender(r);for(const w of this.children)w.processRender(d);for(const w of this.children)w.afterRender(r);m.setRenderTarget(O),m.releaseFbo(L),a.bindFramebuffer(this._prevFBO),m.beforeRenderLayer(d,this._clippingInfos?255:0,this.computedOpacity),a.setStencilTestEnabled(!1),a.setStencilWriteMask(0),m.blitTexture(a,L.colorTexture,y.cw.NEAREST),m.compositeLayer(d,this.computedOpacity),E.recordContainerEnd()}createRenderParams(r){return G(Y({},super.createRenderParams(r)),{blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:1})}_getFbo(r){const{context:d,painter:a}=r,{width:m,height:E}=d.getViewport();return a.acquireFbo(m,E)}}var T=e(37384),I=e(74333),S=e(89726),p=e(62208),f=e(32917),i=e(77712),c=e(45611);let o=class extends c.Z{constructor(s){super(s),this.type="group",this.layerViews=new I.Z}_allLayerViewVisibility(s){this.layerViews.forEach(r=>{r.visible=s})}initialize(){this.handles.add([this.layerViews.on("change",s=>this._layerViewsChangeHandler(s)),(0,f.YP)(()=>this.layer.visibilityMode,()=>this._applyVisibility(()=>this._allLayerViewVisibility(this.visible),()=>this._applyExclusiveVisibility(null)),f.Z_),(0,f.YP)(()=>this.visible,s=>{this._applyVisibility(()=>this._allLayerViewVisibility(s),()=>{})},f.Z_)],"grouplayerview"),this._layerViewsChangeHandler({target:null,added:this.layerViews.toArray(),removed:[],moved:[]})}set layerViews(s){this._set("layerViews",(0,S.Z)(s,this._get("layerViews")))}get updatingProgress(){return 0===this.layerViews.length?1:this.layerViews.reduce((s,r)=>s+r.updatingProgress,0)/this.layerViews.length}isUpdating(){return this.layerViews.some(s=>s.updating)}_hasLayerViewVisibleOverrides(){return this.layerViews.some(s=>s._isOverridden("visible"))}_findLayerViewForLayer(s){return s&&this.layerViews.find(r=>r.layer===s)}_firstVisibleOnLayerOrder(){const s=this.layer.layers.find(r=>{var d;return null==(d=this._findLayerViewForLayer(r))?void 0:d.visible});return s&&this._findLayerViewForLayer(s)}_applyExclusiveVisibility(s){(0,p.Wi)(s)&&(s=this._firstVisibleOnLayerOrder(),(0,p.Wi)(s)&&this.layerViews.length>0&&(s=this._findLayerViewForLayer(this.layer.layers.getItemAt(0)))),this.layerViews.forEach(r=>{r.visible=r===s})}_layerViewsChangeHandler(s){this.handles.remove("grouplayerview:visible"),this.handles.add(this.layerViews.map(d=>(0,f.YP)(()=>d.visible,a=>this._applyVisibility(()=>{a!==this.visible&&(d.visible=this.visible)},()=>this._applyExclusiveVisibility(a?d:null)),f.Z_)).toArray(),"grouplayerview:visible");const r=s.added[s.added.length-1];this._applyVisibility(()=>this._allLayerViewVisibility(this.visible),()=>this._applyExclusiveVisibility((null==r?void 0:r.visible)?r:null))}_applyVisibility(s,r){var d,a;this._hasLayerViewVisibleOverrides()&&("inherited"===(null==(d=this.layer)?void 0:d.visibilityMode)?s():"exclusive"===(null==(a=this.layer)?void 0:a.visibilityMode)&&r())}};(0,t._)([(0,i.Cb)({cast:S.R})],o.prototype,"layerViews",null),(0,t._)([(0,i.Cb)({readOnly:!0})],o.prototype,"updatingProgress",null),(0,t._)([(0,i.Cb)()],o.prototype,"view",void 0),o=(0,t._)([(0,P.j)("esri.views.layers.GroupLayerView")],o);const x=o;let B=class extends((0,T.y)(x)){constructor(){super(...arguments),this.container=new R}attach(){this._updateStageChildren(),this.handles.add(this.layerViews.on("after-changes",()=>this._updateStageChildren()),"grouplayerview2d")}detach(){this.handles.remove("grouplayerview2d"),this.container.removeAllChildren()}update(s){}moveStart(){}viewChange(){}moveEnd(){}_updateStageChildren(){this.container.removeAllChildren(),this.layerViews.forEach((s,r)=>this.container.addChildAt(s.container,r))}};B=(0,t._)([(0,P.j)("esri.views.2d.layers.GroupLayerView2D")],B);const F=B},37384:(g,h,e)=>{e.d(h,{y:()=>X});var t=e(17626),D=e(74333),U=e(89726),A=e(26584),b=e(32917),n=e(77712),R=(e(85931),e(8314),e(90912),e(76898)),T=e(1011),I=e(86810);e(63290),e(82255);let f=class extends I.wq{};f=(0,t._)([(0,R.j)("esri.views.layers.support.ClipArea")],f);const i=f;var c;let o=c=class extends i{constructor(){super(...arguments),this.type="rect",this.left=null,this.right=null,this.top=null,this.bottom=null}clone(){return new c({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}get version(){return(this._get("version")||0)+1}};(0,t._)([(0,n.Cb)({type:[Number,String],json:{write:!0}})],o.prototype,"left",void 0),(0,t._)([(0,n.Cb)({type:[Number,String],json:{write:!0}})],o.prototype,"right",void 0),(0,t._)([(0,n.Cb)({type:[Number,String],json:{write:!0}})],o.prototype,"top",void 0),(0,t._)([(0,n.Cb)({type:[Number,String],json:{write:!0}})],o.prototype,"bottom",void 0),(0,t._)([(0,n.Cb)({readOnly:!0})],o.prototype,"version",null),o=c=(0,t._)([(0,R.j)("esri.views.layers.support.ClipRect")],o);const x=o;e(29132);var a,F=e(21674),s=e(91179),r=e(2004),d=e(37118);const m={base:F.Z,key:"type",typeMap:{extent:r.Z,polygon:d.Z}};let E=a=class extends i{constructor(){super(...arguments),this.type="geometry",this.geometry=null}get version(){return(this._get("version")||0)+1}clone(){return new a({geometry:this.geometry.clone()})}};(0,t._)([(0,n.Cb)({types:m,json:{read:s.im,write:!0}})],E.prototype,"geometry",void 0),(0,t._)([(0,n.Cb)({readOnly:!0})],E.prototype,"version",null),E=a=(0,t._)([(0,R.j)("esri.views.layers.support.Geometry")],E);const L=E;let O=class extends i{constructor(){super(...arguments),this.type="path",this.path=[]}get version(){return(this._get("version")||0)+1}};(0,t._)([(0,n.Cb)({type:[[[Number]]],json:{write:!0}})],O.prototype,"path",void 0),(0,t._)([(0,n.Cb)({readOnly:!0})],O.prototype,"version",null),O=(0,t._)([(0,R.j)("esri.views.layers.support.Path")],O);const W=D.Z.ofType({key:"type",base:i,typeMap:{rect:x,path:O,geometry:L}}),X=z=>{let u=class extends z{constructor(){super(...arguments),this.attached=!1,this.clips=new W,this.lastUpdateId=-1,this.moving=!1,this.updateRequested=!1}initialize(){var V,M,Z,K;const l=null==(M=null==(V=this.view)?void 0:V.spatialReferenceLocked)||M;(null==(Z=this.view)?void 0:Z.spatialReference)&&l&&!this.spatialReferenceSupported?this.addResolvingPromise(Promise.reject(new A.Z("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",{layer:this.layer}))):(this.container||(this.container=new T.W),this.container.fadeTransitionEnabled=!0,this.container.opacity=0,this.container.clips=this.clips,this.handles.add([(0,b.YP)(()=>this.suspended,v=>{this.container&&(this.container.visible=!v),this.view&&!v&&this.updateRequested&&this.view.requestUpdate()},b.tX),(0,b.YP)(()=>{var v,_;return null!=(_=null==(v=this.layer)?void 0:v.opacity)?_:1},v=>{this.container&&(this.container.opacity=v)},b.tX),(0,b.YP)(()=>this.layer&&"blendMode"in this.layer?this.layer.blendMode:"normal",v=>{this.container&&(this.container.blendMode=v)},b.tX),(0,b.YP)(()=>this.layer&&"effect"in this.layer?this.layer.effect:null,v=>{this.container&&(this.container.effect=v)},b.tX),(0,b.on)(()=>this.clips,"change",()=>{this.container&&(this.container.clips=this.clips)})]),(null==(K=this.view)?void 0:K.whenLayerView)?this.view.whenLayerView(this.layer).then(v=>{v===this&&this.processAttach()},()=>{}):this.when().then(()=>{this.processAttach()},()=>{}))}destroy(){this.processDetach(),this.updateRequested=!1}get spatialReferenceSupported(){var C;const l=null==(C=this.view)?void 0:C.spatialReference;return null==l||this.supportsSpatialReference(l)}get updating(){var l;return this.spatialReferenceSupported&&(!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())||!!(null==(l=this.updatingHandles)?void 0:l.updating))}get visibleAtCurrentScale(){return this.isVisibleAtScale(this.view.scale)}processAttach(){this.isResolved()&&!this.attached&&!this.destroyed&&this.spatialReferenceSupported&&(this.attach(),this.attached=!0,this.requestUpdate())}processDetach(){this.attached&&(this.attached=!1,this.detach(),this.updateRequested=!1)}isVisibleAtScale(l){const C=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;if(!C)return!0;const{minScale:V,maxScale:M}=C;return(0===V||l<=V)&&(0===M||l>=M)}requestUpdate(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())}processUpdate(l){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",l),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(l))):this.updateRequested=!1}hitTest(l,C){return Promise.resolve(null)}supportsSpatialReference(l){return!0}canResume(){return!!this.spatialReferenceSupported&&!!super.canResume()&&this.visibleAtCurrentScale}getSuspendInfo(){const l=super.getSuspendInfo(),C=!this.spatialReferenceSupported,V=this.visibleAtCurrentScale;return C&&(l.spatialReferenceNotSupported=C),V&&(l.outsideScaleRange=V),l}};return(0,t._)([(0,n.Cb)()],u.prototype,"attached",void 0),(0,t._)([(0,n.Cb)({type:W,set(l){const C=(0,U.Z)(l,this._get("clips"),W);this._set("clips",C)}})],u.prototype,"clips",void 0),(0,t._)([(0,n.Cb)()],u.prototype,"container",void 0),(0,t._)([(0,n.Cb)()],u.prototype,"moving",void 0),(0,t._)([(0,n.Cb)({readOnly:!0})],u.prototype,"spatialReferenceSupported",null),(0,t._)([(0,n.Cb)({readOnly:!0})],u.prototype,"updateParameters",void 0),(0,t._)([(0,n.Cb)()],u.prototype,"updateRequested",void 0),(0,t._)([(0,n.Cb)()],u.prototype,"updating",null),(0,t._)([(0,n.Cb)()],u.prototype,"view",void 0),(0,t._)([(0,n.Cb)({readOnly:!0})],u.prototype,"visibleAtCurrentScale",null),u=(0,t._)([(0,R.j)("esri.views.2d.layers.LayerView2D")],u),u}},45611:(g,h,e)=>{e.d(h,{Z:()=>f});var t=e(17626),D=e(14517),U=e(61885),A=e(80542),b=e(61996),n=e(63290),P=e(62208),j=e(60330),y=e(77712),S=(e(85931),e(8314),e(90912),e(76898));let p=class extends((0,A.p)((0,b.IG)((0,j.v)(U.Z.EventedMixin(D.Z))))){constructor(i){super(i),this.layer=null,this.parent=null}initialize(){this.when().catch(i=>{if("layerview:create-error"!==i.name){const c=this.layer&&this.layer.id||"no id",o=this.layer&&this.layer.title||"no title";n.Z.getLogger(this.declaredClass).error("#resolve()",`Failed to resolve layer view (layer title: '${o}', id: '${c}')`,i)}})}get fullOpacity(){return(0,P.Pt)(this.get("layer.opacity"),1)*(0,P.Pt)(this.get("parent.fullOpacity"),1)}get suspended(){return!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){var i;return!this.suspended&&!0===(null==(i=this.layer)?void 0:i.legendEnabled)}get updating(){var i;return!(!(null==(i=this.updatingHandles)?void 0:i.updating)&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get visible(){var i;return!0===(null==(i=this.layer)?void 0:i.visible)}set visible(i){void 0!==i?this._override("visible",i):this._clearOverride("visible")}canResume(){var i,c,o;return this.visible&&(null==(i=this.layer)?void 0:i.loaded)&&!(null==(c=this.parent)?void 0:c.suspended)&&(null==(o=this.view)?void 0:o.ready)||!1}getSuspendInfo(){const i=this.parent&&this.parent.suspended?this.parent.suspendInfo:{};return this.view&&this.view.ready||(i.viewNotReady=!0),this.layer&&this.layer.loaded||(i.layerNotLoaded=!0),this.visible||(i.layerInvisible=!0),i}isUpdating(){return!1}};(0,t._)([(0,y.Cb)()],p.prototype,"fullOpacity",null),(0,t._)([(0,y.Cb)()],p.prototype,"layer",void 0),(0,t._)([(0,y.Cb)()],p.prototype,"parent",void 0),(0,t._)([(0,y.Cb)({readOnly:!0})],p.prototype,"suspended",null),(0,t._)([(0,y.Cb)({readOnly:!0})],p.prototype,"suspendInfo",null),(0,t._)([(0,y.Cb)({readOnly:!0})],p.prototype,"legendEnabled",null),(0,t._)([(0,y.Cb)({type:Boolean,readOnly:!0})],p.prototype,"updating",null),(0,t._)([(0,y.Cb)({readOnly:!0})],p.prototype,"updatingProgress",null),(0,t._)([(0,y.Cb)()],p.prototype,"visible",null),(0,t._)([(0,y.Cb)()],p.prototype,"view",void 0),p=(0,t._)([(0,S.j)("esri.views.layers.LayerView")],p);const f=p}}]);