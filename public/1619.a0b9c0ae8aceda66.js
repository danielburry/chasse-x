"use strict";var $e=Object.defineProperty,qe=Object.defineProperties,ti=Object.getOwnPropertyDescriptors,Ee=Object.getOwnPropertySymbols,ei=Object.prototype.hasOwnProperty,ii=Object.prototype.propertyIsEnumerable,Ie=(Et,_t,u)=>_t in Et?$e(Et,_t,{enumerable:!0,configurable:!0,writable:!0,value:u}):Et[_t]=u,te=(Et,_t)=>{for(var u in _t||(_t={}))ei.call(_t,u)&&Ie(Et,u,_t[u]);if(Ee)for(var u of Ee(_t))ii.call(_t,u)&&Ie(Et,u,_t[u]);return Et},ie=(Et,_t)=>qe(Et,ti(_t));(self.webpackChunkchasse_pwa_front=self.webpackChunkchasse_pwa_front||[]).push([[1619],{25293:(Et,_t,u)=>{u.d(_t,{i:()=>ut});var $=u(72283),at=u(11004);class ut{static getPlacement(Z,Q,j,X){const V=(0,at.W)(Q);if(!V)return null;const ot=(0,$.GP)(Z);return V.execute(ot,Q,j,X)}}},55130:(Et,_t,u)=>{u.d(_t,{_:()=>dt}),u(17083),u(9598);var ut=u(58098),Q=(u(8480),u(79527),u(39351)),j=u(99666),X=u(39406),V=u(64288);const ot=new Map;ot.set(X.LW.MARKER,{multiplier:1,indicesPerRecord:6,verticesPerRecord:4}),ot.set(X.LW.LINE,{multiplier:1,indicesPerRecord:24,verticesPerRecord:8}),ot.set(X.LW.FILL,{multiplier:1,indicesPerRecord:10,verticesPerRecord:10}),ot.set(X.LW.TEXT,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4}),ot.set(X.LW.LABEL,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});var v=u(75734);class I{constructor(b,q,rt){this._start={index:0,vertex:0};const tt=function It(xt,b,q){const{indicesPerRecord:rt,multiplier:tt,verticesPerRecord:H}=ot.get(xt);return{recordBytes:q*Q.XJ*Uint32Array.BYTES_PER_ELEMENT,indexBytes:tt*rt*q*Uint32Array.BYTES_PER_ELEMENT,vertexBytes:tt*H*q*b}}(b,q,rt),H=q/4;this.geometryType=b,this._records=new v.Z(Int32Array,tt.recordBytes),this._indices=new v.Z(Uint32Array,tt.indexBytes),this._vertices=new v.Z(Uint32Array,tt.vertexBytes),this._metrics=new v.Z(Float32Array,0),this._strideInt=H}serialize(b){const q=this._records.buffer(),rt=this._indices.buffer(),tt=this._vertices.buffer(),H=this._metrics.length?this._metrics.buffer():null,mt=4*this._strideInt;return b.push(q,rt,tt),{stride:mt,records:q,indices:rt,vertices:tt,metrics:H}}get strideInt(){return this._strideInt}get recordCount(){return this._records.length/Q.XJ}get vertexCount(){return this._vertices.length/this._strideInt}get indexCount(){return this._indices.length}get indexWriter(){return this._indices}get vertexWriter(){return this._vertices}get metricWriter(){return this._metrics}vertexEnsureSize(b){this._vertices.ensureSize(b)}indexEnsureSize(b){this._indices.ensureSize(b)}recordStart(){this._start.index=this._indices.length,this._start.vertex=this._vertices.length}recordEnd(b,q,rt,tt,H,mt,vt,Wt){this._records.push(b),this._records.push(q),this._records.push(rt),this._records.push(tt),this._records.push(H),this._records.push(mt),this._records.push(vt),this._records.writeF32(Wt)}writeIndex(b){this._indices.push(b)}writeVertex(b){this._vertices.push(b)}writeVertexF32(b){this._vertices.writeF32(b)}copyLastFrom(b,q,rt){const tt=b._records.length-Q.XJ,H=b._records.getValue(tt),mt=b._records.getValue(tt+1),vt=b._records.getValue(tt+2),Wt=b._records.getValue(tt+4),yt=b._records.getValue(tt+6),wt=b._records.getValue(tt+7),bt=this._vertices.length,Ct=(b._start.vertex-this._vertices.length)/this._strideInt,Gt=this._indices.length,Rt=this.vertexCount;for(let Ot=b._start.index;Ot!==b._indices.length;Ot++){const J=b._indices.getValue(Ot);this._indices.push(J-Ct)}for(let Ot=b._start.vertex;Ot!==b._vertices.length;Ot++){const J=b._vertices.getValue(Ot);this._vertices.push(J)}for(let Ot=bt;Ot<=this._vertices.length;Ot+=this._strideInt)this._vertices.i1616Add(Ot,q,rt);this._records.push(H),this._records.push(mt),this._records.push(vt),this._records.push(Gt),this._records.push(Wt),this._records.push(Rt),this._records.push(yt),this._records.push(wt)}}var L=u(55376);function C(xt){switch(xt){case 1:case 8:case 32:return-1;case 2:case 64:return 0;case 4:case 16:case 128:return 1}}function G(xt){switch(xt){case 1:case 2:case 4:return-1;case 8:case 16:return 0;case 32:case 64:case 128:return 1}}class dt{constructor(b,q,rt,tt,H,mt=0){this._hasAggregate=!1,this.hasRecords=!1,this._data={self:new Map,neighbors:new Array},this._version=0,this._current={geometryType:0,writer:null,overlaps:0,start:0,insertAfter:0,sortKey:0,id:0,materialKey:0,indexStart:0,vertStart:0,isDotDensity:!1,bufferingEnabled:!1,metricBoxLenPointer:0},this.hint=q,this.tileKey=b,this._hasAggregate=tt,this._pixelBufferEnabled=H,this._version=mt,this._symbologyType=rt}get hasAggregates(){return this._hasAggregate}get hasPixelBufferEnabled(){return this._pixelBufferEnabled}serialize(b){const q=[];return q.push(this._serializeTileVertexData(this.tileKey,this.tileKey,this._data.self)),this._data.neighbors.forEach((rt,tt)=>{const H=1<<tt,mt=C(H),vt=G(H),Wt=(0,L.M)(new ut.Z(this.tileKey),mt,vt,b),yt=this._serializeTileVertexData(this.tileKey,Wt.id,rt.vertexData);yt.message.bufferIds=rt.displayIds,q.push(yt)}),q}_serializeTileVertexData(b,q,rt){var H,mt,vt,Wt,yt;const tt=new Array;return{message:{tileKeyOrigin:b,tileKey:q,data:{[X.LW.MARKER]:null==(H=rt.get(X.LW.MARKER))?void 0:H.serialize(tt),[X.LW.FILL]:null==(mt=rt.get(X.LW.FILL))?void 0:mt.serialize(tt),[X.LW.LINE]:null==(vt=rt.get(X.LW.LINE))?void 0:vt.serialize(tt),[X.LW.TEXT]:null==(Wt=rt.get(X.LW.TEXT))?void 0:Wt.serialize(tt),[X.LW.LABEL]:null==(yt=rt.get(X.LW.LABEL))?void 0:yt.serialize(tt)},version:this._version},transferList:tt}}featureStart(b,q){this._current.insertAfter=b,this._current.sortKey=q}featureEnd(){}recordStart(b,q,rt,tt){this._current.writer=this._getVertexWriter(rt),this._current.overlaps=0,this._current.indexStart=this._current.writer.indexCount,this._current.vertStart=this._current.writer.vertexCount,this._current.bufferingEnabled=tt,this._current.id=b,this._current.materialKey=q,this._current.geometryType=rt,this._current.isDotDensity=!1,this._current.writer.recordStart()}recordCount(){return this._current.writer.recordCount}vertexCount(){return this._current.writer.vertexCount}indexCount(){return this._current.writer.indexCount}vertexEnsureSize(b){this._current.writer.vertexEnsureSize(b)}indexEnsureSize(b){this._current.writer.indexEnsureSize(b)}vertexBounds(b,q,rt,tt){this._current.bufferingEnabled&&this._addOverlap(b,q,rt,tt)}vertexWrite(b){this._current.writer.writeVertex(b)}vertexWriteF32(b){this._current.writer.writeVertexF32(b)}vertexEnd(){}vertexWriter(){return this._current.writer.vertexWriter}indexWrite(b){this._current.writer.writeIndex(b)}indexWriter(){return this._current.writer.indexWriter}metricWriter(){return this._current.writer.metricWriter}metricStart(b,q,rt,tt,H,mt,vt,Wt){this._current.writer=this._getVertexWriter(X.LW.LABEL);const yt=this._current.writer.metricWriter;yt.push((0,j.jL)(b)),yt.push(q),yt.push(rt),yt.push(tt),yt.push(H),yt.push(mt),yt.push(vt),yt.push(Wt),yt.push(255),this._current.metricBoxLenPointer=yt.push(0)}metricEnd(){const b=this._current.writer.metricWriter;0===b.getValue(this._current.metricBoxLenPointer)&&b.seek(b.length-10)}metricBoxWrite(b,q,rt,tt){const H=this._current.writer.metricWriter;H.incr(this._current.metricBoxLenPointer),H.push(0),H.push(0),H.push(b),H.push(q),H.push(rt),H.push(tt)}recordEnd(){const b=this._current.vertStart,q=this._current.writer.vertexCount-b;if(!q)return!1;this.hasRecords=!0;const rt=this._current.indexStart;if(this._current.writer.recordEnd(this._current.id,this._current.materialKey,this._current.insertAfter,rt,this._current.writer.indexCount-rt,b,q,this._current.sortKey),!this._pixelBufferEnabled||this._hasAggregate||0===this._current.overlaps||this._current.geometryType===X.LW.LABEL)return!0;const H=this._current.writer;for(let mt=0;mt<8;mt++){const vt=1<<mt;if(this._current.overlaps&vt){this._data.neighbors[mt]||(this._data.neighbors[mt]={vertexData:new Map,displayIds:new Set});const Wt=this._data.neighbors[mt],yt=this._current.geometryType;if(!Wt.vertexData.has(yt)){const Rt=(0,V.$_)(yt,this._symbologyType).geometry,Ot=new I(yt,Rt,Q.Ip);Wt.vertexData.set(yt,Ot)}const wt=Wt.vertexData.get(this._current.geometryType),bt=8,Ct=512*-C(vt)*bt,Gt=512*-G(vt)*bt;wt.copyLastFrom(H,Ct,Gt),Wt.displayIds.add(this._current.id)}}return!0}_addOverlap(b,q,rt,tt){this._current.overlaps|=255^((b<0+rt?148:b>=Q.I_-rt?41:189)|(q<0+tt?224:q>=Q.I_-tt?7:231))}_getVertexWriter(b){if(!this._data.self.has(b)){const q=this._data.self,rt=(0,V.$_)(b,this._symbologyType).geometry;q.set(b,new I(b,rt,this.hint.records))}return this._data.self.get(b)}}},246:(Et,_t,u)=>{u.d(_t,{j:()=>Ot});var $=u(15861),ut=(u(8314),u(62208)),U=u(10699),Z=u(58774),Q=u(99666),j=u(26584),X=u(63290),V=u(21286),ot=u(23841),O=u(7547),It=u(61261),v=u(81295),I=u(39351),L=u(39406),x=u(5254),_=u(18716),T=u(50114);function K(J){return J.length-1}function m(J,h,y=1){const[p,w]=function N(J,h){return J[h+1]}(J,h);return Math.sqrt(p*p+w*w)*y}class g{constructor(h,y,p,w,z){this._segments=h,this._index=y,this._distance=p,this._xStart=w,this._yStart=z,this._done=!1}static create(h){return new g(h,0,0,h[0][0],h[0][1])}clone(){return new g(this._segments,this._index,this._distance,this.xStart,this.yStart)}equals(h){return this._index===h._index||h._index===this._index-1&&(0===this._distance||1===h._distance)||h._index===this._index+1&&(1===this._distance||0===h._distance)}leq(h){return this._index<h._index||this._index===h._index&&this._distance<=h._distance}geq(h){return this._index>h._index||this._index===h._index&&this._distance>=h._distance}get _segment(){return this._segments[this._index+1]}get angle(){const h=this.dy;let p=Math.acos((0*h+-1*-this.dx)/(1*this.length));return h>0&&(p=2*Math.PI-p),p}get xStart(){return this._xStart}get yStart(){return this._yStart}get x(){return this.xStart+this.distance*this.dx}get y(){return this.yStart+this.distance*this.dy}get dx(){return this._segment[0]}get dy(){return this._segment[1]}get xMidpoint(){return this.xStart+.5*this.dx}get yMidpoint(){return this.yStart+.5*this.dy}get xEnd(){return this.xStart+this.dx}get yEnd(){return this.yStart+this.dy}get length(){const{dx:h,dy:y}=this;return Math.sqrt(h*h+y*y)}get remainingLength(){return this.length*(1-this._distance)}get backwardLength(){return this.length*this._distance}get distance(){return this._distance}get done(){return this._done}hasPrev(){return this._index-1>=0}hasNext(){return this._index+1<K(this._segments)}next(){return this.hasNext()?(this._xStart+=this.dx,this._yStart+=this.dy,this._distance=0,this._index+=1,this):null}prev(){return this.hasPrev()?(this._index-=1,this._xStart-=this.dx,this._yStart-=this.dy,this._distance=1,this):(this._done=!0,null)}_seekBackwards(h,y){const p=this.backwardLength;if(h<=p)return this._distance=(p-h)/this.length,this;let w=this.backwardLength;for(;this.prev();){if(w+this.length>h)return this._seekBackwards(h-w);w+=this.length}return this._distance=0,y?this:null}seek(h,y=!1){if(h<0)return this._seekBackwards(Math.abs(h),y);if(h<=this.remainingLength)return this._distance=(this.backwardLength+h)/this.length,this;let p=this.remainingLength;for(;this.next();){if(p+this.length>h)return this.seek(h-p,y);p+=this.length}return this._distance=1,y?this:null}}function C(J,h,y,p=!0){const w=function A(J){let h=0;for(let y=0;y<K(J);y++)h+=m(J,y);return h}(J),z=g.create(J),B=w/2;if(!p)return z.seek(B),void y(z.clone(),0,B+0*h,w);const Y=Math.max((w-h)/2,0),et=Math.floor(Y/h);z.seek(B-et*h);for(let ft=-et;ft<=et;ft++)z.x<512&&z.x>=0&&z.y<512&&z.y>=0&&y(z.clone(),ft,B+ft*h,w),z.seek(h)}function lt(J,h){if(h<=0)return;const p=J.length;if(p<3)return;const w=[];let z=0;w.push(0);for(let k=1;k<p;k++)z+=(0,T.TK)(J[k],J[k-1]),w.push(z);h=Math.min(h,.2*z);const B=[];B.push(J[0][0]),B.push(J[0][1]);const Y=J[p-1][0],et=J[p-1][1],ht=(0,T.lu)([0,0],J[0],J[1]);(0,T.Fv)(ht),J[0][0]+=h*ht[0],J[0][1]+=h*ht[1],(0,T.lu)(ht,J[p-1],J[p-2]),(0,T.Fv)(ht),J[p-1][0]+=h*ht[0],J[p-1][1]+=h*ht[1];for(let k=1;k<p;k++)w[k]+=h;w[p-1]+=h;const ft=.5*h;for(let k=1;k<p-1;k++){let Lt=0,Pt=0,Jt=0;for(let pt=k-1;pt>=0&&!(w[pt+1]<w[k]-ft);pt--){const zt=ft+w[pt+1]-w[k],Tt=w[pt+1]-w[pt],St=w[k]-w[pt]<ft?1:zt/Tt;if(Math.abs(St)<1e-6)break;const At=St*St,Vt=St*zt-.5*At*Tt,Ft=St*Tt/h,Mt=J[pt+1],Ht=J[pt][0]-Mt[0],Yt=J[pt][1]-Mt[1];Lt+=Ft/Vt*(Mt[0]*St*zt+.5*At*(zt*Ht-Tt*Mt[0])-At*St*Tt*Ht/3),Pt+=Ft/Vt*(Mt[1]*St*zt+.5*At*(zt*Yt-Tt*Mt[1])-At*St*Tt*Yt/3),Jt+=Ft}for(let pt=k+1;pt<p&&!(w[pt-1]>w[k]+ft);pt++){const zt=ft-w[pt-1]+w[k],Tt=w[pt]-w[pt-1],St=w[pt]-w[k]<ft?1:zt/Tt;if(Math.abs(St)<1e-6)break;const At=St*St,Vt=St*zt-.5*At*Tt,Ft=St*Tt/h,Mt=J[pt-1],Ht=J[pt][0]-Mt[0],Yt=J[pt][1]-Mt[1];Lt+=Ft/Vt*(Mt[0]*St*zt+.5*At*(zt*Ht-Tt*Mt[0])-At*St*Tt*Ht/3),Pt+=Ft/Vt*(Mt[1]*St*zt+.5*At*(zt*Yt-Tt*Mt[1])-At*St*Tt*Yt/3),Jt+=Ft}B.push(Lt/Jt),B.push(Pt/Jt)}B.push(Y),B.push(et);for(let k=0,Lt=0;k<p;k++)J[k][0]=B[Lt++],J[k][1]=B[Lt++]}var ct=u(51919);const dt=X.Z.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),Wt=function vt(J){const h=new Map;return y=>(h.has(y)||h.set(y,J(y)),h.get(y))}(J=>{let h=0;if(0===J)return 1/0;for(;!(J%2);)h++,J/=2;return h}),yt=J=>Math.floor(127*J+127),wt=J=>Math.floor(10*J),bt=J=>Math.round(J*(254/360));class Ct extends ct.Z{constructor(h,y,p,w){var k,Lt,Pt;super(h,p.font.size,p.haloSize||0,p.font.size,p.color&&(0,v.aH)(p.color)||0,p.haloColor&&(0,v.aH)(p.haloColor)||0,p.horizontalAlignment,p.verticalAlignment,(0,It.NS)(y.labelPlacement)?O.v2.MAP:O.v2.SCREEN,p.font.decoration,!1,p.angle||0,p.xoffset,p.yoffset,p.lineWidth,p.lineHeight,null,null,null,null,null),this._outLineLabelAngle=0,this._refPlacementPadding=0,this._refPlacementDirX=0,this._refPlacementDirY=0,this._refOffsetX=0,this._refOffsetY=0,this._zoomLevel=0,this.geometryType=L.LW.LABEL,this._allowOverrun=null!=(k=y.allowOverrun)&&k,this._repeatLabel=null==(Lt=y.repeatLabel)||Lt,this._labelPosition=null!=(Pt=y.labelPosition)?Pt:"curved";const z=function H(J,h){const y=!!J.minScale&&h.scaleToZoom(J.minScale)||0;return(0,V.uZ)(y,0,25.5)}(y,w),B=function mt(J,h){const y=!!J.maxScale&&h.scaleToZoom(J.maxScale)||255;return(0,V.uZ)(y,0,25.5)}(y,w),Y=y.labelPlacement,[et,ht]=(0,It.qv)(Y);this._xAlignD=et,this._yAlignD=ht,this._minZoom=z,this._maxZoom=B,this._refPlacementPadding=(0,ot.F2)(p.haloSize)+I.Iw,this._repeatLabelDistance=y.repeatLabelDistance?(0,ot.F2)(y.repeatLabelDistance):128;const ft=_.Gq.load(h);ft.sdf=!0,this._materialKey=ft.data}static fromLabelClass(h,y){if("esriServerLinePlacementCenterAlong"===h.labelPlacement){const p=h.symbol;p.xoffset=0,p.yoffset=0,p.angle=0,p.font.decoration="none"}return new Ct(h.materialKey,h,h.symbol,y)}get _shapedBox(){return(0,ut.Wg)(this._shapingInfo).bounds}setZoomLevel(h){this._zoomLevel=h}bindReferenceTemplate(h){let y=(0,It.g)(this._xAlignD),p=(0,It.tf)(this._yAlignD);if(this._refOffsetX=0,this._refOffsetY=0,(0,ut.Wi)(h))return void(this._refSymbolAndPlacementOffset=(0,x.Jz)(0,0,yt(y),yt(p)));if("circle"===h.boundsType&&(y||p)){const B=Math.sqrt(y*y+p*p);y/=B,p/=B}const w=Math.max(h.height,h.width);this._refSymbolAndPlacementOffset=(0,x.Jz)(4*this._refPlacementPadding,w,yt(y),yt(p)),this._referenceSize=w,this._refPlacementDirX=y,this._refPlacementDirY=p,this._refOffsetX=h.xOffset,this._refOffsetY=h.yOffset}_write(h,y){if((0,ut.Wi)(this._shapingInfo))return;const p=this._shapingInfo,w=y.getDisplayId(),z="esriGeometryPolygon"===y.geometryType?y.readLegacyCentroid():y.readLegacyGeometry();if(z)switch(this.current={out:h,inId:w,inShaping:p,zoomLevel:this._zoomLevel},y.geometryType){case"esriGeometryPolyline":this._placeLineLabels(z);break;case"esriGeometryPoint":case"esriGeometryPolygon":this._placePointLabels(z);break;default:((J,h="mapview-labeling")=>{dt.error(new j.Z(h,"mapview-labeling"))})(0,`Geometry of type ${y.geometryType} is not supported`)}}_isVisible(h,y){const p=wt(this.current.zoomLevel);return wt(h)<=p&&p<=wt(y)}_placePointLabels(h){const{out:y,inId:p,inShaping:w}=this.current;this._writeGlyphs(y,p,h,w)}_placeLineLabels(h){const y=function R(J,h){const y=h;for(let p=0;p<J.length;p++){let w=J[p];const z=[];z.push(w[0]);for(let Y=1;Y<w.length;Y++){let[et,ht]=z[Y-1];et+=w[Y][0],ht+=w[Y][1],z.push([et,ht])}lt(z,y);const B=[];B.push(z[0]);for(let Y=1;Y<z.length;Y++){const[et,ht]=z[Y-1],[ft,k]=z[Y],Lt=Math.round(ft-et),Pt=Math.round(k-ht);B.push([Lt,Pt])}J[p]=B,w=B}return J}(h.paths,this.current.inShaping.bounds.width),p=this._placeSubdivGlyphs.bind(this),w=(this._shapedBox.width+this._repeatLabelDistance)/2;for(const z of y)C(z,w,p,this._repeatLabel)}_placeSubdivGlyphs(h,y,p,w){const z=Wt(y),B=this._shapedBox.width/2,Y=Math.sqrt(this._repeatLabelDistance)/2,et=Math.min(p,w-p),ht=this.current.inShaping.isMultiline?25:Math.log2(et/(Y+B/2)),ft=0===y?ht:Math.min(z,ht),k=Math.max(this._minZoom,this.current.zoomLevel+1-ft),Lt=this.current.zoomLevel-k,Pt=this._shapedBox.width/2*2**Lt;this.current.inShaping.isMultiline?0===y&&this._placeStraight(h,k):this._allowOverrun&&Lt<0?this._placeStraightAlong(h,this._minZoom):"parallel"===this._labelPosition?this._placeStraightAlong(h,k):"curved"===this._labelPosition&&this._placeCurved(h,k,Pt)}_placeStraight(h,y){const{out:p,inId:w,inShaping:z}=this.current,B=Math.ceil(h.angle*(180/Math.PI)%360),Y=Math.ceil((h.angle*(180/Math.PI)+180)%360);this._outLineLabelAngle=bt(B),this._writeGlyphs(p,w,h,z,y),this._outLineLabelAngle=bt(Y),this._writeGlyphs(p,w,h,z,y)}_placeCurved(h,y,p){const{out:w,inId:z}=this.current;w.metricStart(z,y,h.x,h.y,0,0,0,0);const B=h.clone(),Y=h.angle*(180/Math.PI)%360,et=(h.angle*(180/Math.PI)+180)%360;this._outLineLabelAngle=bt(Y),this._placeFirst(B,y,1),this._placeBack(h,B,y,p,1),this._placeForward(h,B,y,p,1),this._outLineLabelAngle=bt(et),this._placeFirst(B,y,0),this._placeBack(h,B,y,p,0),this._placeForward(h,B,y,p,0),w.metricEnd()}_placeStraightAlong(h,y){const{out:p,inId:w}=this.current;p.metricStart(w,y,h.x,h.y,0,0,0,0);const z=h.clone(),B=h.angle*(180/Math.PI)%360,Y=(h.angle*(180/Math.PI)+180)%360;this._outLineLabelAngle=bt(B),this._placeFirst(z,y,1,!0),this._outLineLabelAngle=bt(Y),this._placeFirst(z,y,0,!0),p.metricEnd()}_placeBack(h,y,p,w,z){const B=h.clone();let Y=h.backwardLength+0;for(;B.prev()&&!(Y>=w);)this._placeOnSegment(B,y,Y,p,-1,z),Y+=B.length+0}_placeForward(h,y,p,w,z){const B=h.clone();let Y=h.remainingLength+0;for(;B.next()&&!(Y>=w);)this._placeOnSegment(B,y,Y,p,1,z),Y+=B.length+0}_placeFirst(h,y,p,w=!1){const z=h,B=this.current.inShaping,Y=B.glyphs,et=this.current.zoomLevel,{out:ht,inId:ft}=this.current;for(const k of Y){const Lt=k.x>B.bounds.x?p:1-p,Pt=Lt*h.remainingLength+(1-Lt)*h.backwardLength,Jt=Math.abs(k.x+k.width/2-B.bounds.x),pt=Math.max(0,et+Math.log2(Jt/(Pt+0))),zt=Math.max(y,w?0:pt);if(k.maxZoom=25,k.angle=h.angle+(1-p)*Math.PI,k.minZoom=zt,this._writeGlyph(ht,ft,z.x,z.y,k),p&&this._isVisible(k.minZoom,k.maxZoom)){const Tt=k.bounds;ht.metricBoxWrite(Tt.center[0],Tt.center[1],Tt.width,Tt.height)}}}_placeOnSegment(h,y,p,w,z,B){const Y=this.current.inShaping.glyphs,{out:et,inId:ht}=this.current,ft=this.current.inShaping,k=this.current.zoomLevel,Jt={x:h.x+p*-z*(h.dx/h.length),y:h.y+p*-z*(h.dy/h.length)};for(const pt of Y){const zt=pt.x>ft.bounds.x?B:1-B;if(!(zt&&1===z||!zt&&-1===z))continue;const Tt=Math.abs(pt.x+pt.width/2-ft.bounds.x),St=Math.max(0,k+Math.log2(Tt/p)-.1),At=Math.max(w,k+Math.log2(Tt/(p+h.length+0)));if(0!==St&&(pt.angle=h.angle+(1-B)*Math.PI,pt.minZoom=At,pt.maxZoom=St,this._writeGlyph(et,ht,Jt.x,Jt.y,pt),B&&this._isVisible(pt.minZoom,pt.maxZoom))){const Vt=pt.bounds;et.metricBoxWrite(Vt.center[0]+(h.x-y.x),Vt.center[1]+(h.y-y.y),Vt.width,Vt.height)}}}_writeGlyphs(h,y,p,w,z=this._minZoom){if(p.x<0||p.x>=512||p.y<0||p.y>=512)return;const B=p.x+this._refOffsetX,Y=p.y-this._refOffsetY;for(const k of w.glyphs)k.minZoom=z,k.maxZoom=this._maxZoom,this._writeGlyph(h,y,B,Y,k);const ft=w.boundsT;h.metricStart(y,z,B,Y,this._refPlacementDirX,this._refPlacementDirY,this._referenceSize,this._materialKey),h.metricBoxWrite(ft.center[0],ft.center[1],ft.width,ft.height),h.metricEnd()}_writeVertexCommon(h,y,p,w){const z=this._color,B=this._haloColor,Y=(0,x.Jz)(0,0,this._size,this._haloSize),et=Math.max(w.minZoom,this._minZoom),ht=Math.min(w.maxZoom,this._maxZoom),ft=(0,x.Jz)(wt(et),wt(ht),this._outLineLabelAngle,0);h.vertexWrite(p),h.vertexWrite(y),h.vertexWrite(z),h.vertexWrite(B),h.vertexWrite(Y),h.vertexWrite(this._refSymbolAndPlacementOffset),h.vertexWrite(ft)}}var Gt=u(18752),Rt=u(1825);class Ot{constructor(h,y,p){this._loadPromise=(0,Z.j)(),this._geometryType=h,this._idField=y,this._templateStore=p}update(h,y){(0,ut.pC)(h.mesh.labels)&&(this._labelTemplates=this._createLabelTemplates(h.mesh.labels,y)),this._schema=h}_createLabelTemplates(h,y){const p=new Map;if("simple"===h.type){for(const w of h.classes){const z=Ct.fromLabelClass(w,y);p.set(w.index,z)}return p}for(const w in h.classes){const z=h.classes[w];for(const B of z){const Y=Ct.fromLabelClass(B,y);p.set(B.index,Y)}}return p}get templates(){return this._templateStore}analyze(h,y,p,w,z,B,Y){var et=this;return(0,$.Z)(function*(){if((0,U.Hc)(Y))return;let ht;"dictionary"===p.type&&(ht=yield p.analyze(et._idField,h.copy(),y,z,B,Y));let ft=0;for(;h.next();){let k;if(k=ht?ht[ft++]:(0,ut.pC)(w)&&(0,Q.nE)(h.getDisplayId())&&1!==h.readAttribute("cluster_count")?w.match(et._idField,h,et._geometryType,z,B):p.match(et._idField,h,et._geometryType,z,B),h.setGroupId(k),(0,Rt.Sl)(k)){const Lt=et._templateStore.getDynamicTemplateGroup(k);for(const Pt of Lt)Pt&&Pt.analyze&&Pt.analyze(et._templateStore,h,z,B)}}return yield et._loadPromise,et._templateStore.finalize(Y)})()}analyzeGraphics(h,y,p,w,z,B){var Y=this;return(0,$.Z)(function*(){if((0,U.Hc)(B))return;const et=h.getCursor();for(p&&(yield p.analyze(Y._idField,et.copy(),y,w,z,B));et.next();){let ht=et.getGroupId();if(null!=ht&&-1!==ht||(ht=p.match(Y._idField,et,et.geometryType,w,z),et.setGroupId(ht)),(0,Rt.Sl)(ht)){const ft=Y._templateStore.getDynamicTemplateGroup(ht);for(const k of ft)k&&k.analyze&&k.analyze(Y._templateStore,et,w,z)}et.setGroupId(ht)}return yield Y._loadPromise,Y._templateStore.finalize(B)})()}writeGraphic(h,y,p,w){const z=y.getGroupId(),B=y.getDisplayId(),Y=this._templateStore.getTemplateGroup(z);if(h.featureStart(y.insertAfter,0),null!=B){if((0,Rt.Sl)(z))for(const et of Y)et&&et.bindFeature(y,null,null);if(Y){for(const et of Y)et&&et.write(h,y,p,w);h.featureEnd()}}}writeCursor(h,y,p,w,z,B,Y){const et=y.getGroupId(),ht=y.getDisplayId(),ft=this._templateStore.getTemplateGroup(et),k=this._schema.mesh.sortKey;let Lt=0;if((0,ut.pC)(k)&&(Lt=null!=k.fieldIndex?y.getComputedNumericAtIndex(k.fieldIndex):y.readAttribute(null!=k.field?k.field:this._idField),Lt*="asc"===k.order?1:-1),h.featureStart(0,null==Lt||isNaN(Lt)?0:Lt),null!=ht&&ft){if((0,Rt.Sl)(et))for(const Pt of ft)Pt.bindFeature(y,p,w);for(const Pt of ft)Pt.write(h,y,z,Y);if((0,ut.pC)(B)&&h.hasRecords){const Pt=B&&this._findLabelRef(ft);this._writeLabels(h,y,B,Pt,z,Y)}h.featureEnd()}}_findLabelRef(h){for(const y of h)if(y instanceof Gt.Z)return y;return null}_writeLabels(h,y,p,w,z,B){for(const Y of p)if((0,ut.pC)(Y)&&Y){const{glyphs:et,rtl:ht,index:ft}=Y,k=this._labelTemplates.get(ft);k.setZoomLevel(z),k.bindReferenceTemplate(w),k.bindTextInfo(et,ht),k.write(h,y,null,B)}}}},88337:(Et,_t,u)=>{u.d(_t,{Z:()=>L});var $=u(62208),at=u(23841),ut=u(31478),U=u(12225),Z=u(67831),Q=u(9545),j=u(82054),X=u(25293),V=u(39351),ot=u(39406),O=u(5254),It=u(18716);const v=3.14159265359/180,L=x=>class extends x{constructor(..._){super(..._),this.angle=0,this.xOffset=0,this.yOffset=0,this.width=0,this.height=0,this.boundsType="square",this._anchorX=0,this._anchorY=0,this._computedWidth=0,this._computedHeight=0,this._vertexBoundsScaleX=1,this._vertexBoundsScaleY=1,this._offsets={xUpperLeft:0,yUpperLeft:0,xUpperRight:0,yUpperRight:0,xBottomLeft:0,yBottomLeft:0,xBottomRight:0,yBottomRight:0},this.geometryType=ot.LW.MARKER}_write(_,T,N,K){const A=T.getDisplayId();_.recordStart(A,this._materialKey,this.geometryType,!0),this._writeGeometry(_,T,A,N,K),_.recordEnd()}_writeGeometry(_,T,N,K,A){if((0,$.pC)(this._markerPlacement))return this._writePlacedMarkers(_,T,K,A);if(!A&&"esriGeometryPoint"===T.geometryType){const g=T.getX(),C=T.getY();return!_.hasAggregates&&_.hasPixelBufferEnabled&&(g<0||g>=513||C<0||C>=513)?void 0:this._writeVertices(_,N,this._getPos(g,C),g,C)}const m=A?(0,j.oB)((0,j.GH)(A),2):"esriGeometryPolygon"===T.geometryType?T.readCentroid():T.readGeometryForDisplay();if(!(0,$.Wi)(m)){if(m.isPoint){const[g,C]=m.coords;return!_.hasAggregates&&_.hasPixelBufferEnabled&&(g<0||g>=512||C<0||C>=512)?void 0:this._writeVertices(_,N,this._getPos(g,C),g,C)}m.forEachVertex((g,C)=>{const G=2*V.I_;g<-G||g>=G||C<-G||C>=G||this._writeVertices(_,N,this._getPos(g,C),g,C)})}}_writePlacedMarkers(_,T,N,K){const A=null!=K?K:T.readLegacyGeometryForDisplay(),m=X.i.getPlacement(A,(0,$.Wg)(this._markerPlacement),(0,at.F2)(1),N.geometryEngine);if(!m)return;const g=T.getDisplayId(),C=(0,Q.c)(),G=(0,U.c)();let lt=m.next();for(;null!=lt;){const ct=lt.tx,dt=-lt.ty;ct>=-128&&ct<=640&&dt>=-128&&dt<=640&&(this._applyTransformation(G,C,-lt.getAngle()/v),this._writeVertices(_,g,this._getPos(ct,dt),ct,dt)),lt=m.next()}}_writeVertices(_,T,N,K,A){const m=It.mE.load(this._materialKey);return m.symbologyType===ot.mD.HEATMAP?this._writeHeatmapVertices(_,T,N,K,A):this._writeMarkerVertices(_,T,m,N,K,A)}_writeMarkerVertices(_,T,N,K,A,m){const g=N.vvRotation,C=_.vertexCount();let G=this._computedWidth*this._vertexBoundsScaleX,st=this._computedHeight*this._vertexBoundsScaleY;if(this.angle){const R=Math.max(G,st);G=R,st=R}if(g){const R=Math.max(this.xOffset,this.yOffset);G+=R,st+=R}_.vertexBounds(A+this.xOffset,m-this.yOffset,G,st),_.vertexWrite(K),_.vertexWrite(this._offsetUpperLeft),_.vertexWrite(this._texUpperLeft),_.vertexWrite(this._bitestAndDistRatio),_.vertexWrite(T),_.vertexWrite(this._fillColor),_.vertexWrite(this._outlineColor),_.vertexWrite(this._sizeOutlineWidth),_.vertexWrite(this._minMaxZoom),_.vertexEnd(),_.vertexWrite(K),_.vertexWrite(this._offsetUpperRight),_.vertexWrite(this._texUpperRight),_.vertexWrite(this._bitestAndDistRatio),_.vertexWrite(T),_.vertexWrite(this._fillColor),_.vertexWrite(this._outlineColor),_.vertexWrite(this._sizeOutlineWidth),_.vertexWrite(this._minMaxZoom),_.vertexEnd(),_.vertexWrite(K),_.vertexWrite(this._offsetBottomLeft),_.vertexWrite(this._texBottomLeft),_.vertexWrite(this._bitestAndDistRatio),_.vertexWrite(T),_.vertexWrite(this._fillColor),_.vertexWrite(this._outlineColor),_.vertexWrite(this._sizeOutlineWidth),_.vertexWrite(this._minMaxZoom),_.vertexEnd(),_.vertexWrite(K),_.vertexWrite(this._offsetBottomRight),_.vertexWrite(this._texBottomRight),_.vertexWrite(this._bitestAndDistRatio),_.vertexWrite(T),_.vertexWrite(this._fillColor),_.vertexWrite(this._outlineColor),_.vertexWrite(this._sizeOutlineWidth),_.vertexWrite(this._minMaxZoom),_.vertexEnd(),this._writeIndices(_,C)}_writeHeatmapVertices(_,T,N,K,A){const m=_.vertexCount();_.vertexBounds(K+this.xOffset,A-this.yOffset,this.width,this.height),_.vertexWrite(N),_.vertexWrite(this._offsetUpperLeft),_.vertexWrite(T),_.vertexEnd(),_.vertexWrite(N),_.vertexWrite(this._offsetUpperRight),_.vertexWrite(T),_.vertexEnd(),_.vertexWrite(N),_.vertexWrite(this._offsetBottomLeft),_.vertexWrite(T),_.vertexEnd(),_.vertexWrite(N),_.vertexWrite(this._offsetBottomRight),_.vertexWrite(T),_.vertexEnd(),this._writeIndices(_,m)}_writeIndices(_,T){_.indexWrite(T+0),_.indexWrite(T+1),_.indexWrite(T+2),_.indexWrite(T+1),_.indexWrite(T+3),_.indexWrite(T+2)}_applyTransformation(_,T,N=0){(0,ut.a)(_,(0,Q.f)(this.xOffset,-this.yOffset)),this.angle+N!==0&&(0,ut.r)(_,_,v*(this.angle+N));const K=this._computedWidth,A=this._computedHeight,m=(this._anchorX-.5)*K,g=(this._anchorY-.5)*A;(0,Z.a)(T,m,g),(0,Z.t)(T,T,_),this._offsetUpperLeft=(0,O.UJ)(16*T[0],16*T[1]),this._offsets.xUpperLeft=T[0],this._offsets.yUpperLeft=T[1],(0,Z.a)(T,m+K,g),(0,Z.t)(T,T,_),this._offsetUpperRight=(0,O.UJ)(16*T[0],16*T[1]),this._offsets.xUpperRight=T[0],this._offsets.yUpperRight=T[1],(0,Z.a)(T,m,g+A),(0,Z.t)(T,T,_),this._offsetBottomLeft=(0,O.UJ)(16*T[0],16*T[1]),this._offsets.xBottomLeft=T[0],this._offsets.yBottomLeft=T[1],(0,Z.a)(T,m+K,g+A),(0,Z.t)(T,T,_),this._offsetBottomRight=(0,O.UJ)(16*T[0],16*T[1]),this._offsets.xBottomRight=T[0],this._offsets.yBottomRight=T[1]}_getPos(_,T){return(0,O.UJ)(Math.round(8*_),Math.round(8*T))}}},44526:(Et,_t,u)=>{u.d(_t,{Z:()=>O});var $=u(62208),at=u(23841),ut=u(82054),U=u(25293),Z=u(39351),Q=u(39406),j=u(5254),X=u(18716),V=u(25797);const O=It=>class extends It{constructor(...v){super(...v),this._isCIM=!1,this._vertexBoundsScale=1,this.geometryType=Q.LW.TEXT,this._aux=(0,j.Jz)(0,0,this._referenceSize,this._bitset)}bindTextInfo(v,I){this._shapingInfo=v&&v.length?(0,$.yw)(v,L=>(0,V.Nr)(L,I,{scale:this._scale,angle:this._angle,xOffset:this._xOffset,yOffset:this._yOffset,hAlign:this._xAlignD,vAlign:this._yAlignD,maxLineWidth:Math.max(32,Math.min(this._lineWidth,512)),lineHeight:Z.xm*Math.max(.25,Math.min(this._lineHeight,4)),decoration:this._decoration,isCIM:this._isCIM})):null}_write(v,I,L,x){const _=I.getDisplayId();this._writeGeometry(v,I,_,L,x)}_writeGeometry(v,I,L,x,_){const T=this._shapingInfo;if((0,$.Wi)(T))return;if((0,$.pC)(this._textPlacement)){const K=null!=_?_:I.readLegacyGeometryForDisplay();return this._writePlacedText(v,L,K,T,x)}const N=_?(0,ut.oB)((0,ut.GH)(_),2):"esriGeometryPolygon"===I.geometryType?I.readCentroid():I.readGeometryForDisplay();if(!(0,$.Wi)(N)){if(N.isPoint){const[K,A]=N.coords;return!v.hasAggregates&&v.hasPixelBufferEnabled&&(K<0||K>=512||A<0||A>=512)?void 0:this._writeGlyphs(v,L,{x:K,y:A},T)}N.forEachVertex((K,A)=>this._writeGlyphs(v,L,{x:K,y:A},T))}}_writePlacedText(v,I,L,x,_){const T=(0,$.Wg)(this._textPlacement),N=U.i.getPlacement(L,T,(0,at.F2)(1),_.geometryEngine);if(!N)return;let K=N.next();for(;null!=K;){const A=-K.getAngle();x.setRotation(A);const m=K.tx,g=-K.ty;m<0||m>=512||g<0||g>=512||(this._writeGlyphs(v,I,{x:m,y:g},x),x.setRotation(-A)),K=N.next()}}_writeGlyphs(v,I,L,x){const _=X.m2.load(this._materialKey),T=(0,j.UJ)(Math.round(8*L.x),Math.round(8*L.y)),N=this._vertexBoundsScale,K=x.bounds,A=2*Math.max(K.width,K.height);for(const m of x.glyphs)_.textureBinding=m.textureBinding,v.recordStart(I,_.data,this.geometryType,!0),v.vertexBounds(L.x+K.x+this._xOffset,L.y+K.y-this._yOffset,A*N,A*N),this._writeVertices(v,I,T,m),v.recordEnd()}_writeGlyph(v,I,L,x,_){const T=X.m2.load(this._materialKey),N=(0,j.UJ)(Math.round(8*L),Math.round(8*x));T.textureBinding=_.textureBinding,v.recordStart(I,T.data,this.geometryType,!0);const K=_.bounds,A=this._vertexBoundsScale;v.vertexBounds(L+K.x*A,x+K.y*A,K.width*A,K.height*A),this._writeVertices(v,I,N,_),v.recordEnd()}_writeVertices(v,I,L,x){const _=v.vertexCount();this._writeVertexCommon(v,I,L,x),v.vertexWrite(x.offsets.upperLeft),v.vertexWrite(x.texcoords.upperLeft),v.vertexEnd(),this._writeVertexCommon(v,I,L,x),v.vertexWrite(x.offsets.upperRight),v.vertexWrite(x.texcoords.upperRight),v.vertexEnd(),this._writeVertexCommon(v,I,L,x),v.vertexWrite(x.offsets.lowerLeft),v.vertexWrite(x.texcoords.lowerLeft),v.vertexEnd(),this._writeVertexCommon(v,I,L,x),v.vertexWrite(x.offsets.lowerRight),v.vertexWrite(x.texcoords.lowerRight),v.vertexEnd(),v.indexWrite(_+0),v.indexWrite(_+1),v.indexWrite(_+2),v.indexWrite(_+1),v.indexWrite(_+3),v.indexWrite(_+2)}_writeVertexCommon(v,I,L,x){const _=this._color,T=this._haloColor,N=(0,j.Jz)(0,0,this._referenceSize,this._bitset),K=(0,j.Jz)(0,0,this._size,this._haloSize);v.vertexWrite(L),v.vertexWrite(I),v.vertexWrite(_),v.vertexWrite(T),v.vertexWrite(K),v.vertexWrite(N),v.vertexWrite(this._minMaxZoom)}}},18752:(Et,_t,u)=>{u.d(_t,{Z:()=>I});var $=u(62208),at=u(23841),ut=u(12225),U=u(9545),Z=u(7547),Q=u(81295),j=u(39351),X=u(39406),V=u(5254),ot=u(18716),O=u(50114),It=u(88337),v=u(94358);class I extends((0,It.Z)(v.Z)){constructor(x,_,T,N,K,A,m,g,C,G,st,R,lt,ct,dt,xt,b,q,rt,tt,H,mt,vt){super(),this.angle=N,this.height=m,this.width=A,this.xOffset=_*rt,this.yOffset=T*rt,this._markerPlacement=tt,this._effects=H,this._anchorX=.5-(.5+xt)*dt.width/dt.width,this._anchorY=.5-(.5+b)*dt.height/dt.height,this._minMaxZoom=(0,V.UJ)(Math.round(mt*j.MI),Math.round(vt*j.MI));const Wt=(ct===Z.v2.MAP?j.Tz:j.CQ)|(st?j.Uh:0)|(lt?j.oK:0)|(R?j.e0:0),yt=dt&&dt.sdf,wt=ot.mE.load(x);wt.sdf=yt,wt.pattern=!0,wt.textureBinding=dt.textureBinding,this._materialKey=wt.data,this._fillColor=K,this._outlineColor=C,this._sizeOutlineWidth=(0,V.Jz)(Math.round(Math.min(Math.sqrt(128*A),255)),Math.round(Math.min(Math.sqrt(128*m),255)),Math.round(Math.min(Math.sqrt(128*G),255)),Math.round(Math.min(Math.sqrt(128*g),255)));const bt=dt.rect.x+j.fL,Ct=dt.rect.y+j.fL,Gt=bt+dt.width,Rt=Ct+dt.height;this._offsets.xUpperLeft=bt,this._offsets.yUpperLeft=Ct,this._offsets.xUpperRight=Gt,this._offsets.yUpperRight=Ct,this._offsets.xBottomLeft=bt,this._offsets.yBottomLeft=Rt,this._offsets.xBottomRight=Gt,this._offsets.yBottomRight=Rt,wt.symbologyType===X.mD.PIE_CHART?(this._texUpperLeft=(0,V.UJ)(0,1),this._texUpperRight=(0,V.UJ)(1,1),this._texBottomLeft=(0,V.UJ)(0,0),this._texBottomRight=(0,V.UJ)(1,0)):(this._texUpperLeft=(0,V.UJ)(bt,Ct),this._texUpperRight=(0,V.UJ)(Gt,Ct),this._texBottomLeft=(0,V.UJ)(bt,Rt),this._texBottomRight=(0,V.UJ)(Gt,Rt)),A*=q,m*=q,A*=rt,m*=rt;const Ot=Math.round(64*q);this._bitestAndDistRatio=(0,V.UJ)(Wt,Ot),this._computedWidth=A,this._computedHeight=m;const J=(0,U.c)(),h=(0,ut.c)();this._applyTransformation(h,J)}static fromCIMMarker(x,_,T){const A=x.size,m=(_&&_.width||1)/(_&&_.height||1)*x.scaleX,g=x.scaleSymbolsProportionally&&x.frameHeight?A/x.frameHeight:1;let C=(0,Q.t2)(x.color);const G=(0,Q.t2)(x.outlineColor),st=(0,at.F2)(A),R=st*m,lt=(0,at.F2)(x.offsetX||0),ct=(0,at.F2)(x.offsetY||0),dt=(0,at.F2)(x.outlineWidth||0)*g,xt=x.alignment||Z.v2.SCREEN,b=(0,at.F2)(x.referenceSize),[q,rt]=(0,O._f)(x.scaleInfo,T);_.sdf||0!==C||(C=-1);let tt=x.rotation||0;x.rotateClockwise||(tt=-tt);let H=0,mt=0;const vt=x.anchorPoint;vt&&(x.isAbsoluteAnchorPoint?A&&(H=-vt.x/(A*m),mt=vt.y/A):(H=vt.x,mt=vt.y));const Wt=new I(x.materialKey,lt,ct,tt,C,R,st,b,G,dt,x.colorLocked,x.scaleSymbolsProportionally,!1,xt,_,H,mt,x.sizeRatio,(0,$.Pt)(x.scaleFactor,1),x.markerPlacement,x.effects,q,rt);return Wt._vertexBoundsScaleX=x.maxVVSize?x.maxVVSize/R:1,Wt._vertexBoundsScaleY=x.maxVVSize?x.maxVVSize/st:1,Wt}static fromPictureMarker(x,_){const T=Math.round((0,at.F2)(x.width)),N=Math.round((0,at.F2)(x.height)),K=j.ru,A=Math.round((0,at.F2)(x.xoffset||0)),m=Math.round((0,at.F2)(x.yoffset||0)),g=new I(x.materialKey,A,m,x.angle,K,T,N,N,0,0,!1,!1,!1,Z.v2.SCREEN,_,0,0,1,1,null,null,O.Xe,O.eW);return g._vertexBoundsScaleX=x.maxVVSize?x.maxVVSize/x.width:1,g._vertexBoundsScaleY=x.maxVVSize?x.maxVVSize/x.height:1,g}static fromSimpleMarker(x,_){const T=(0,Q.aH)(x.color),N=Math.round((0,at.F2)(x.size)),K=N,A=Math.round((0,at.F2)(x.xoffset||0)),m=Math.round((0,at.F2)(x.yoffset||0)),g=x.style,C=x.outline,G=0|(C&&C.color&&(0,Q.aH)(C.color)),st=0|(C&&C.width&&Math.round((0,at.F2)(C.width))),R=new I(x.materialKey,A,m,x.angle,T,N,K,K,G,st,!1,!1,"esriSMSCross"===g||"esriSMSX"===g,Z.v2.SCREEN,_,0,0,126/64,1,null,null,O.Xe,O.eW);return R.boundsType="esriSMSCircle"===g?"circle":"square",R._vertexBoundsScaleX=x.maxVVSize?x.maxVVSize/x.size:1,R._vertexBoundsScaleY=x.maxVVSize?x.maxVVSize/x.size:1,R}static fromLineSymbolMarker(x,_){const T=(0,Q.aH)(x.color),K=Math.round((0,at.F2)(6*x.lineWidth)),A=K,m="cross"===x.style||"x"===x.style;let g;switch(x.placement){case"begin-end":g=Z.Tx.Both;break;case"begin":g=Z.Tx.JustBegin;break;case"end":g=Z.Tx.JustEnd;break;default:g=Z.Tx.None}const C={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:g,offsetAlongLine:0},G=new I(x.materialKey,0,0,0,T,K,A,A/6,T,m?Math.round((0,at.F2)(x.lineWidth)):0,!1,!1,m,Z.v2.MAP,_,0,0,126/64,1,C,null,O.Xe,O.eW);return G.boundsType="circle"===x.style?"circle":"square",G}}},94358:(Et,_t,u)=>{u.d(_t,{Z:()=>ut});var $=u(62208),at=u(73608);class ut{bindFeature(Z,Q,j){}write(Z,Q,j,X){var O;if((0,$.Wi)(this._effects)||0===(null==(O=this._effects)?void 0:O.length))return this._write(Z,Q,X);const V=at.j.executeEffects(this._effects,Q.readLegacyGeometryForDisplay(),X.geometryEngine);let ot=at.j.next(V);for(;ot;)this._write(Z,Q,X,ot),ot=at.j.next(V)}_write(Z,Q,j,X){}}},1825:(Et,_t,u)=>{u.d(_t,{Wr:()=>Ne,Sl:()=>Pe});var $=u(15861),at=u(26584),ut=u(63290),U=u(10699),Z=u(24837),Q=u(39406),j=u(18716),X=u(62208),V=u(23841),ot=u(81295),O=u(39351),It=u(43289),v=u(5254),I=u(50114),L=u(82054),x=u(64288),T=(u(11915),u(58774)),N=u(88071),K=u(97938),A=u(47018);function m(a,i,s,n,r,l,c){B=0;const f=(n-s)*l,d=r&&r.length,M=d?(r[0]-s)*l:f;let S,E,D,P,W,F=g(i,s,0,0,M,l,!0);if(F&&F.next!==F.prev){if(d&&(F=function xt(a,i,s,n,r,l){const c=new Array;for(let f=0,d=n.length;f<d;f++){const M=g(a,i,0,n[f]*l,f<d-1?n[f+1]*l:s*l,l,!1);M===M.next&&(M.steiner=!0),c.push(dt(M))}c.sort(Gt);for(const f of c)b(f,r),r=C(r,r.next);return r}(i,s,n,r,F,l)),f>80*l){S=D=i[0+s*l],E=P=i[1+s*l];for(let nt=l;nt<M;nt+=l){const it=i[nt+s*l],gt=i[nt+1+s*l];S=Math.min(S,it),E=Math.min(E,gt),D=Math.max(D,it),P=Math.max(P,gt)}W=Math.max(D-S,P-E),W=0!==W?1/W:0}G(F,a,l,S,E,W,c,0)}}function g(a,i,s,n,r,l,c){let f;if(c===function Wt(a,i,s,n,r,l){let c=0;for(let f=n,d=r-l;f<r;f+=l)c+=(a[d+i*l]-a[f+i*l])*(a[f+1+i*l]+a[d+1+i*l]),d=f;return c}(a,i,0,n,r,l)>0)for(let d=n;d<r;d+=l)f=lt(d+i*l,a[d+i*l],a[d+1+i*l],f);else for(let d=r-l;d>=n;d-=l)f=lt(d+i*l,a[d+i*l],a[d+1+i*l],f);return f&&Ct(f,f.next)&&(ct(f),f=f.next),f}function C(a,i=a){if(!a)return a;let s,n=a;do{if(s=!1,n.steiner||!Ct(n,n.next)&&0!==H(n.prev,n,n.next))n=n.next;else{if(ct(n),n=i=n.prev,n===n.next)break;s=!0}}while(s||n!==i);return i}function G(a,i,s,n,r,l,c,f){if(!a)return;!f&&l&&(a=rt(a,n,r,l));let d=a;for(;a.prev!==a.next;){const M=a.prev,S=a.next;if(l?R(a,n,r,l):st(a))i.push(M.index/s+c),i.push(a.index/s+c),i.push(S.index/s+c),ct(a),a=S.next,d=S.next;else if((a=S)===d){f?1===f?G(a=Rt(a,i,s,c),i,s,n,r,l,c,2):2===f&&Ot(a,i,s,n,r,l,c):G(C(a),i,s,n,r,l,c,1);break}}}function st(a){const i=a.prev,s=a,n=a.next;if(H(i,s,n)>=0)return!1;let r=a.next.next;const l=r;let c=0;for(;r!==a.prev&&(0===c||r!==l);){if(c++,yt(i.x,i.y,s.x,s.y,n.x,n.y,r.x,r.y)&&H(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function R(a,i,s,n){const r=a.prev,l=a,c=a.next;if(H(r,l,c)>=0)return!1;const M=r.x>l.x?r.x>c.x?r.x:c.x:l.x>c.x?l.x:c.x,S=r.y>l.y?r.y>c.y?r.y:c.y:l.y>c.y?l.y:c.y,E=bt(r.x<l.x?r.x<c.x?r.x:c.x:l.x<c.x?l.x:c.x,r.y<l.y?r.y<c.y?r.y:c.y:l.y<c.y?l.y:c.y,i,s,n),D=bt(M,S,i,s,n);let P=a.prevZ,W=a.nextZ;for(;P&&P.z>=E&&W&&W.z<=D;){if(P!==a.prev&&P!==a.next&&yt(r.x,r.y,l.x,l.y,c.x,c.y,P.x,P.y)&&H(P.prev,P,P.next)>=0||(P=P.prevZ,W!==a.prev&&W!==a.next&&yt(r.x,r.y,l.x,l.y,c.x,c.y,W.x,W.y)&&H(W.prev,W,W.next)>=0))return!1;W=W.nextZ}for(;P&&P.z>=E;){if(P!==a.prev&&P!==a.next&&yt(r.x,r.y,l.x,l.y,c.x,c.y,P.x,P.y)&&H(P.prev,P,P.next)>=0)return!1;P=P.prevZ}for(;W&&W.z<=D;){if(W!==a.prev&&W!==a.next&&yt(r.x,r.y,l.x,l.y,c.x,c.y,W.x,W.y)&&H(W.prev,W,W.next)>=0)return!1;W=W.nextZ}return!0}function lt(a,i,s,n){const r=p.create(a,i,s);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function ct(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function dt(a){let i=a,s=a;do{(i.x<s.x||i.x===s.x&&i.y<s.y)&&(s=i),i=i.next}while(i!==a);return s}function b(a,i){if(i=function q(a,i){let s=i;const n=a.x,r=a.y;let l,c=-1/0;do{if(r<=s.y&&r>=s.next.y&&s.next.y!==s.y){const D=s.x+(r-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(D<=n&&D>c){if(c=D,D===n){if(r===s.y)return s;if(r===s.next.y)return s.next}l=s.x<s.next.x?s:s.next}}s=s.next}while(s!==i);if(!l)return null;if(n===c)return l.prev;const f=l,d=l.x,M=l.y;let S,E=1/0;for(s=l.next;s!==f;)n>=s.x&&s.x>=d&&n!==s.x&&yt(r<M?n:c,r,d,M,r<M?c:n,r,s.x,s.y)&&(S=Math.abs(r-s.y)/(n-s.x),(S<E||S===E&&s.x>l.x)&&wt(s,a)&&(l=s,E=S)),s=s.next;return l}(a,i)){const s=y(i,a);C(s,s.next)}}function rt(a,i,s,n){for(let r;r!==a;r=r.next){if(r=r||a,null===r.z&&(r.z=bt(r.x,r.y,i,s,n)),r.prev.next!==r||r.next.prev!==r)return r.prev.next=r,r.next.prev=r,rt(a,i,s,n);r.prevZ=r.prev,r.nextZ=r.next}return a.prevZ.nextZ=null,a.prevZ=null,function tt(a){let i,s=1;for(;;){let n,r=a;a=null,i=null;let l=0;for(;r;){l++,n=r;let c=0;for(;c<s&&n;c++)n=n.nextZ;let f=s;for(;c>0||f>0&&n;){let d;0===c?(d=n,n=n.nextZ,f--):0!==f&&n?r.z<=n.z?(d=r,r=r.nextZ,c--):(d=n,n=n.nextZ,f--):(d=r,r=r.nextZ,c--),i?i.nextZ=d:a=d,d.prevZ=i,i=d}r=n}if(i.nextZ=null,s*=2,l<2)return a}}(a)}function H(a,i,s){return(i.y-a.y)*(s.x-i.x)-(i.x-a.x)*(s.y-i.y)}function mt(a,i,s,n){return!!(Ct(a,i)&&Ct(s,n)||Ct(a,n)&&Ct(s,i))||H(a,i,s)>0!=H(a,i,n)>0&&H(s,n,a)>0!=H(s,n,i)>0}function yt(a,i,s,n,r,l,c,f){return(r-c)*(i-f)-(a-c)*(l-f)>=0&&(a-c)*(n-f)-(s-c)*(i-f)>=0&&(s-c)*(l-f)-(r-c)*(n-f)>=0}function wt(a,i){return H(a.prev,a,a.next)<0?H(a,i,a.next)>=0&&H(a,a.prev,i)>=0:H(a,i,a.prev)<0||H(a,a.next,i)<0}function bt(a,i,s,n,r){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=32767*(a-s)*r)|a<<8))|a<<4))|a<<2))|a<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-n)*r)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function Ct(a,i){return a.x===i.x&&a.y===i.y}function Gt(a,i){return a.x-i.x}function Rt(a,i,s,n){let r=a;do{const l=r.prev,c=r.next.next;!Ct(l,c)&&mt(l,r,r.next,c)&&wt(l,c)&&wt(c,l)&&(i.push(l.index/s+n),i.push(r.index/s+n),i.push(c.index/s+n),ct(r),ct(r.next),r=a=c),r=r.next}while(r!==a);return r}function Ot(a,i,s,n,r,l,c){let f=a;do{let d=f.next.next;for(;d!==f.prev;){if(f.index!==d.index&&J(f,d)){let M=y(f,d);return f=C(f,f.next),M=C(M,M.next),G(f,i,s,n,r,l,c,0),void G(M,i,s,n,r,l,c,0)}d=d.next}f=f.next}while(f!==a)}function J(a,i){return a.next.index!==i.index&&a.prev.index!==i.index&&!function vt(a,i){let s=a;do{if(s.index!==a.index&&s.next.index!==a.index&&s.index!==i.index&&s.next.index!==i.index&&mt(s,s.next,a,i))return!0;s=s.next}while(s!==a);return!1}(a,i)&&wt(a,i)&&wt(i,a)&&function h(a,i){let s=a,n=!1;const r=(a.x+i.x)/2,l=(a.y+i.y)/2;do{s.y>l!=s.next.y>l&&s.next.y!==s.y&&r<(s.next.x-s.x)*(l-s.y)/(s.next.y-s.y)+s.x&&(n=!n),s=s.next}while(s!==a);return n}(a,i)}function y(a,i){const s=p.create(a.index,a.x,a.y),n=p.create(i.index,i.x,i.y),r=a.next,l=i.prev;return a.next=i,i.prev=a,s.next=r,r.prev=s,n.next=s,s.prev=n,l.next=n,n.prev=l,n}class p{constructor(){this.index=0,this.x=0,this.y=0,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}static create(i,s,n){const r=B<w.length?w[B++]:new p;return r.index=i,r.x=s,r.y=n,r.prev=null,r.next=null,r.z=null,r.prevZ=null,r.nextZ=null,r.steiner=!1,r}}const w=new Array;let B=0;for(let a=0;a<8096;a++)w.push(new p);const et=new A.b(0,0,0,1,0),ht=new A.b(0,0,0,1,0);function ft(a,i,s){let n=0;for(let r=1;r<s;r++)n+=(a[2*(i+r)]-a[2*(i+r-1)])*(a[2*(i+r)+1]+a[2*(i+r-1)+1]);return n}function k(a,i,s,n,r){let l=0;for(let f=s;f<n;f+=3){const d=2*(a[f]-r),M=2*(a[f+1]-r),S=2*(a[f+2]-r);l+=Math.abs((i[d]-i[S])*(i[M+1]-i[d+1])-(i[d]-i[M])*(i[S+1]-i[d+1]))}return l}et.setExtent(O.I_),ht.setExtent(O.I_);var At=u(7547),Vt=u(46519);const Yt=a=>class extends a{constructor(...i){super(...i),this.tessellationProperties={},this._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0},this.geometryType=Q.LW.LINE}writeGeometry(i,s,n,r){this._writeGeometry(i,s,n,r)}_initializeTessellator(i){const s=j.a.load(this._materialKey),n=j.dk.load(this._materialKey),r=this._tessellationOptions,c=this.tessellationProperties._halfWidth<O.tQ&&!i&&!(s.vvSizeFieldStops||s.vvSizeMinMaxValue||s.vvSizeScaleStops||s.vvSizeUnitValue);this.tessellationProperties.minMaxZoom=this._minMaxZoom,r.wrapDistance=65535,r.textured=this._isDashed||this._hasPattern,r.offset=this.tessellationProperties.offset,r.halfWidth=this.tessellationProperties._halfWidth;const f=c?0:1,d=(0,j.CA)(n)?Ce:Se;this._lineTessellator=new Vt.z(d(this.tessellationProperties,f,f),we(this.tessellationProperties),c)}_write(i,s,n,r){const l="esriGeometryPoint"===s.geometryType;i.recordStart(s.getDisplayId(),this._materialKey,this.geometryType,l),this._writeGeometry(i,s,r,l),i.recordEnd()}_writeGeometry(i,s,n,r){const l=null!=n?n:s.readLegacyGeometryForDisplay(),c=this._getLines(l,r);(0,X.Wi)(c)||this._writeVertices(i,s,c)}_getLines(i,s){if((0,X.Wi)(i))return null;const n=i.paths||i.rings;return(0,X.Wi)(n)?null:function St(a,i){ht.setPixelMargin(i);const s=ht,n=-i,r=O.I_+i;let l=[],c=!1,f=0;for(;f<a.length;){const d=[],M=a[f];if(!M)return null;s.reset(K.V.LineString);let[S,E]=M[0];if(c)s.moveTo(S,E);else{if(S<n||S>r||E<n||E>r){c=!0;continue}d.push({x:S,y:E})}let D=!1;const P=M.length;for(let W=1;W<P;++W)if(S+=M[W][0],E+=M[W][1],c)s.lineTo(S,E);else{if(S<n||S>r||E<n||E>r){D=!0;break}d.push({x:S,y:E})}if(D)c=!0;else{if(c){const W=s.resultWithStarts();if(W)for(const F of W)l.push(F)}else l.push({line:d,start:0});f++,c=!1}}return l=l.filter(d=>d.line.length>1),0===l.length?null:l}(n,s?256:16)}_writeVertices(i,s,n){const r=s.getDisplayId(),l=i.vertexCount(),c=this.tessellationProperties,f=this._tessellationOptions;c.out=i,c.id=r,c.indexCount=0,c.vertexCount=0,c.offset=l,f.capType=this._capType,f.joinType=this._joinType;const d=j.dk.load(this._materialKey);this.tessellationProperties.key=(0,j.CA)(d)?d:j.a.load(this._materialKey);for(const{line:M,start:S}of n)f.initialDistance=S%65535,this._lineTessellator.tessellate(M,f)}},Se=(a,i,s)=>(n,r,l,c,f,d,M,S,E,D,P)=>{const W=(0,v.UJ)(P,Math.ceil(16*a._halfWidth)),F=(0,v.Jz)(Math.round(16*M),Math.round(16*S),Math.round(16*E),Math.round(16*D)),nt=(0,v.Jz)(16*f,16*d,0,a._bitset),it=a.out;return it.vertexBounds(n,r,i,s),it.vertexWrite((0,v.UJ)(8*n,8*r)),it.vertexWrite(a.id),it.vertexWrite(a._fillColor),it.vertexWrite(F),it.vertexWrite(W),it.vertexWrite(a._tl),it.vertexWrite(a._br),it.vertexWrite(nt),it.vertexWrite((0,v.UJ)(Math.ceil(16*a._halfReferenceWidth),0)),it.vertexWrite(a.minMaxZoom),it.vertexEnd(),a.offset+a.vertexCount++},Ce=(a,i,s)=>(n,r,l,c,f,d,M,S,E,D,P)=>{const W=(0,v.UJ)(16*a._halfWidth,16*a._halfReferenceWidth),F=(0,v.Jz)(16*M+128,16*S+128,16*E+128,16*D+128),nt=a.out,it=a._bitset<<24|a.id;nt.vertexBounds(n,r,i,s),nt.vertexWrite((0,v.UJ)(8*n,8*r)),nt.vertexWrite(it),nt.vertexWrite(a._fillColor);const gt=(0,j.Xp)(a.key);return gt||(nt.vertexWrite(0),nt.vertexWrite(0)),nt.vertexWrite(0),nt.vertexWrite(W),nt.vertexWrite(F),gt||nt.vertexWrite(a.minMaxZoom),nt.vertexEnd(),a.offset+a.vertexCount++},we=a=>(i,s,n)=>{const r=a.out;r.indexWrite(i),r.indexWrite(s),r.indexWrite(n),a.indexCount+=3};var le=u(94358);const be=ut.Z.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate");class kt extends(Yt(le.Z)){constructor(i,s,n,r,l,c,f,d,M,S,E,D,P,W,F,nt,it,gt,Dt,Bt){super();const Zt=j.a.load(i);s&&(Zt.sdf=s.sdf,Zt.pattern=!0,Zt.textureBinding=s.textureBinding),this._capType=r,this._joinType=l,this._miterLimitCosine=(0,I.NW)(c),this.tessellationProperties._fillColor=f,this.tessellationProperties._tl=d,this.tessellationProperties._br=M,this._hasPattern=S,this._isDashed=E,this._zOrder=it,this._effects=gt,this._minMaxZoom=(0,v.UJ)(Math.round(Dt*O.MI),Math.round(Bt*O.MI)),this._materialKey=Zt.data,this.tessellationProperties._bitset=(P?O.Uh:0)|(W?O.SD:0)|(D?O._6:0)|(F?O.Iv:0),this.tessellationProperties._halfWidth=.5*n,this.tessellationProperties._halfReferenceWidth=.5*nt,this.tessellationProperties.offset=0,this._initializeTessellator(!1)}static fromCIMLine(i,s,n){const r=i.color,l=i.scaleFactor||1,c=!!i.dashTemplate;let f=i.cap;c&&f===At.RL.ROUND&&(f=At.RL.SQUARE);const d=i.join,M=(0,V.F2)(i.width)*l,S=(0,V.F2)(i.referenceWidth),E=(0,V.F2)(i.miterLimit),D=r&&(0,ot.t2)(r)||0,[P,W]=(0,I._f)(i.scaleInfo,n);if(!s)return new kt(i.materialKey,s,M,f,d,E,D,0,0,!1,c,i.scaleDash,i.colorLocked,!1,i.sampleAlphaOnly,S,i.zOrder,i.effects,P,W);const{rect:nt,width:it,height:gt}=s,Dt=nt.x+O.fL,Bt=nt.y+O.fL,Zt=Dt+it,jt=Bt+gt,ee=(0,v.UJ)(Dt,Bt),Qt=(0,v.UJ)(Zt,jt);return new kt(i.materialKey,s,M,f,d,E,D,ee,Qt,!0,c,i.scaleDash,i.colorLocked,!1,i.sampleAlphaOnly,S,i.zOrder,i.effects,P,W)}static fromFillOutline(i){var n;const s=j.dk.load(i.materialKey);return(0,j.CA)(s)&&i.outline&&"esriSLSSolid"===(null==(n=i.outline)?void 0:n.style)?kt.fromSimpleLine(te({hash:"",materialKey:i.materialKey},i.outline),null,!0):null}static fromSimpleLine(i,s,n=!1){const{color:r}=i,l="esriSLSSolid"!==i.style&&"esriSLSNull"!==i.style,c=(0,x.ws)(i.cap||"round"),f=(0,x.xV)(i.join||"round");let d=r&&"esriSLSNull"!==i.style&&(0,ot.aH)(r)||0;"esriSLSNull"===i.style&&(d=0);const M=(0,V.F2)(i.width),S=i.miterLimit;if(!s)return new kt(i.materialKey,s,M,c,f,S,d,0,0,!1,l,!0,!1,n,!1,M,0,null,I.Xe,I.eW);const{rect:E,width:D,height:P}=s,W=E.x+O.fL,F=E.y+O.fL,nt=W+D,it=F+P,gt=(0,v.UJ)(W,F),Dt=(0,v.UJ)(nt,it);return new kt(i.materialKey,s,M,c,f,S,d,gt,Dt,!0,l,!0,!1,n,!1,M,0,null,I.Xe,I.eW)}static fromPictureLineSymbol(i,s,n,r){return be.error("PictureLineSymbol support does not exist!"),null}}const ye=a=>class extends a{constructor(...i){super(...i),this.forceLibtess=!1,this._bitset=0,this._lineTemplate=null,this.geometryType=Q.LW.FILL}_maybeAddLineTemplate(i){this._lineTemplate=kt.fromFillOutline(i)}_write(i,s,n,r){const l="esriGeometryPoint"===s.geometryType,c=j.dk.load(this._materialKey);i.recordStart(s.getDisplayId(),this._materialKey,this.geometryType,l),this._writeGeometry(i,s,c,r,l),(0,j.CA)(c)&&(0,X.pC)(this._lineTemplate)&&this._lineTemplate.writeGeometry(i,s,r,l),i.recordEnd()}_writeGeometry(i,s,n,r,l){const c=this._getGeometry(s,r,l);if((0,X.Wi)(c))return;const f=[];if(!(c.maxLength>100)&&!this.forceLibtess&&function Pt(a,i){const{coords:s,lengths:n,hasIndeterminateRingOrder:r}=i,c=a;if(r)return!1;let f=0;for(let d=0;d<n.length;){let M=d,S=n[d],E=ft(s,f,S);const D=[];for(;++M<n.length;){const nt=n[M],it=ft(s,f+S,nt);if(!(it>0))break;E+=it,D.push(f+S),S+=nt}const P=c.length;m(c,s,f,f+S,D,2,0);const W=k(c,s,P,c.length,0),F=Math.abs(E);if(Math.abs((W-F)/Math.max(1e-7,F))>1e-5)return c.length=0,!1;d=M,f+=S}return!0}(f,c))return void(f.length&&this._writeVertices(i,s,c.coords,c.lengths,n,f));const d=function pt(a){const{coords:i,lengths:s}=a,{buffer:n}=(0,T.b)(i,s);return n}(c);this._writeVertices(i,s,d,[d.length/2],n)}_writeVertex(i,s,n,r,l,c){const f=(0,v.UJ)(1*r,1*l);if(i.vertexBounds(r,l,0,0),i.vertexWrite(f),i.vertexWrite(s),n.symbologyType===Q.mD.DOT_DENSITY)i.vertexWriteF32(1/Math.abs(c.readGeometryArea()));else{i.vertexWrite(this.fillColor);const d=(0,j.Xp)(n);d||(i.vertexWrite(this.tl),i.vertexWrite(this.br)),i.vertexWrite(this.aux2_1),i.vertexWrite(this.aux2_2),i.vertexWrite(this.aux3),d||i.vertexWrite(this._minMaxZoom)}}_writeVertices(i,s,n,r,l,c){const f=s.getDisplayId(),d=this._bitset<<24|f,M=r.reduce((P,W)=>P+W),S=(0,x.$_)(l.geometryType,l.symbologyType).geometry/4,E=i.vertexCount();i.vertexEnsureSize(S*M);let D=0;if(c)for(const P of c)this._writeVertex(i,d,l,n[2*P],n[2*P+1],s),D++;else for(let P=0;P<n.length;P+=2){const W=Math.round(n[P]),F=Math.round(n[P+1]);this._writeVertex(i,d,l,W,F,s),D++}i.indexEnsureSize(D);for(let P=0;P<D;P++)i.indexWrite(P+E)}_getGeometry(i,s,n){const r=s?(0,L.oB)((0,L.GH)(s),2):i.readGeometryForDisplay();return r?function Tt(a,i){if((0,X.Wi)(a))return null;if(!function zt(a,i,s){let n=0;for(let r=0;r<a.lengths.length;r++){const l=a.lengths[r];for(let c=0;c<l;c++){const f=a.coords[2*(c+n)],d=a.coords[2*(c+n)+1];if(f<i||f>s||d<i||d>s)return!0}n+=l}return!1}(a,-128,O.I_+128))return a;et.setPixelMargin(i),et.reset(K.V.Polygon);let s=0;for(let c=0;c<a.lengths.length;c++){const f=a.lengths[c];let d=a.coords[2*(0+s)],M=a.coords[2*(0+s)+1];et.moveTo(d,M);for(let S=1;S<f;S++)d=a.coords[2*(S+s)],M=a.coords[2*(S+s)+1],et.lineTo(d,M);et.close(),s+=f}const n=et.result(!1);if(!n)return null;const r=[],l=[];for(const c of n){let f=0;for(const d of c)l.push(d.x),l.push(d.y),f++;r.push(f)}return new N.Z(r,l)}(r,n?256:8):null}};var ze=u(84175),se=u(80991);const pe=ut.Z.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");class re extends le.Z{constructor(i){super(),this._ongoingMaterialRequestMap=new Map,this._materialCache=new Map,this._dynamicPropertyMap=new Map,this._cimLayer=i}analyze(i,s,n,r,l){if(l&&0===l.length)return null;const c=l&&l.length>0,f=s.readLegacyFeature(),d=s.getObjectId(),M=this._materialCache,S=this._cimLayer.materialHash;if(!S)return pe.error("A Dynamic mesh template must have a material hash value or function!"),Promise.reject(null);const E="function"==typeof S?S(f,n,r,d):S;if(M.has(E)){const Dt=M.get(E);return Promise.resolve(Dt)}const D=this._ongoingMaterialRequestMap.get(E);if(D)return D;const P=this._cimLayer,W=(0,ze.S)(P.cim,this._cimLayer.materialOverrides);W.mosaicHash=E;const{type:F,url:nt}=P,it={cim:W,type:F,mosaicHash:E,url:nt,size:null,dashTemplate:null,text:null,fontName:null,objectId:d,animatedSymbolProperties:null};switch(F){case"marker":it.size=(0,se.hf)(P.size,f,n,r),it.animatedSymbolProperties=(0,se.hf)(P.animatedSymbolProperties,f,n,r);break;case"line":it.dashTemplate=P.dashTemplate;break;case"text":it.text=(0,se.hf)(P.text,f,n,r),it.fontName=(0,se.hf)(P.fontName,f,n,r)}const gt=i.getMosaicItem(it,l).then(Dt=>(c||(this._ongoingMaterialRequestMap.delete(E),M.set(E,Dt)),Dt)).catch(Dt=>(this._ongoingMaterialRequestMap.delete(E),pe.error(".analyze()",Dt.message),null));return c||this._ongoingMaterialRequestMap.set(E,gt),gt}}var Kt=u(84450);class he extends(ye(re)){constructor(i,s,n){var S;if(super(i),this._minMaxZoom=(0,v.UJ)(Math.round(s*O.MI),Math.round(n*O.MI)),(0,I.mf)(i.color))this._dynamicPropertyMap.set("fillColor",(D,P,W)=>{const F=i.color(D,P,W);return F&&(0,ot.t2)(F)||0});else{const E=i.color;this.fillColor=E&&(0,ot.t2)(E)||0}const r="CIMMarkerPlacementInsidePolygon"===(null==(S=i.cim.placement)?void 0:S.type)&&i.cim.placement.shiftOddRows?2:1,l=i.height;(0,I.mf)(l)?this._dynamicPropertyMap.set("_height",(D,P,W)=>l(D,P,W)*r):this._height=(l||0)*r;const c=i.offsetX;(0,I.mf)(c)?this._dynamicPropertyMap.set("_offsetX",(D,P,W)=>(0,V.F2)(c(D,P,W))):this._offsetX=(0,V.F2)(c||0);const f=i.offsetY;(0,I.mf)(f)?this._dynamicPropertyMap.set("_offsetY",(D,P,W)=>(0,V.F2)(-f(D,P,W))):this._offsetY=(0,V.F2)(-f||0);const d=i.scaleX;(0,I.mf)(d)?this._dynamicPropertyMap.set("_scaleX",d):this._scaleX=d||1;const M=i.angle;if((0,I.mf)(M)?this._dynamicPropertyMap.set("_angle",(D,P,W)=>(0,It.Or)(M(D,P,W))):this._angle=(0,It.Or)(M)||0,(0,X.pC)(i.effects)){const E=i.effects;(0,I.mf)(E)?this._dynamicPropertyMap.set("_effects",E):this._effects=E}this._cimFillLayer=i,this._bitset=(i.colorLocked?O.Uh:0)|(i.applyRandomOffset?O.jk:0)|(i.sampleAlphaOnly?O.Iv:0),this._fillMaterialKey=j.dk.load(i.materialKey)}static fromCIMFill(i,s){const[n,r]=(0,I._f)(i.scaleInfo,s);return new he(i,n,r)}bindFeature(i,s,n){const r=i.readLegacyFeature();this._dynamicPropertyMap.forEach((S,E)=>{this[E]=S(r,s,n)});const l=this._fillMaterialKey,c=this._materialCache,f=(0,this._cimFillLayer.materialHash)(r,s,n),d=c.get(f);let M=null;if(d&&(0,Kt.ok)(d.spriteMosaicItem)&&(M=d.spriteMosaicItem),M){const{rect:S,width:E,height:D}=M,P=S.x+O.fL,W=S.y+O.fL,F=P+E,nt=W+D;let it=Math.round((0,V.F2)(this._height));it<=0&&(it=nt-W);let gt=Math.round((0,V.F2)(this._height/D*E||0));gt<=0&&(gt=F-P);const Dt=this._scaleX,Bt=1;this.tl=(0,v.UJ)(P,W),this.br=(0,v.UJ)(F,nt),this.aux2_1=(0,v.UJ)(gt,it),this.aux2_2=(0,v.UJ)(this._offsetX,this._offsetY),this.aux3=(0,v.Jz)(Dt,Bt,this._angle,0),l.sdf=M.sdf,l.pattern=!0,l.textureBinding=M.textureBinding}else this.tl=0,this.br=0,this.aux2_1=0,this.aux2_2=0,this.aux3=0,l.sdf=!1,l.pattern=!1,l.textureBinding=0;this._materialKey=l.data}}class ce extends(Yt(re)){constructor(i,s,n){super(i),this._minMaxZoom=(0,v.UJ)(Math.round(s*O.MI),Math.round(n*O.MI)),this._cimLineLayer=i;let r=0;(0,I.mf)(i.width)||(r=.5*(0,V.F2)(i.width)),this._dynamicPropertyMap.set("_halfWidth",(E,D,P)=>(0,I.mf)(i.width)?.5*(0,V.F2)(i.width(E,D,P)):r),(0,I.mf)(i.cap)?this._dynamicPropertyMap.set("_capType",i.cap):this._capType=i.cap,(0,I.mf)(i.join)?this._dynamicPropertyMap.set("_joinType",i.join):this._joinType=i.join;const c=i.color;(0,I.mf)(c)?this._dynamicPropertyMap.set("_fillColor",(D,P,W)=>(0,ot.t2)(c(D,P,W))):this._fillColor=c&&(0,ot.t2)(c)||0;const f=i.miterLimit;if((0,I.mf)(f)?this._dynamicPropertyMap.set("_miterLimitCosine",(D,P,W)=>(0,I.NW)(f(D,P,W))):this._miterLimitCosine=(0,I.NW)(f),(0,X.pC)(i.effects)){const E=i.effects;(0,I.mf)(E)?this._dynamicPropertyMap.set("_effects",E):this._effects=E}this._scaleFactor=i.scaleFactor||1,this._isDashed=null!=i.dashTemplate,this.tessellationProperties._bitset=(i.colorLocked?O.Uh:0)|(i.scaleDash?O._6:0)|(i.sampleAlphaOnly?O.Iv:0),this._materialKey=i.materialKey,this._initializeTessellator(!0)}static fromCIMLine(i,s){const[n,r]=(0,I._f)(i.scaleInfo,s);return new ce(i,n,r)}bindFeature(i,s,n){const r=i.readLegacyFeature();this._dynamicPropertyMap.forEach((S,E)=>{this[E]=S(r,s,n)}),this._halfWidth*=this._scaleFactor;const l=this._materialCache,c=(0,this._cimLineLayer.materialHash)(r,s,n),f=l.get(c);let d=null;if(f&&(0,Kt.ok)(f.spriteMosaicItem)&&(d=f.spriteMosaicItem),d){this._hasPattern=!0;const{rect:S,width:E,height:D}=d,P=S.x+O.fL,W=S.y+O.fL,F=P+E,nt=W+D;this.tessellationProperties._tl=(0,v.UJ)(P,W),this.tessellationProperties._br=(0,v.UJ)(F,nt)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor,this.tessellationProperties._halfWidth=this._halfWidth,this.tessellationProperties.offset=0,this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;const M=j.a.load(this._materialKey);d&&(M.sdf=d.sdf,M.pattern=!0,M.textureBinding=d.textureBinding),this._materialKey=M.data}}var Oe=u(12225),Ae=u(9545),Be=u(88337);const Re=(0,Ae.c)(),Fe=(0,Oe.c)(),Ue=ut.Z.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate");class ue extends((0,Be.Z)(re)){constructor(i,s,n){super(i),this._cimMarkerLayer=i,this._minMaxZoom=(0,v.UJ)(Math.round(s*O.MI),Math.round(n*O.MI));const r=i.color;(0,I.mf)(r)?this._dynamicPropertyMap.set("_fillColor",(P,W,F)=>(0,ot.t2)(r(P,W,F))):this._fillColor=(0,ot.t2)(r);const l=i.outlineColor;(0,I.mf)(l)?this._dynamicPropertyMap.set("_outlineColor",(P,W,F)=>(0,ot.t2)(l(P,W,F))):this._outlineColor=(0,ot.t2)(l);const c=i.size;(0,I.mf)(c)?this._dynamicPropertyMap.set("_size",(P,W,F)=>(0,V.F2)(c(P,W,F))):this._size=(0,V.F2)(c)||0;const f=i.scaleX;(0,I.mf)(f)?this._dynamicPropertyMap.set("_scaleX",f):this._scaleX=f||1;const d=i.offsetX;(0,I.mf)(d)?this._dynamicPropertyMap.set("xOffset",(P,W,F)=>(0,V.F2)(d(P,W,F))):this.xOffset=(0,V.F2)(d)||0;const M=i.offsetY;(0,I.mf)(M)?this._dynamicPropertyMap.set("yOffset",(P,W,F)=>(0,V.F2)(M(P,W,F))):this.yOffset=(0,V.F2)(M)||0;const S=i.outlineWidth;(0,I.mf)(S)?this._dynamicPropertyMap.set("_outlineWidth",(P,W,F)=>(0,V.F2)(S(P,W,F))):this._outlineWidth=(0,V.F2)(S)||0;const E=i.rotation;if((0,I.mf)(E)?this._dynamicPropertyMap.set("_angle",E):this._angle=E||0,(0,X.pC)(i.effects)){const D=i.effects;(0,I.mf)(D)?this._dynamicPropertyMap.set("_effects",D):this._effects=D}if((0,X.pC)(i.markerPlacement)){const D=i.markerPlacement;(0,I.mf)(D)?this._dynamicPropertyMap.set("_markerPlacement",D):this._markerPlacement=D}this._scaleFactor=(0,X.Pt)(i.scaleFactor,1),this._bitSet=(i.alignment===At.v2.MAP?1:0)|(i.colorLocked?1:0)<<1|(i.scaleSymbolsProportionally?1:0)<<3,this._materialKey=i.materialKey}static fromCIMMarker(i,s){const[n,r]=(0,I._f)(i.scaleInfo,s);return new ue(i,n,r)}bindFeature(i,s,n){const r=i.readLegacyFeature(),l=i.getObjectId();this._dynamicPropertyMap.forEach((Ye,Qe)=>{this[Qe]=Ye(r,s,n)});const c=this._cimMarkerLayer.materialHash,f="function"==typeof c?c(r,s,n,l):c,d=this._materialCache.get(f);if(!d||!(0,Kt.ok)(d.spriteMosaicItem)||!d.spriteMosaicItem)return void Ue.error(new at.Z("mapview-cim","Encountered an error when binding feature"));const M=d.spriteMosaicItem,S=this._cimMarkerLayer.sizeRatio,E=M.width/M.height*this._scaleX,D=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle;let P=this._size,W=P*E;const F=this.xOffset,nt=this.yOffset;this.xOffset*=this._scaleFactor,this.yOffset*=this._scaleFactor;const it=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/(0,V.F2)(this._cimMarkerLayer.frameHeight):1,gt=this._outlineWidth*it,Dt=(0,V.F2)(this._cimMarkerLayer.referenceSize);let Bt=0,Zt=0;const jt=this._cimMarkerLayer.anchorPoint;jt&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(Bt=-jt.x/(this._size*E),Zt=jt.y/this._size):(Bt=jt.x,Zt=jt.y)),this._sizeOutlineWidth=(0,v.Jz)(Math.round(Math.min(Math.sqrt(128*W),255)),Math.round(Math.min(Math.sqrt(128*P),255)),Math.round(Math.min(Math.sqrt(128*gt),255)),Math.round(Math.min(Math.sqrt(128*Dt),255))),this.angle=D;const ee=Math.round(64*S);this._bitestAndDistRatio=(0,v.UJ)(this._bitSet,ee);const Qt=M.rect.x+O.fL,$t=M.rect.y+O.fL,We=Qt+M.width,Te=$t+M.height;this._texUpperLeft=(0,v.UJ)(Qt,$t),this._texUpperRight=(0,v.UJ)(We,$t),this._texBottomLeft=(0,v.UJ)(Qt,Te),this._texBottomRight=(0,v.UJ)(We,Te);const ae=j.mE.load(this._materialKey);ae.sdf=M.sdf,ae.pattern=!0,ae.textureBinding=M.textureBinding,this._materialKey=ae.data,this._anchorX=.5-(.5+Bt)*M.width/M.width,this._anchorY=.5-(.5+Zt)*M.height/M.height,W*=S,P*=S,W*=this._scaleFactor,P*=this._scaleFactor,W*=M.rect.width/M.width,P*=M.rect.height/M.height,this._computedWidth=W,this._computedHeight=P,this._applyTransformation(Fe,Re),this.xOffset=F,this.yOffset=nt}}var xe=u(61261),Ze=u(44526),ge=u(32954);class fe extends((0,Ze.Z)(re)){constructor(i,s,n){super(i),this._horizontalAlignment="center",this._verticalAlignment="middle",this._textToGlyphs=new Map,this._minMaxZoom=(0,v.UJ)(Math.round(s*O.MI),Math.round(n*O.MI));const r=i.scaleFactor||1;this._cimTextLayer=i;const l=i.color;(0,I.mf)(l)?this._dynamicPropertyMap.set("_color",(nt,it,gt)=>(0,ot.t2)(l(nt,it,gt))):this._color=(0,ot.t2)(l);const c=i.outlineColor;let f,M,E;if((0,I.mf)(c)?this._dynamicPropertyMap.set("_haloColor",(nt,it,gt)=>(0,ot.t2)(c(nt,it,gt))):this._haloColor=(0,ot.t2)(c),(0,I.mf)(i.size)||(f=Math.min(Math.round((0,V.F2)(i.size*i.sizeRatio)),127)),this._dynamicPropertyMap.set("_size",(F,nt,it)=>(0,I.mf)(i.size)?Math.min(Math.round((0,V.F2)(i.size(F,nt,it)*i.sizeRatio)),127):f),(0,I.mf)(i.outlineSize)?this._dynamicPropertyMap.set("_haloSize",(nt,it,gt)=>Math.min(Math.floor(5*(0,V.F2)(i.outlineSize(nt,it,gt)*i.sizeRatio)),127)):this._haloSize=Math.min(Math.floor(5*(0,V.F2)(i.outlineSize*i.sizeRatio)),127),(0,I.mf)(i.offsetX)||(M=Math.round((0,V.F2)(i.offsetX*i.sizeRatio))),this._dynamicPropertyMap.set("_xOffset",(F,nt,it)=>(0,I.mf)(i.offsetX)?Math.round((0,V.F2)(i.offsetX(F,nt,it)*i.sizeRatio)):M),(0,I.mf)(i.offsetY)||(E=Math.round((0,V.F2)(i.offsetY*i.sizeRatio))),this._dynamicPropertyMap.set("_yOffset",(F,nt,it)=>(0,I.mf)(i.offsetY)?Math.round((0,V.F2)(i.offsetY(F,nt,it)*i.sizeRatio)):E),(0,I.mf)(i.angle)?this._dynamicPropertyMap.set("_angle",i.angle):this._angle=i.angle,(0,I.mf)(i.horizontalAlignment)?this._dynamicPropertyMap.set("_horizontalAlignment",i.horizontalAlignment):this._horizontalAlignment=i.horizontalAlignment,(0,I.mf)(i.verticalAlignment)?this._dynamicPropertyMap.set("_verticalAlignment",i.verticalAlignment):this._verticalAlignment=i.verticalAlignment,(0,X.pC)(i.effects)){const F=i.effects;(0,I.mf)(F)?this._dynamicPropertyMap.set("_effects",F):this._effects=F}if((0,X.pC)(i.markerPlacement)){const F=i.markerPlacement;(0,I.mf)(F)?this._dynamicPropertyMap.set("_markerPlacement",F):this._textPlacement=F}(0,I.mf)(i.text)?this._dynamicPropertyMap.set("_text",i.text):this._text=i.text,this._scaleFactor=r;const P=Math.min(Math.round((0,V.F2)(i.referenceSize*i.sizeRatio)),127);this._referenceSize=Math.round(Math.sqrt(256*P)),this._materialKey=i.materialKey;const W=j.qr.load(this._materialKey);W.sdf=!0,this._bitset=(i.alignment===At.v2.MAP?1:0)|(i.colorLocked?1:0)<<1,this._materialKey=W.data,this._decoration="none",this._lineHeight=1,this._lineWidth=512,this._isCIM=!0}static fromCIMText(i,s){const[n,r]=(0,I._f)(i.scaleInfo,s);return new fe(i,n,r)}analyze(i,s,n,r){var l=()=>super.analyze,c=this;return(0,$.Z)(function*(){const f=s.readLegacyFeature(),d=function Ke(a,i,s,n){return"string"==typeof a.text?a.text:"function"==typeof a.text?a.text(i,s,n):""}(c._cimTextLayer,f,n,r),M=yield l().call(c,i,s,n,r,(0,ge._)(d));return M&&M.glyphMosaicItems&&c._textToGlyphs.set(d,M.glyphMosaicItems),M})()}bindFeature(i,s,n){const r=i.readLegacyFeature();if(this._dynamicPropertyMap.forEach((c,f)=>{this[f]=c(r,s,n)}),!this._text||0===this._text.length)return void(this._shapingInfo=null);this._size*=this._scaleFactor,this._scale=this._size/O.Ex,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=(0,xe.kH)((0,X.Pt)(this._horizontalAlignment,"center")),this._yAlignD=(0,xe.b7)((0,X.Pt)(this._verticalAlignment,"baseline"));const l=this._textToGlyphs.get(this._text);this.bindTextInfo(l,!1)}}class Xt extends(ye(le.Z)){constructor(i,s,n,r,l,c,f,d,M,S,E,D,P,W,F,nt){super(),this._effects=W;const it=j.dk.load(i);s&&(it.sdf=s.sdf,it.pattern=!0,it.textureBinding=s.textureBinding),this.fillColor=n,this.tl=r,this.br=l,this.aux2_1=(0,v.UJ)(c,f),this.aux2_2=(0,v.UJ)(d,M),this.aux3=(0,v.Jz)(S,E,D,0),this._bitset=P,this._minMaxZoom=(0,v.UJ)(Math.round(F*O.MI),Math.round(nt*O.MI)),this._materialKey=it.data}static fromCIMFill(i,s,n){const r=i.color,l=r&&(0,ot.t2)(r)||0,c=i.materialKey,[f,d]=(0,I._f)(i.scaleInfo,n),M=(i.colorLocked?O.Uh:0)|(i.applyRandomOffset?O.jk:0)|(i.sampleAlphaOnly?O.Iv:0);if(!s)return new Xt(c,null,l,0,0,0,0,0,0,0,0,0,M,i.effects,f,d);const{rect:S,width:E,height:D}=s,W=S.x+O.fL,F=S.y+O.fL,nt=W+E,it=F+D,gt=i.height,Dt=(i.scaleX||1)*gt;let Bt=Math.round(gt);Bt<=0&&(Bt=it-F);let Zt=Math.round(Dt);Zt<=0&&(Zt=nt-W);const jt=(0,V.F2)(i.offsetX||0),ee=(0,V.F2)(-i.offsetY||0),Qt=(0,v.UJ)(W,F),$t=(0,v.UJ)(nt,it);return new Xt(c,s,l,Qt,$t,Zt,Bt,jt,ee,128,128,(0,It.s5)(i.angle),M,i.effects,f,d)}static fromSimpleFill(i,s,n=!1){const{color:r}=i,l=r&&"esriSFSNull"!==i.style&&(0,ot.aH)(r)||0,c=n?O.Uh:0,f=i.materialKey;let d;if(s){const{rect:M,width:S,height:E}=s,D=M.x+O.fL,P=M.y+O.fL,W=D+S,F=P+E,nt=(0,v.UJ)(D,P),it=(0,v.UJ)(W,F);d=new Xt(f,s,l,nt,it,S,E,0,0,128,128,0,c,null,I.Xe,I.eW)}else d=new Xt(f,null,l,0,0,0,0,0,0,0,0,0,c,null,I.Xe,I.eW);return d._maybeAddLineTemplate(i),d}static fromPictureFill(i,s,n=!1){const r=O.ru,{rect:l,width:c,height:f}=s,d=l.x+O.fL,M=l.y+O.fL,S=d+c,E=M+f,D=(0,v.UJ)(d,M),P=(0,v.UJ)(S,E),W=Math.round((0,V.F2)(i.width)),F=Math.round((0,V.F2)(i.height)),nt=(0,V.F2)(i.xoffset),it=(0,V.F2)(-i.yoffset),Bt=new Xt(i.materialKey,s,r,D,P,W,F,nt,it,128*i.xscale,128*i.yscale,0,n?O.Uh:0,null,I.Xe,I.eW);return Bt._maybeAddLineTemplate(i),Bt}}var ne=u(18752),ve=u(51919);class Ge{constructor(){this._resolver=null}isHeld(){return!!this._resolver}acquire(){var i=this;return(0,$.Z)(function*(){i._resolver?(yield i._resolver.promise,yield i.acquire()):i._resolver=(0,U.hh)()})()}release(){const i=this._resolver;this._resolver=null,i.resolve()}}function _e(){return(_e=(0,$.Z)(function*(a,i,s){try{yield a.acquire(),yield i(s),a.release()}catch(n){throw a.release(),n}})).apply(this,arguments)}var oe=u(11263);const Ut=ut.Z.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),Le=new Array,de={isOutline:!1,placement:null,symbologyType:Q.mD.DEFAULT,vvFlags:0},je=ie(te({},Z.eG),{hash:JSON.stringify(Z.eG),materialKey:(0,j.jj)(Q.LW.MARKER,de)}),Je=ie(te({},Z.wW),{hash:JSON.stringify(Z.wW),materialKey:(0,j.jj)(Q.LW.LINE,de)}),ke=ie(te({},Z.lj),{hash:JSON.stringify(Z.lj),materialKey:(0,j.jj)(Q.LW.FILL,de)});function Nt(a,i){const s=a.length;return a.push(null),i.then(n=>a[s]=n),a}function Pe(a){return!!(1&a)}class Ne{constructor(i,s){this._idCounter=1,this._templateIdCounter=1,this._idToTemplateGroup=new Map,this._symbolToTemplate=new Map,this._fetchQueue=[],this._idToResolver=new Map,this._cimTemplateCache=new Map,this._cimAnalyses=[],this._lock=new Ge,this._fetchResource=i,this._tileInfo=s}get _markerError(){return this._errorTemplates.marker[0]}get _fillError(){return this._errorTemplates.fill[0]}get _lineError(){return this._errorTemplates.line[0]}get _textError(){return this._errorTemplates.line[0]}createTemplateGroup(i,s){this._initErrorTemplates();const n=i.hash;if(this._symbolToTemplate.has(n))return this._symbolToTemplate.get(n);const r=new Array;s&&this._createMeshTemplates(r,s,!0),this._createMeshTemplates(r,i,!1);const l=this._createGroupId("expanded-cim"===i.type&&He(i));return this._idToTemplateGroup.set(l,r),this._symbolToTemplate.set(n,l),l}getTemplateGroup(i){return this._idToTemplateGroup.has(i)?this._idToTemplateGroup.get(i):Le}getDynamicTemplateGroup(i){return this._idToTemplateGroup.has(i)?(Pe(i)||Ut.error("mapview-template-store",`Id ${i} does not refer to a dynamic template`),this._idToTemplateGroup.get(i)):Le}getMosaicItem(i,s){const n=this._createTemplateId(),r=new Promise(l=>this._idToResolver.set(n,l));return this._fetchQueue.push({symbol:i,id:n,glyphIds:s}),r}finalize(i){return this._fetchQueue.length||this._lock.isHeld()?function Ve(a,i,s){return _e.apply(this,arguments)}(this._lock,this._fetchAllQueuedResources.bind(this),i):Promise.resolve()}_initErrorTemplates(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],ke,!1),marker:this._createMeshTemplates([],je,!1),line:this._createMeshTemplates([],Je,!1)})}_fetchAllQueuedResources(i){if(!this._fetchQueue.length)return Promise.resolve();const s=this._fetchQueue,n=this._cimAnalyses;return this._fetchQueue=[],this._cimAnalyses=[],Promise.all(n).then(()=>this._fetchResource(s,i).then(r=>{for(const{id:l,mosaicItem:c}of r)this._idToResolver.get(l)(c),this._idToResolver.delete(l)})).catch(r=>{(0,U.D_)(r)?this._fetchQueue=this._fetchQueue.concat(s):function Xe(a){return"worker:port-closed"===a.name}(r)||Ut.error(new at.Z("mapview-template-store","Unable to fetch requested texture resources",r))})}_createGroupId(i){return this._idCounter++<<1|(i?1:0)}_createTemplateId(){return this._templateIdCounter++}_createSMS(i){var s=this;return(0,$.Z)(function*(){const{spriteMosaicItem:n}=yield s.getMosaicItem(i);return(0,Kt.ok)(n,Ut)?ne.Z.fromSimpleMarker(i,n):s._markerError})()}_createPMS(i){var s=this;return(0,$.Z)(function*(){const{spriteMosaicItem:n}=yield s.getMosaicItem(i);return(0,Kt.ok)(n,Ut)?ne.Z.fromPictureMarker(i,n):s._markerError})()}_createSFS(i,s){var n=this;return(0,$.Z)(function*(){const{spriteMosaicItem:r}=yield n.getMosaicItem(i);return(0,Kt.ok)(r,Ut)?Xt.fromSimpleFill(i,r,s):n._fillError})()}_createPFS(i,s){var n=this;return(0,$.Z)(function*(){const{spriteMosaicItem:r}=yield n.getMosaicItem(i);return(0,Kt.ok)(r,Ut)?Xt.fromPictureFill(i,r,s):n._fillError})()}_createSLS(i,s){var n=this;return(0,$.Z)(function*(){const{spriteMosaicItem:r}=yield n.getMosaicItem(i);return(0,Kt.ok)(r,Ut)?kt.fromSimpleLine(i,r):n._lineError})()}_createLMS(i){var s=this;return(0,$.Z)(function*(){const{spriteMosaicItem:n}=yield s.getMosaicItem(i);return(0,Kt.ok)(n,Ut)?ne.Z.fromLineSymbolMarker(i,n):s._markerError})()}_createTS(i){var s=this;return(0,$.Z)(function*(){const{glyphMosaicItems:n}=yield s.getMosaicItem(i);return ve.Z.fromText(i,n)})()}_createCIMText(i){var s=this;return(0,$.Z)(function*(){const{glyphMosaicItems:n}=yield s.getMosaicItem((0,oe.xS)(i),(0,ge._)(i.text));return(0,Kt.ok)(n,Ut)?ve.Z.fromCIMText(i,n,s._tileInfo):s._textError})()}_createCIMFill(i){var s=this;return(0,$.Z)(function*(){const{spriteMosaicItem:n}=yield s.getMosaicItem((0,oe.xS)(i));return(0,Kt.ok)(n,Ut)?Xt.fromCIMFill(i,n,s._tileInfo):s._fillError})()}_createCIMLine(i){var s=this;return(0,$.Z)(function*(){const{spriteMosaicItem:n}=yield s.getMosaicItem((0,oe.xS)(i));return(0,Kt.ok)(n,Ut)?kt.fromCIMLine(i,n,s._tileInfo):s._lineError})()}_createCIMMarker(i){var s=this;return(0,$.Z)(function*(){const{spriteMosaicItem:n}=yield s.getMosaicItem((0,oe.xS)(i));return(0,Kt.ok)(n,Ut)?ne.Z.fromCIMMarker(i,n,s._tileInfo):s._markerError})()}_createCIM(i){var s=this;return(0,$.Z)(function*(){const n=i.templateHash;if(s._cimTemplateCache.has(n))return s._cimTemplateCache.get(n);let r;switch(i.type){case"marker":r=yield s._createCIMMarker(i);break;case"line":r=yield s._createCIMLine(i);break;case"fill":r=yield s._createCIMFill(i);break;case"text":r=yield s._createCIMText(i)}return s._cimTemplateCache.set(n,r),r})()}_createDynamicCIM(i){var s=this;return(0,$.Z)(function*(){const n=i.templateHash;if(s._cimTemplateCache.has(n))return s._cimTemplateCache.get(n);let r;switch(i.type){case"marker":r=ue.fromCIMMarker(i,s._tileInfo);break;case"line":r=ce.fromCIMLine(i,s._tileInfo);break;case"fill":r=he.fromCIMFill(i,s._tileInfo);break;case"text":r=fe.fromCIMText(i,s._tileInfo)}return s._cimTemplateCache.set(n,r),r})()}_createPrimitiveMeshTemplates(i,s,n){switch(s.type){case"esriSMS":return Nt(i,this._createSMS(s));case"esriPMS":return Nt(i,this._createPMS(s));case"esriSFS":return Nt(i,this._createSFS(s,n));case"line-marker":return Nt(i,this._createLMS(s));case"esriPFS":return Nt(i,this._createPFS(s,n));case"esriSLS":return Nt(i,this._createSLS(s,!1));case"esriTS":return Nt(i,this._createTS(s));default:return Ut.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),i}}_createMeshTemplates(i,s,n){if(s.type.includes("3d"))return Ut.error("3D symbols are not supported with MapView"),i;if("expanded-cim"===s.type){for(const r of s.layers)Nt(i,"function"==typeof r.materialHash?this._createDynamicCIM(r):this._createCIM(r));return i}if("composite-symbol"===s.type){for(const r of s.layers)this._createPrimitiveMeshTemplates(i,r,n);return i}return"cim"===s.type||"label"===s.type||"web-style"===s.type?i:this._createPrimitiveMeshTemplates(i,s,n)}}const He=a=>{if(!a.layers)return!1;for(const i of a.layers)if("function"==typeof i.materialHash)return!0;return!1}},51919:(Et,_t,u)=>{u.d(_t,{Z:()=>v});var $=u(986),at=u(23841),ut=u(7547),U=u(61261),Z=u(81295),Q=u(39351),j=u(5254),X=u(18716),V=u(50114),ot=u(44526),O=u(94358);class v extends((0,ot.Z)(O.Z)){constructor(L,x,_,T,N,K,A,m,g,C,G,st,R,lt,ct,dt,xt,b,q=!1,rt,tt){super(),this._xOffset=(0,at.F2)(R),this._yOffset=(0,at.F2)(lt),this._decoration=C||"none",this._color=N,this._haloColor=K,this._haloSize=Math.min(Math.floor(5*(0,at.F2)((0,at.t_)(_))),127),this._size=Math.min(Math.round((0,at.F2)(x)),127);const H=Math.min(Math.round((0,at.F2)(T||x)),127);this._referenceSize=Math.round(Math.sqrt(256*H)),this._scale=this._size/Q.Ex,this._angle=st,this._justify=(0,U.Hd)(A||"center"),this._xAlignD=(0,U.kH)(A||"center"),this._yAlignD=(0,U.b7)(m||"baseline"),this._baseline="baseline"===(m||"baseline"),this._bitset=(g===ut.v2.MAP?1:0)|(G?1:0)<<1;const mt=X.m2.load(L);mt.sdf=!0,this._materialKey=mt.data,this._lineWidth=(0,at.F2)(ct)||512,this._lineHeight=dt||1,this._textPlacement=xt,this._effects=b,this._isCIM=q,this._minMaxZoom=(0,j.UJ)(Math.round(rt*Q.MI),Math.round(tt*Q.MI))}static fromText(L,x){const _=new v(L.materialKey,L.font.size,L.haloSize||0,L.font.size,L.color&&(0,Z.aH)(L.color)||0,L.haloColor&&(0,Z.aH)(L.haloColor)||0,L.horizontalAlignment,L.verticalAlignment,ut.v2.SCREEN,L.font.decoration,!1,L.angle||0,L.xoffset,L.yoffset,L.lineWidth,L.lineHeight,null,null,!1,V.Xe,V.eW),[,T]=(0,$.E)(L.text);return _.bindTextInfo(x,T),_._vertexBoundsScale=L.maxVVSize?L.maxVVSize/L.font.size:1,_}static fromCIMText(L,x,_){const T=L.scaleFactor||1,N=L.size*L.sizeRatio*T,[K,A]=(0,V._f)(L.scaleInfo,_),m=new v(L.materialKey,N,L.outlineSize*L.sizeRatio,L.referenceSize,(0,Z.t2)(L.color),(0,Z.t2)(L.outlineColor),L.horizontalAlignment,L.verticalAlignment,L.alignment,L.decoration,L.colorLocked,L.angle,L.offsetX*L.sizeRatio*T,L.offsetY*L.sizeRatio*T,512,1,L.markerPlacement,L.effects,!0,K,A),[,g]=(0,$.E)(L.text);return m.bindTextInfo(x,g),m._vertexBoundsScale=L.maxVVSize?L.maxVVSize/N:1,m}}},50114:(Et,_t,u)=>{u.d(_t,{Fv:()=>Z,NW:()=>X,TK:()=>Q,Xe:()=>$,_f:()=>I,eW:()=>at,lu:()=>ut,mf:()=>j});const $=0,at=100;function ut(L,x,_){return L[0]=x[0]-_[0],L[1]=x[1]-_[1],L}function U(L,x){return Math.sqrt(L*L+x*x)}function Z(L){const x=U(L[0],L[1]);L[0]/=x,L[1]/=x}function Q(L,x){return U(L[0]-x[0],L[1]-x[1])}function j(L){return"function"==typeof L}function X(L=2){return 1/Math.max(L,1)}function I(L,x){return[!!L.minScale&&x.scaleToZoom(L.minScale)||$,!!L.maxScale&&x.scaleToZoom(L.maxScale)||at]}},32940:(Et,_t,u)=>{u.d(_t,{fL:()=>V});var $=u(15861),at=u(26584),ut=u(63290),U=u(93961),Z=u(46679),Q=u(39236),j=u(11263);const X=ut.Z.getLogger("esri/views/2d/engine/webgl/util/Matcher");function V(A,m,g,C){return ot.apply(this,arguments)}function ot(){return(ot=(0,$.Z)(function*(A,m,g,C){switch(A.type){case"simple":case"heatmap":return O.fromBasicRenderer(A,m,g,C);case"map":return I.fromUVRenderer(A,m,g,C);case"interval":return v.fromCBRenderer(A,m,g,C);case"dictionary":return K.fromDictionaryRenderer(A,m,g,C);case"pie-chart":return It.fromPieChartRenderer(A,m,g,C);case"subtype":return It.fromSubtypes(A,m,g,C)}})).apply(this,arguments)}class O{constructor(){this.type="feature",this._defaultResult=null}static fromBasicRenderer(m,g,C,G){return(0,$.Z)(function*(){const st=new O;if(m.symbol){const R=yield(0,j.B3)(m.symbol,C,G),lt=g.createTemplateGroup(R,null);st.setDefault(lt)}return st})()}static fromPieChartRenderer(m,g,C,G){return(0,$.Z)(function*(){const st=new O;if(m.markerSymbol){const R=yield(0,j.B3)(m.markerSymbol,C,G);let lt;m.fillSymbol&&(lt=yield(0,j.B3)(m.fillSymbol,C,G));const ct=g.createTemplateGroup(R,lt);st.setDefault(ct)}return st})()}size(){return 1}getDefault(){return this._defaultResult}setDefault(m){this._defaultResult=m}match(m,g,C,G,st){return this.getDefault()}analyze(m,g,C,G,st,R){return(0,$.Z)(function*(){return null})()}}class It extends O{constructor(m,g){super(),this._subMatchers=m,this._subtypeField=g}static fromSubtypes(m,g,C,G){return(0,$.Z)(function*(){const st=new Map,R=[];for(const lt in m.renderers){const ct=parseInt(lt,10),dt=V(m.renderers[lt],g,C,G).then(xt=>st.set(ct,xt));R.push(dt)}return yield Promise.all(R),new It(st,m.subtypeField)})()}match(m,g,C,G,st){const R=g.readAttribute(this._subtypeField),lt=this._subMatchers.get(R);return lt?lt.match(m,g,C,G,st):null}}class v extends O{constructor(m,g,C,G){super(),this.type="interval",this._intervals=[],this._isMaxInclusive=g,this._fieldIndex=G,this._field=m,this._normalizationInfo=C}static fromCBRenderer(m,g,C,G){return(0,$.Z)(function*(){const{isMaxInclusive:st,normalizationField:R,normalizationTotal:lt,normalizationType:ct}=m,xt=new v(m.field,st,{normalizationField:R,normalizationTotal:lt,normalizationType:ct},m.fieldIndex),b=yield(0,j.B3)(m.backgroundFillSymbol,C,G);yield Promise.all(m.intervals.map(function(){var rt=(0,$.Z)(function*(tt){const H=yield(0,j.B3)(tt.symbol,C,G),mt=yield g.createTemplateGroup(H,b);xt.add({min:tt.min,max:tt.max},mt)});return function(tt){return rt.apply(this,arguments)}}()));const q=yield(0,j.B3)(m.defaultSymbol,C,G);if(q){const rt=yield g.createTemplateGroup(q,b);xt.setDefault(rt)}return xt})()}add(m,g){this._intervals.push({interval:m,result:g}),this._intervals.sort((C,G)=>C.interval.min-G.interval.min)}size(){return super.size()+this._intervals.length}match(m,g,C,G,st){if(null==this._fieldIndex&&!this._field)return this.getDefault();const R=null!=this._fieldIndex?g.getComputedNumericAtIndex(this._fieldIndex):this._getValueFromField(g);if(!R&&(null==R||isNaN(R)))return this.getDefault();for(let lt=0;lt<this._intervals.length;lt++){const{interval:ct,result:dt}=this._intervals[lt],b=this._isMaxInclusive?R<=ct.max:R<ct.max;if(R>=ct.min&&b)return dt}return this.getDefault()}_needsNormalization(){const m=this._normalizationInfo;return m&&(m.normalizationField||m.normalizationTotal||m.normalizationType)}_getValueFromField(m){const g=m.readAttribute(this._field);if(!this._needsNormalization()||null==g)return g;const{normalizationField:C,normalizationTotal:G,normalizationType:st}=this._normalizationInfo,R=!!C&&m.readAttribute(C);if(st)switch(st){case"esriNormalizeByField":return R?g/R:void 0;case"esriNormalizeByLog":return Math.log(g)*Math.LOG10E;case"esriNormalizeByPercentOfTotal":return g/G*100;default:return void X.error(`Found unknown normalization type: ${st}`)}else X.error("Normalization is required, but no type was set!")}}class I extends O{constructor(m,g,C){super(),this.type="map",this._nullResult=null,this._resultsMap=new Map,this._fieldsIndex=C,this._fields=m,this._seperator=g||""}static fromUVRenderer(m,g,C,G){return(0,$.Z)(function*(){const st=m.fieldDelimiter,R=[m.field];m.field2&&R.push(m.field2),m.field3&&R.push(m.field3);const lt=yield(0,j.B3)(m.backgroundFillSymbol,C,G),ct=new I(R,st,m.fieldIndex);yield Promise.all(m.map.map(function(){var xt=(0,$.Z)(function*(b){const q=yield(0,j.B3)(b.symbol,C,G),rt=yield g.createTemplateGroup(q,lt);"<Null>"===b.value?ct.setNullResult(rt):ct.add(b.value,rt)});return function(b){return xt.apply(this,arguments)}}()));const dt=yield(0,j.B3)(m.defaultSymbol,C,G);if(dt){const xt=yield g.createTemplateGroup(dt,lt);ct.setDefault(xt)}return ct})()}setNullResult(m){this._nullResult=m}add(m,g){this._resultsMap.set(m.toString(),g)}size(){return super.size()+this._resultsMap.size}match(m,g,C,G,st){if(null==this._fieldsIndex&&!this._fields)return this.getDefault();const R=null!=this._fieldsIndex?g.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(g);if(null!==this._nullResult&&(null==R||""===R||"<Null>"===R))return this._nullResult;if(!R&&null==R)return this.getDefault();const lt=R.toString();return this._resultsMap.has(lt)?this._resultsMap.get(lt):this.getDefault()}_getValueFromFields(m){const g=[];for(const C of this._fields){const G=m.readAttribute(C);g.push(null==G||""===G?"<Null>":G)}return g.join(this._seperator)}}function x(){return(x=(0,$.Z)(function*(A,m){const g=A||1;if("number"==typeof g)return(G,st,R)=>g;const C=yield(0,Z.Yi)(g,m.spatialReference,m.fields);return(G,st,R)=>(0,Q.Z)(C,G,{$view:R},m.geometryType,st)||1})).apply(this,arguments)}let _;function T(){return N.apply(this,arguments)}function N(){return(N=(0,$.Z)(function*(){return _||(_=u.e(3250).then(u.bind(u,3250))),_})).apply(this,arguments)}class K extends O{constructor(m,g,C,G,st,R){super(),this.type="dictionary",this._groupIdCache=new U.Z(100),this._loader=m,this._fieldMap=m.fieldMap,this._symbolFields=m.getSymbolFields(),this._templates=g,this._info=C,this._scaleFn=G,this._schemaUtilsModule=st,this._symbolOptions=R}static fromDictionaryRenderer(m,g,C,G){return(0,$.Z)(function*(){const[{DictionaryLoader:st},R]=yield Promise.all([Promise.resolve().then(u.bind(u,29996)),T()]),lt=new st(m.url,m.config,m.fieldMap);yield lt.fetchResources({spatialReference:C.spatialReference,fields:C.fields});const ct=yield function L(A,m){return x.apply(this,arguments)}(m.scaleExpression,C);return new K(lt,g,C,ct,R,m.symbolOptions)})()}_analyzeFeature(m,g,C,G,st){var R=this;return(0,$.Z)(function*(){const lt=m.readLegacyFeature(),ct=R._scaleFn(lt,C,G),dt=R._attributeHash(lt)+"-"+ct,xt=R._groupIdCache.get(dt);if(xt)return xt;const b=ie(te({},G),{spatialReference:R._info.spatialReference,abortOptions:st,fields:R._info.fields}),q=yield R._loader.getSymbolAsync(lt,b),rt=R._schemaUtilsModule.createSymbolSchema(q,R._symbolOptions),tt=(0,j.B3)(rt,R._info,g,st).then(H=>{if("expanded-cim"!==H.type)return X.error(new at.Z("mapview-bad-type",`Found unexpected type ${H.type} in dictionary response`)),null;H.hash+="-"+ct;for(const mt of H.layers)mt.scaleFactor=ct,mt.templateHash+="-"+ct;return R._templates.createTemplateGroup(H,null)});return R._groupIdCache.put(dt,tt,1),tt})()}analyze(m,g,C,G,st,R){var lt=this;return(0,$.Z)(function*(){const ct=g.getCursor(),dt=[];for(;ct.next();)dt.push(lt._analyzeFeature(ct,C,G,st,R));return Promise.all(dt)})()}match(m,g,C,G,st){return null}_attributeHash(m){let g="";for(const C of this._symbolFields){const G=this._fieldMap[C];G&&(g+=m.attributes[G]+"-")}return g}}},84450:(Et,_t,u)=>{u.d(_t,{ok:()=>at});var $=u(26584);function at(ut,U){if(ut&&"name"in ut){const Z=ut;return U&&U.error(new $.Z(Z.name,Z.message,Z.details)),!1}return!0}},75734:(Et,_t,u)=>{u.d(_t,{Z:()=>at});class at{constructor(U,Z){this._pos=0;const Q=Z?this._roundToNearest(Z,U.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(Q),this._buffer=new U(this._array),this._ctor=U,this._i16View=new Int16Array(this._array)}get length(){return this._pos}_roundToNearest(U,Z){const Q=Math.round(U);return Q+(Z-Q%Z)}_ensureSize(U){if(this._pos+U>=this._buffer.length){const Z=this._roundToNearest(1.25*(this._array.byteLength+U*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT),Q=new ArrayBuffer(Z),j=new this._ctor(Q);j.set(this._buffer,0),this._array=Q,this._buffer=j,this._i16View=new Int16Array(this._array)}}ensureSize(U){this._ensureSize(U)}writeF32(U){this._ensureSize(1);const Z=this._pos;return new Float32Array(this._array,4*this._pos,1)[0]=U,this._pos++,Z}push(U){this._ensureSize(1);const Z=this._pos;return this._buffer[this._pos++]=U,Z}writeFixed(U){this._buffer[this._pos++]=U}setValue(U,Z){this._buffer[U]=Z}i1616Add(U,Z,Q){this._i16View[2*U]+=Z,this._i16View[2*U+1]+=Q}getValue(U){return this._buffer[U]}incr(U){if(this._buffer.length<U)throw new Error("Increment index overflows the target buffer");this._buffer[U]++}decr(U){this._buffer[U]--}writeRegion(U){this._ensureSize(U.length);const Z=this._pos;return this._buffer.set(U,this._pos),this._pos+=U.length,Z}writeManyFrom(U,Z,Q){this._ensureSize(Q-Z);for(let j=Z;j!==Q;j++)this.writeFixed(U._buffer[j])}buffer(){const U=this._array.slice(0,4*this._pos);return this.destroy(),U}toArray(){const U=this._array,Z=[];for(let Q=0;Q<U.byteLength/4;Q++)Z.push(U[Q]);return Z}seek(U){this._pos=U}destroy(){this._array=null,this._buffer=null}}},55376:(Et,_t,u)=>{function ut(U,Z,Q,j){const X=U.clone(),V=1<<X.level,ot=X.col+Z,O=X.row+Q;return j&&ot<0?(X.col=ot+V,X.world-=1):ot>=V?(X.col=ot-V,X.world+=1):X.col=ot,X.row=O,X}u.d(_t,{M:()=>ut}),u(81340)},32954:(Et,_t,u)=>{function $(at){const ut=new Array(at.length);for(let U=0;U<at.length;U++)ut[U]=at.charCodeAt(U);return ut}u.d(_t,{_:()=>$})}}]);