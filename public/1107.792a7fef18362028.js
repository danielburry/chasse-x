"use strict";var Be=Object.defineProperty,De=Object.defineProperties,_e=Object.getOwnPropertyDescriptors,Oe=Object.getOwnPropertySymbols,Ne=Object.prototype.hasOwnProperty,Ze=Object.prototype.propertyIsEnumerable,Fe=(D,R,A)=>R in D?Be(D,R,{enumerable:!0,configurable:!0,writable:!0,value:A}):D[R]=A,Ae=(D,R)=>{for(var A in R||(R={}))Ne.call(R,A)&&Fe(D,A,R[A]);if(Oe)for(var A of Oe(R))Ze.call(R,A)&&Fe(D,A,R[A]);return D},we=(D,R)=>De(D,_e(R));(self.webpackChunkchasse_pwa_front=self.webpackChunkchasse_pwa_front||[]).push([[1107],{550:(D,R,A)=>{function S(){return[1,0,0,0,1,0,0,0,1]}function F(E,L){return new Float64Array(E,L,9)}A.d(R,{a:()=>F,c:()=>S}),Object.freeze(Object.defineProperty({__proto__:null,create:S,clone:function h(E){return[E[0],E[1],E[2],E[3],E[4],E[5],E[6],E[7],E[8]]},fromValues:function O(E,L,z,j,x,q,J,Q,ee){return[E,L,z,j,x,q,J,Q,ee]},createView:F},Symbol.toStringTag,{value:"Module"}))},48977:(D,R,A)=>{A.d(R,{c:()=>oe,g:()=>j,j:()=>ae,k:()=>X,m:()=>x,s:()=>z});var S=A(550),h=A(78451),O=A(28093),F=A(39863),_=A(84161),E=A(993);function z(o,l,y){y*=.5;const f=Math.sin(y);return o[0]=f*l[0],o[1]=f*l[1],o[2]=f*l[2],o[3]=Math.cos(y),o}function j(o,l){const y=2*Math.acos(l[3]),f=Math.sin(y/2);return f>F.E?(o[0]=l[0]/f,o[1]=l[1]/f,o[2]=l[2]/f):(o[0]=1,o[1]=0,o[2]=0),y}function x(o,l,y){const f=l[0],g=l[1],p=l[2],C=l[3],v=y[0],T=y[1],P=y[2],N=y[3];return o[0]=f*N+C*v+g*P-p*T,o[1]=g*N+C*T+p*v-f*P,o[2]=p*N+C*P+f*T-g*v,o[3]=C*N-f*v-g*T-p*P,o}function te(o,l,y,f){const g=l[0],p=l[1],C=l[2],v=l[3];let T,P,N,K,Y,ne=y[0],ue=y[1],re=y[2],ce=y[3];return P=g*ne+p*ue+C*re+v*ce,P<0&&(P=-P,ne=-ne,ue=-ue,re=-re,ce=-ce),1-P>F.E?(T=Math.acos(P),N=Math.sin(T),K=Math.sin((1-f)*T)/N,Y=Math.sin(f*T)/N):(K=1-f,Y=f),o[0]=K*g+Y*ne,o[1]=K*p+Y*ue,o[2]=K*C+Y*re,o[3]=K*v+Y*ce,o}function oe(o,l){return o[0]=-l[0],o[1]=-l[1],o[2]=-l[2],o[3]=l[3],o}function U(o,l){const y=l[0]+l[4]+l[8];let f;if(y>0)f=Math.sqrt(y+1),o[3]=.5*f,f=.5/f,o[0]=(l[5]-l[7])*f,o[1]=(l[6]-l[2])*f,o[2]=(l[1]-l[3])*f;else{let g=0;l[4]>l[0]&&(g=1),l[8]>l[3*g+g]&&(g=2);const p=(g+1)%3,C=(g+2)%3;f=Math.sqrt(l[3*g+g]-l[3*p+p]-l[3*C+C]+1),o[g]=.5*f,f=.5/f,o[3]=(l[3*p+C]-l[3*C+p])*f,o[p]=(l[3*p+g]+l[3*g+p])*f,o[C]=(l[3*C+g]+l[3*g+C])*f}return o}function X(o,l,y,f){const g=.5*Math.PI/180;l*=g,y*=g,f*=g;const p=Math.sin(l),C=Math.cos(l),v=Math.sin(y),T=Math.cos(y),P=Math.sin(f),N=Math.cos(f);return o[0]=p*T*N-C*v*P,o[1]=C*v*N+p*T*P,o[2]=C*T*P-p*v*N,o[3]=C*T*N+p*v*P,o}const B=E.c,Ie=E.s,Ce=E.a,ie=x,se=E.b,W=E.d,ve=E.l,be=E.e,H=be,he=E.f,Me=he,G=E.n,ae=E.g,Ue=E.h,k=(0,O.c)(),fe=(0,O.f)(1,0,0),Ee=(0,O.f)(0,1,0),de=(0,h.a)(),ye=(0,h.a)(),Se=(0,S.c)();Object.freeze(Object.defineProperty({__proto__:null,identity:function L(o){return o[0]=0,o[1]=0,o[2]=0,o[3]=1,o},setAxisAngle:z,getAxisAngle:j,multiply:x,rotateX:function q(o,l,y){y*=.5;const f=l[0],g=l[1],p=l[2],C=l[3],v=Math.sin(y),T=Math.cos(y);return o[0]=f*T+C*v,o[1]=g*T+p*v,o[2]=p*T-g*v,o[3]=C*T-f*v,o},rotateY:function J(o,l,y){y*=.5;const f=l[0],g=l[1],p=l[2],C=l[3],v=Math.sin(y),T=Math.cos(y);return o[0]=f*T-p*v,o[1]=g*T+C*v,o[2]=p*T+f*v,o[3]=C*T-g*v,o},rotateZ:function Q(o,l,y){y*=.5;const f=l[0],g=l[1],p=l[2],C=l[3],v=Math.sin(y),T=Math.cos(y);return o[0]=f*T+g*v,o[1]=g*T-f*v,o[2]=p*T+C*v,o[3]=C*T-p*v,o},calculateW:function ee(o,l){const y=l[0],f=l[1],g=l[2];return o[0]=y,o[1]=f,o[2]=g,o[3]=Math.sqrt(Math.abs(1-y*y-f*f-g*g)),o},slerp:te,random:function I(o){const l=(0,F.R)(),y=(0,F.R)(),f=(0,F.R)(),g=Math.sqrt(1-l),p=Math.sqrt(l);return o[0]=g*Math.sin(2*Math.PI*y),o[1]=g*Math.cos(2*Math.PI*y),o[2]=p*Math.sin(2*Math.PI*f),o[3]=p*Math.cos(2*Math.PI*f),o},invert:function V(o,l){const y=l[0],f=l[1],g=l[2],p=l[3],C=y*y+f*f+g*g+p*p,v=C?1/C:0;return o[0]=-y*v,o[1]=-f*v,o[2]=-g*v,o[3]=p*v,o},conjugate:oe,fromMat3:U,fromEuler:X,str:function le(o){return"quat("+o[0]+", "+o[1]+", "+o[2]+", "+o[3]+")"},copy:B,set:Ie,add:Ce,mul:ie,scale:se,dot:W,lerp:ve,length:be,len:H,squaredLength:he,sqrLen:Me,normalize:G,exactEquals:ae,equals:Ue,rotationTo:function ge(o,l,y){const f=(0,_.e)(l,y);return f<-.999999?((0,_.f)(k,fe,l),(0,_.u)(k)<1e-6&&(0,_.f)(k,Ee,l),(0,_.n)(k,k),z(o,k,Math.PI),o):f>.999999?(o[0]=0,o[1]=0,o[2]=0,o[3]=1,o):((0,_.f)(k,l,y),o[0]=k[0],o[1]=k[1],o[2]=k[2],o[3]=1+f,G(o,o))},sqlerp:function Te(o,l,y,f,g,p){return te(de,l,g,p),te(ye,y,f,p),te(o,de,ye,2*p*(1-p)),o},setAxes:function Re(o,l,y,f){const g=Se;return g[0]=y[0],g[3]=y[1],g[6]=y[2],g[1]=f[0],g[4]=f[1],g[7]=f[2],g[2]=-l[0],g[5]=-l[1],g[8]=-l[2],G(o,U(o,g))}},Symbol.toStringTag,{value:"Module"}))},78451:(D,R,A)=>{function S(){return[0,0,0,1]}function h(L){return[L[0],L[1],L[2],L[3]]}function F(L,z){return new Float64Array(L,z,4)}A.d(R,{I:()=>_,a:()=>S,b:()=>h,c:()=>F});const _=[0,0,0,1];Object.freeze(Object.defineProperty({__proto__:null,create:S,clone:h,fromValues:function O(L,z,j,x){return[L,z,j,x]},createView:F,IDENTITY:_},Symbol.toStringTag,{value:"Module"}))},14658:(D,R,A)=>{function S(){return new Float32Array(3)}function O(I,V,oe){const U=new Float32Array(3);return U[0]=I,U[1]=V,U[2]=oe,U}function _(){return S()}function E(){return O(1,1,1)}function L(){return O(1,0,0)}function z(){return O(0,1,0)}function j(){return O(0,0,1)}A.d(R,{c:()=>S,f:()=>O});const x=_(),q=E(),J=L(),Q=z(),ee=j();Object.freeze(Object.defineProperty({__proto__:null,create:S,clone:function h(I){const V=new Float32Array(3);return V[0]=I[0],V[1]=I[1],V[2]=I[2],V},fromValues:O,createView:function F(I,V){return new Float32Array(I,V,3)},zeros:_,ones:E,unitX:L,unitY:z,unitZ:j,ZEROS:x,ONES:q,UNIT_X:J,UNIT_Y:Q,UNIT_Z:ee},Symbol.toStringTag,{value:"Module"}))},61107:(D,R,A)=>{A.r(R),A.d(R,{default:()=>ce});var S=A(62208),h=A(55713),O=A(48977);function F(){const t=new Float32Array(4);return t[3]=1,t}Object.freeze(Object.defineProperty({__proto__:null,create:F,clone:function _(t){const e=new Float32Array(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},fromValues:function E(t,e,i,a){const c=new Float32Array(4);return c[0]=t,c[1]=e,c[2]=i,c[3]=a,c},createView:function L(t,e){return new Float32Array(t,e,4)}},Symbol.toStringTag,{value:"Module"}));var j=A(84161),x=A(14658),q=A(55915),J=A(65234),Q=A(53776),ee=A(23899),te=A(98610),I=A(26584),V=A(58817),oe=A(63290);const U=!0;function le(t,e,i){return{identifier:String.fromCharCode.apply(null,new Uint8Array(t,i+0,10)),version:e.getUint16(i+10,U),checksum:e.getUint32(i+12,U)}}function ie(t,e,i){const a=[];e=se(t,e,a);const c=[];for(let n=0;n<a.length;n++){c.length=0,e=se(t,e,c);for(let u=0;u<c.length;u++)i.push(c[u]+a[n])}return e}function se(t,e,i){const a=new DataView(t,e),c=a.getUint8(0),n=31&c,u=!!(32&c),d=(192&c)>>6;let r=0;if(0===d)r=a.getUint32(1,U),e+=5;else if(1===d)r=a.getUint16(1,U),e+=3;else{if(2!==d)throw new I.Z("lepcc-decode-error","Bad count type");r=a.getUint8(1),e+=2}if(u)throw new I.Z("lepcc-decode-error","LUT not implemented");const b=Math.ceil(r*n/8),s=new Uint8Array(t,e,b);let m=0,w=0,M=0;const Z=-1>>>32-n;for(let $=0;$<r;$++){for(;w<n;)m|=s[M]<<w,w+=8,M+=1;i[$]=m&Z,m>>>=n,w-=n,w+n>32&&(m|=s[M-1]>>8-w)}return e+M}var G=A(16396);const ae=oe.Z.getLogger("esri.views.3d.layers.i3s.I3SBinaryReader");function Ue(t,e,i){let a="",c=0;for(;c<i;){const n=t[e+c];if(n<128)a+=String.fromCharCode(n),c++;else if(n>=192&&n<224){if(c+1>=i)throw new I.Z("utf8-decode-error","UTF-8 Decode failed. Two byte character was truncated.");a+=String.fromCharCode((31&n)<<6|63&t[e+c+1]),c+=2}else if(n>=224&&n<240){if(c+2>=i)throw new I.Z("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");a+=String.fromCharCode((15&n)<<12|(63&t[e+c+1])<<6|63&t[e+c+2]),c+=3}else{if(!(n>=240&&n<248))throw new I.Z("utf8-decode-error","UTF-8 Decode failed. Invalid multi byte sequence.");{if(c+3>=i)throw new I.Z("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");const u=(7&n)<<18|(63&t[e+c+1])<<12|(63&t[e+c+2])<<6|63&t[e+c+3];a+=u>=65536?String.fromCharCode(55296+(u-65536>>10),56320+(1023&u)):String.fromCharCode(u),c+=4}}}return a}function ge(t,e){const i={byteOffset:0,byteCount:0,fields:Object.create(null)};let a=0;for(let c=0;c<e.length;c++){const n=e[c],u=n.valueType||n.type;i.fields[n.property]=(0,g[u])(t,a),a+=f[u].BYTES_PER_ELEMENT}return i.byteCount=a,i}function fe(t,e){return new f[e.valueType](t,e.byteOffset,e.count*e.valuesPerElement)}function de(t,e,i){if(e!==t&&ae.error(`Invalid ${i} buffer size\n expected: ${t}, actual: ${e})`),e<t)throw new I.Z("buffer-too-small","Binary buffer is too small",{expectedSize:t,actualSize:e})}const l={position:G.T.POSITION,normal:G.T.NORMAL,color:G.T.COLOR,uv0:G.T.UV0,region:G.T.UVREGION};function y(t,e,i){if("lepcc-rgb"===t.encoding)return function be(t){const e=new DataView(t,0);let i=0;const{identifier:a,version:c}=le(t,e,i);if(i+=16,"ClusterRGB"!==a)throw new I.Z("lepcc-decode-error","Bad identifier");if(c>1)throw new I.Z("lepcc-decode-error","Unknown version");const n=function ve(t,e){return{sizeLo:t.getUint32(e+0,U),sizeHi:t.getUint32(e+4,U),count:t.getUint32(e+8,U),colorMapCount:t.getUint16(e+12,U),lookupMethod:t.getUint8(e+14),compressionMethod:t.getUint8(e+15)}}(e,i);if(i+=16,n.sizeHi*2**32+n.sizeLo!==t.byteLength)throw new I.Z("lepcc-decode-error","Bad size");if((2===n.lookupMethod||1===n.lookupMethod)&&0===n.compressionMethod){if(3*n.colorMapCount+n.count+i!==t.byteLength||n.colorMapCount>256)throw new I.Z("lepcc-decode-error","Bad count");const u=new Uint8Array(t,i,3*n.colorMapCount),d=new Uint8Array(t,i+3*n.colorMapCount,n.count),r=new Uint8Array(3*n.count);for(let b=0;b<n.count;b++){const s=d[b];r[3*b]=u[3*s],r[3*b+1]=u[3*s+1],r[3*b+2]=u[3*s+2]}return r}if(0===n.lookupMethod&&0===n.compressionMethod){if(3*n.count+i!==t.byteLength||0!==n.colorMapCount)throw new I.Z("lepcc-decode-error","Bad count");return new Uint8Array(t,i).slice()}if(n.lookupMethod<=2&&1===n.compressionMethod){if(i+3!==t.byteLength||1!==n.colorMapCount)throw new I.Z("lepcc-decode-error","Bad count");const u=e.getUint8(i),d=e.getUint8(i+1),r=e.getUint8(i+2),b=new Uint8Array(3*n.count);for(let s=0;s<n.count;s++)b[3*s]=u,b[3*s+1]=d,b[3*s+2]=r;return b}throw new I.Z("lepcc-decode-error","Bad method "+n.lookupMethod+","+n.compressionMethod)}(e);if("lepcc-intensity"===t.encoding)return function Me(t){const e=new DataView(t,0);let i=0;const{identifier:a,version:c}=le(t,e,i);if(i+=16,"Intensity "!==a)throw new I.Z("lepcc-decode-error","Bad identifier");if(c>1)throw new I.Z("lepcc-decode-error","Unknown version");const n=function he(t,e){return{sizeLo:t.getUint32(e+0,U),sizeHi:t.getUint32(e+4,U),count:t.getUint32(e+8,U),scaleFactor:t.getUint16(e+12,U),bitsPerPoint:t.getUint8(e+14),reserved:t.getUint8(e+15)}}(e,i);if(i+=16,n.sizeHi*2**32+n.sizeLo!==t.byteLength)throw new I.Z("lepcc-decode-error","Bad size");const u=new Uint16Array(n.count);if(8===n.bitsPerPoint){if(n.count+i!==t.byteLength)throw new I.Z("lepcc-decode-error","Bad size");const d=new Uint8Array(t,i,n.count);for(let r=0;r<n.count;r++)u[r]=d[r]*n.scaleFactor}else if(16===n.bitsPerPoint){if(2*n.count+i!==t.byteLength)throw new I.Z("lepcc-decode-error","Bad size");const d=new Uint16Array(t,i,n.count);for(let r=0;r<n.count;r++)u[r]=d[r]*n.scaleFactor}else{const d=[];if(se(t,i,d)!==t.byteLength)throw new I.Z("lepcc-decode-error","Bad size");for(let r=0;r<n.count;r++)u[r]=d[r]*n.scaleFactor}return u}(e);if(null!=t.encoding&&""!==t.encoding)throw new I.Z("unknown-attribute-storage-info-encoding","Unknown Attribute Storage Info Encoding");t["attributeByteCounts "]&&!t.attributeByteCounts&&(ae.warn("Warning: Trailing space in 'attributeByteCounts '."),t.attributeByteCounts=t["attributeByteCounts "]),"ObjectIds"===t.ordering[0]&&t.hasOwnProperty("objectIds")&&(ae.warn("Warning: Case error in objectIds"),t.ordering[0]="objectIds");const a=function Te(t,e,i){const a=null!=e.header?ge(t,e.header):{byteOffset:0,byteCount:0,fields:{count:i}},c={header:a,byteOffset:a.byteCount,byteCount:0,entries:Object.create(null)};let n=a.byteCount;for(let u=0;u<e.ordering.length;u++){const d=e.ordering[u],r=(0,V.d9)(e[d]);if(r.count=a.fields.count,"String"===r.valueType){if(r.byteOffset=n,r.byteCount=a.fields[d+"ByteCount"],"UTF-8"!==r.encoding)throw new I.Z("unsupported-encoding","Unsupported String encoding.",{encoding:r.encoding})}else{if(!p(r.valueType))throw new I.Z("unsupported-value-type","Unsupported binary valueType",{valueType:r.valueType});{const b=C(r.valueType);n+=n%b!=0?b-n%b:0,r.byteOffset=n,r.byteCount=b*r.valuesPerElement*r.count}}n+=r.byteCount,c.entries[d]=r}return c.byteCount=n-c.byteOffset,c}(e,t,i);de(a.byteOffset+a.byteCount,e.byteLength,"attribute");const c=a.entries.attributeValues||a.entries.objectIds;if(c){if("String"===c.valueType){const n=a.entries.attributeByteCounts,u=fe(e,n),d=function Ee(t,e){return new Uint8Array(t,e.byteOffset,e.byteCount)}(e,c);return function k(t,e,i){const a=[];let c,n,u=0;for(n=0;n<t;n+=1){if(c=e[n],c>0){if(a.push(Ue(i,u,c-1)),0!==i[u+c-1])throw new I.Z("string-array-error","Invalid string array: missing null termination.")}else a.push(null);u+=c}return a}(n.count,u,d)}return fe(e,c)}throw new I.Z("bad-attribute-storage-info","Bad attributeStorageInfo specification.")}const f={Float32:Float32Array,Float64:Float64Array,UInt8:Uint8Array,Int8:Int8Array,UInt16:Uint16Array,Int16:Int16Array,UInt32:Uint32Array,Int32:Int32Array},g={Float32:(t,e)=>new DataView(t,0).getFloat32(e,!0),Float64:(t,e)=>new DataView(t,0).getFloat64(e,!0),UInt8:(t,e)=>new DataView(t,0).getUint8(e),Int8:(t,e)=>new DataView(t,0).getInt8(e),UInt16:(t,e)=>new DataView(t,0).getUint16(e,!0),Int16:(t,e)=>new DataView(t,0).getInt16(e,!0),UInt32:(t,e)=>new DataView(t,0).getUint32(e,!0),Int32:(t,e)=>new DataView(t,0).getInt32(e,!0)};function p(t){return f.hasOwnProperty(t)}function C(t){return p(t)?f[t].BYTES_PER_ELEMENT:0}function T(t,e){if(null==t.encoding||""===t.encoding){const i=function Re(t,e){const i=ge(t,e&&e.header);let a=i.byteCount;const c={isDraco:!1,header:i,byteOffset:i.byteCount,byteCount:0,vertexAttributes:{}},n=i.fields,u=null!=n.vertexCount?n.vertexCount:n.count;for(const b of e.ordering){if(!e.vertexAttributes[b])continue;const s=we(Ae({},e.vertexAttributes[b]),{byteOffset:a,count:u});c.vertexAttributes[l[b]?l[b]:"_"+b]=s,a+=C(s.valueType)*s.valuesPerElement*u}const d=n.faceCount;if(e.faces&&d){c.faces={};for(const b of e.ordering){if(!e.faces[b])continue;const s=we(Ae({},e.faces[b]),{byteOffset:a,count:d});c.faces[b]=s,a+=C(s.valueType)*s.valuesPerElement*d}}const r=n.featureCount;if(e.featureAttributes&&e.featureAttributeOrder&&r){c.featureAttributes={};for(const b of e.featureAttributeOrder){if(!e.featureAttributes[b])continue;const s=we(Ae({},e.featureAttributes[b]),{byteOffset:a,count:r});c.featureAttributes[b]=s,a+=("UInt64"===s.valueType?8:C(s.valueType))*s.valuesPerElement*r}}return de(a,t.byteLength,"geometry"),c.byteCount=a-c.byteOffset,c}(e,t);if((0,S.Wi)(i.vertexAttributes.position))return;const a=fe(e,i.vertexAttributes.position),c=i.header.fields,n=[c.offsetX,c.offsetY,c.offsetZ],u=[c.scaleX,c.scaleY,c.scaleZ],d=a.length/3,r=new Float64Array(3*d);for(let b=0;b<d;b++)r[3*b]=a[3*b]*u[0]+n[0],r[3*b+1]=a[3*b+1]*u[1]+n[1],r[3*b+2]=a[3*b+2]*u[2]+n[2];return r}if("lepcc-xyz"===t.encoding)return function Ce(t){const e=new DataView(t,0);let i=0;const{identifier:a,version:c}=le(t,e,i);if(i+=16,"LEPCC     "!==a)throw new I.Z("lepcc-decode-error","Bad identifier");if(c>1)throw new I.Z("lepcc-decode-error","Unknown version");const n=function Ie(t,e){return{sizeLo:t.getUint32(e+0,U),sizeHi:t.getUint32(e+4,U),minX:t.getFloat64(e+8,U),minY:t.getFloat64(e+16,U),minZ:t.getFloat64(e+24,U),maxX:t.getFloat64(e+32,U),maxY:t.getFloat64(e+40,U),maxZ:t.getFloat64(e+48,U),errorX:t.getFloat64(e+56,U),errorY:t.getFloat64(e+64,U),errorZ:t.getFloat64(e+72,U),count:t.getUint32(e+80,U),reserved:t.getUint32(e+84,U)}}(e,i);if(i+=88,n.sizeHi*2**32+n.sizeLo!==t.byteLength)throw new I.Z("lepcc-decode-error","Bad size");const u=new Float64Array(3*n.count),d=[],r=[],b=[],s=[];if(i=ie(t,i,d),i=ie(t,i,r),i=ie(t,i,b),i=ie(t,i,s),i!==t.byteLength)throw new I.Z("lepcc-decode-error","Bad length");let m=0,w=0;for(let M=0;M<d.length;M++){w+=d[M];let Z=0;for(let $=0;$<r[M];$++){Z+=b[m];const pe=s[m];u[3*m]=Math.min(n.maxX,n.minX+2*n.errorX*Z),u[3*m+1]=Math.min(n.maxY,n.minY+2*n.errorY*w),u[3*m+2]=Math.min(n.maxZ,n.minZ+2*n.errorZ*pe),m++}}return{errorX:n.errorX,errorY:n.errorY,errorZ:n.errorZ,result:u}}(e).result}function P(t,e,i){return(0,S.pC)(t)&&t.attributeInfo.useElevation?function N(t,e){const i=new Float64Array(e);for(let a=0;a<e;a++)i[a]=t[3*a+2];return i}(e,i):(0,S.pC)(t)?y(t.attributeInfo.storageInfo,t.buffer,i):null}function Y(t){return null==t||"none"===t?null:"low-four-bit"===t?e=>15&e:"high-four-bit"===t?e=>(240&e)>>4:"absolute-value"===t?e=>Math.abs(e):"modulo-ten"===t?e=>e%10:null}function ne(t){let e=0;for(const i of t||[])e|=1<<i;return e}class ue{transform(e){const i=this._transform(e),a=[i.points.buffer,i.rgb.buffer];(0,S.pC)(i.pointIdFilterMap)&&a.push(i.pointIdFilterMap.buffer);for(const c of i.attributes)"buffer"in c.values&&(0,h.eP)(c.values.buffer)&&c.values.buffer!==i.rgb.buffer&&a.push(c.values.buffer);return Promise.resolve({result:i,transferList:a})}_transform(e){const i=T(e.schema,e.geometryBuffer);let a=i.length/3,c=null;const n=[],u=P(e.primaryAttributeData,i,a);(0,S.pC)(e.primaryAttributeData)&&u&&n.push({attributeInfo:e.primaryAttributeData.attributeInfo,values:u});const d=P(e.modulationAttributeData,i,a);(0,S.pC)(e.modulationAttributeData)&&d&&n.push({attributeInfo:e.modulationAttributeData.attributeInfo,values:d});let r=function v(t,e,i,a){const{rendererJSON:c,isRGBRenderer:n}=t;let u=null,d=null;if(e&&n)u=e;else if(e&&"pointCloudUniqueValueRenderer"===c.type){d=te.Z.fromJSON(c);const r=d.colorUniqueValueInfos;u=new Uint8Array(3*a);const b=Y(d.fieldTransformType);for(let s=0;s<a;s++){const m=(b?b(e[s]):e[s])+"";for(let w=0;w<r.length;w++)if(r[w].values.includes(m)){u[3*s]=r[w].color.r,u[3*s+1]=r[w].color.g,u[3*s+2]=r[w].color.b;break}}}else if(e&&"pointCloudStretchRenderer"===c.type){d=ee.Z.fromJSON(c);const r=d.stops;u=new Uint8Array(3*a);const b=Y(d.fieldTransformType);for(let s=0;s<a;s++){const m=b?b(e[s]):e[s],w=r.length-1;if(m<r[0].value)u[3*s]=r[0].color.r,u[3*s+1]=r[0].color.g,u[3*s+2]=r[0].color.b;else if(m>=r[w].value)u[3*s]=r[w].color.r,u[3*s+1]=r[w].color.g,u[3*s+2]=r[w].color.b;else for(let M=1;M<r.length;M++)if(m<r[M].value){const Z=(m-r[M-1].value)/(r[M].value-r[M-1].value);u[3*s]=r[M].color.r*Z+r[M-1].color.r*(1-Z),u[3*s+1]=r[M].color.g*Z+r[M-1].color.g*(1-Z),u[3*s+2]=r[M].color.b*Z+r[M-1].color.b*(1-Z);break}}}else if(e&&"pointCloudClassBreaksRenderer"===c.type){d=Q.Z.fromJSON(c);const r=d.colorClassBreakInfos;u=new Uint8Array(3*a);const b=Y(d.fieldTransformType);for(let s=0;s<a;s++){const m=b?b(e[s]):e[s];for(let w=0;w<r.length;w++)if(m>=r[w].minValue&&m<=r[w].maxValue){u[3*s]=r[w].color.r,u[3*s+1]=r[w].color.g,u[3*s+2]=r[w].color.b;break}}}else{u=new Uint8Array(3*a);for(let r=0;r<u.length;r++)u[r]=255}if(i&&d&&d.colorModulation){const r=d.colorModulation.minValue,b=d.colorModulation.maxValue,s=.3;for(let m=0;m<a;m++){const w=i[m],M=w>=b?1:w<=r?s:s+(1-s)*(w-r)/(b-r);u[3*m]=M*u[3*m],u[3*m+1]=M*u[3*m+1],u[3*m+2]=M*u[3*m+2]}}return u}(e.rendererInfo,u,d,a);if(e.filterInfo&&e.filterInfo.length>0&&(0,S.pC)(e.filterAttributesData)){const s=e.filterAttributesData.map(m=>{const w=P(m,i,a),M={attributeInfo:m.attributeInfo,values:w};return n.push(M),M});c=new Uint32Array(a),a=function K(t,e,i,a,c){const n=t.length/3;let u=0;for(let d=0;d<n;d++){let r=!0;for(let b=0;b<a.length&&r;b++){const{filterJSON:s}=a[b],m=c[b].values[d];switch(s.type){case"pointCloudValueFilter":{const w="exclude"===s.mode;s.values.includes(m)===w&&(r=!1);break}case"pointCloudBitfieldFilter":{const w=ne(s.requiredSetBits),M=ne(s.requiredClearBits);(m&w)===w&&0==(m&M)||(r=!1);break}case"pointCloudReturnFilter":{const w=15&m,M=m>>>4&15,Z=M>1,$=1===w,pe=w===M;let Le=!1;for(const me of s.includedReturns)if("last"===me&&pe||"firstOfMany"===me&&$&&Z||"lastOfMany"===me&&pe&&Z||"single"===me&&!Z){Le=!0;break}Le||(r=!1);break}}}r&&(i[u]=d,t[3*u]=t[3*d],t[3*u+1]=t[3*d+1],t[3*u+2]=t[3*d+2],e[3*u]=e[3*d],e[3*u+1]=e[3*d+1],e[3*u+2]=e[3*d+2],u++)}return u}(i,r,c,e.filterInfo,s)}for(const s of e.userAttributesData){const m=P(s,i,a);n.push({attributeInfo:s.attributeInfo,values:m})}3*a<r.length&&(r=new Uint8Array(r.buffer.slice(0,3*a))),this._applyElevationOffsetInPlace(i,a,e.elevationOffset);const b=this._transformCoordinates(i,a,e.obb,J.Z.fromJSON(e.inSR),J.Z.fromJSON(e.outSR));return{obb:e.obb,points:b,rgb:r,attributes:n,pointIdFilterMap:c}}_transformCoordinates(e,i,a,c,n){if(!(0,q.CM)(e,c,0,e,n,0,i))throw Error("Can't reproject");const u=(0,x.f)(a.center[0],a.center[1],a.center[2]),d=(0,x.c)(),r=(0,x.c)();(0,O.c)(re,a.quaternion);const b=new Float32Array(3*i);for(let s=0;s<i;s++)d[0]=e[3*s]-u[0],d[1]=e[3*s+1]-u[1],d[2]=e[3*s+2]-u[2],(0,j.q)(r,d,re),a.halfSize[0]=Math.max(a.halfSize[0],Math.abs(r[0])),a.halfSize[1]=Math.max(a.halfSize[1],Math.abs(r[1])),a.halfSize[2]=Math.max(a.halfSize[2],Math.abs(r[2])),b[3*s]=d[0],b[3*s+1]=d[1],b[3*s+2]=d[2];return b}_applyElevationOffsetInPlace(e,i,a){if(0!==a)for(let c=0;c<i;c++)e[3*c+2]+=a}}const re=F();function ce(){return new ue}},16396:(D,R,A)=>{var S,h;A.d(R,{T:()=>S}),(h=S||(S={})).POSITION="position",h.NORMAL="normal",h.UV0="uv0",h.AUXPOS1="auxpos1",h.AUXPOS2="auxpos2",h.MAPPOS="mapPos",h.COLOR="color",h.SYMBOLCOLOR="symbolColor",h.SIZE="size",h.TANGENT="tangent",h.OFFSET="offset",h.SUBDIVISIONFACTOR="subdivisionFactor",h.COLORFEATUREATTRIBUTE="colorFeatureAttribute",h.SIZEFEATUREATTRIBUTE="sizeFeatureAttribute",h.OPACITYFEATUREATTRIBUTE="opacityFeatureAttribute",h.DISTANCETOSTART="distanceToStart",h.UVMAPSPACE="uvMapSpace",h.BOUNDINGRECT="boundingRect",h.UVREGION="uvRegion",h.NORMALCOMPRESSED="normalCompressed",h.PROFILERIGHT="profileRight",h.PROFILEUP="profileUp",h.PROFILEVERTEXANDNORMAL="profileVertexAndNormal",h.FEATUREVALUE="featureValue",h.MODELORIGINHI="modelOriginHi",h.MODELORIGINLO="modelOriginLo",h.MODEL="model",h.MODELNORMAL="modelNormal",h.INSTANCECOLOR="instanceColor",h.INSTANCEFEATUREATTRIBUTE="instanceFeatureAttribute",h.LOCALTRANSFORM="localTransform",h.GLOBALTRANSFORM="globalTransform",h.BOUNDINGSPHERE="boundingSphere",h.MODELORIGIN="modelOrigin",h.MODELSCALEFACTORS="modelScaleFactors",h.FEATUREATTRIBUTE="featureAttribute",h.STATE="state",h.LODLEVEL="lodLevel",h.POSITION0="position0",h.POSITION1="position1",h.NORMALA="normalA",h.NORMALB="normalB",h.COMPONENTINDEX="componentIndex",h.VARIANTOFFSET="variantOffset",h.VARIANTSTROKE="variantStroke",h.VARIANTEXTENSION="variantExtension",h.U8PADDING="u8padding",h.U16PADDING="u16padding",h.SIDENESS="sideness",h.START="start",h.END="end",h.UP="up",h.EXTRUDE="extrude"}}]);