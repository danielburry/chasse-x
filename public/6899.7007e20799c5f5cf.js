"use strict";(self.webpackChunkchasse_pwa_front=self.webpackChunkchasse_pwa_front||[]).push([[6899],{37384:(B,O,e)=>{e.d(O,{y:()=>F});var t=e(17626),M=e(74333),R=e(89726),D=e(26584),p=e(32917),r=e(77712),m=(e(85931),e(8314),e(90912),e(76898)),L=e(1011),b=e(86810);e(63290),e(82255);let C=class extends b.wq{};C=(0,t._)([(0,m.j)("esri.views.layers.support.ClipArea")],C);const a=C;var u;let c=u=class extends a{constructor(){super(...arguments),this.type="rect",this.left=null,this.right=null,this.top=null,this.bottom=null}clone(){return new u({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}get version(){return(this._get("version")||0)+1}};(0,t._)([(0,r.Cb)({type:[Number,String],json:{write:!0}})],c.prototype,"left",void 0),(0,t._)([(0,r.Cb)({type:[Number,String],json:{write:!0}})],c.prototype,"right",void 0),(0,t._)([(0,r.Cb)({type:[Number,String],json:{write:!0}})],c.prototype,"top",void 0),(0,t._)([(0,r.Cb)({type:[Number,String],json:{write:!0}})],c.prototype,"bottom",void 0),(0,t._)([(0,r.Cb)({readOnly:!0})],c.prototype,"version",null),c=u=(0,t._)([(0,m.j)("esri.views.layers.support.ClipRect")],c);const S=c;e(29132);var h,V=e(21674),s=e(91179),i=e(2004),n=e(37118);const f={base:V.Z,key:"type",typeMap:{extent:i.Z,polygon:n.Z}};let l=h=class extends a{constructor(){super(...arguments),this.type="geometry",this.geometry=null}get version(){return(this._get("version")||0)+1}clone(){return new h({geometry:this.geometry.clone()})}};(0,t._)([(0,r.Cb)({types:f,json:{read:s.im,write:!0}})],l.prototype,"geometry",void 0),(0,t._)([(0,r.Cb)({readOnly:!0})],l.prototype,"version",null),l=h=(0,t._)([(0,m.j)("esri.views.layers.support.Geometry")],l);const E=l;let w=class extends a{constructor(){super(...arguments),this.type="path",this.path=[]}get version(){return(this._get("version")||0)+1}};(0,t._)([(0,r.Cb)({type:[[[Number]]],json:{write:!0}})],w.prototype,"path",void 0),(0,t._)([(0,r.Cb)({readOnly:!0})],w.prototype,"version",null),w=(0,t._)([(0,m.j)("esri.views.layers.support.Path")],w);const W=M.Z.ofType({key:"type",base:a,typeMap:{rect:S,path:w,geometry:E}}),F=x=>{let _=class extends x{constructor(){super(...arguments),this.attached=!1,this.clips=new W,this.lastUpdateId=-1,this.moving=!1,this.updateRequested=!1}initialize(){var P,U,K,Z;const o=null==(U=null==(P=this.view)?void 0:P.spatialReferenceLocked)||U;(null==(K=this.view)?void 0:K.spatialReference)&&o&&!this.spatialReferenceSupported?this.addResolvingPromise(Promise.reject(new D.Z("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",{layer:this.layer}))):(this.container||(this.container=new L.W),this.container.fadeTransitionEnabled=!0,this.container.opacity=0,this.container.clips=this.clips,this.handles.add([(0,p.YP)(()=>this.suspended,y=>{this.container&&(this.container.visible=!y),this.view&&!y&&this.updateRequested&&this.view.requestUpdate()},p.tX),(0,p.YP)(()=>{var y,G;return null!=(G=null==(y=this.layer)?void 0:y.opacity)?G:1},y=>{this.container&&(this.container.opacity=y)},p.tX),(0,p.YP)(()=>this.layer&&"blendMode"in this.layer?this.layer.blendMode:"normal",y=>{this.container&&(this.container.blendMode=y)},p.tX),(0,p.YP)(()=>this.layer&&"effect"in this.layer?this.layer.effect:null,y=>{this.container&&(this.container.effect=y)},p.tX),(0,p.on)(()=>this.clips,"change",()=>{this.container&&(this.container.clips=this.clips)})]),(null==(Z=this.view)?void 0:Z.whenLayerView)?this.view.whenLayerView(this.layer).then(y=>{y===this&&this.processAttach()},()=>{}):this.when().then(()=>{this.processAttach()},()=>{}))}destroy(){this.processDetach(),this.updateRequested=!1}get spatialReferenceSupported(){var v;const o=null==(v=this.view)?void 0:v.spatialReference;return null==o||this.supportsSpatialReference(o)}get updating(){var o;return this.spatialReferenceSupported&&(!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())||!!(null==(o=this.updatingHandles)?void 0:o.updating))}get visibleAtCurrentScale(){return this.isVisibleAtScale(this.view.scale)}processAttach(){this.isResolved()&&!this.attached&&!this.destroyed&&this.spatialReferenceSupported&&(this.attach(),this.attached=!0,this.requestUpdate())}processDetach(){this.attached&&(this.attached=!1,this.detach(),this.updateRequested=!1)}isVisibleAtScale(o){const v=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;if(!v)return!0;const{minScale:P,maxScale:U}=v;return(0===P||o<=P)&&(0===U||o>=U)}requestUpdate(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())}processUpdate(o){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",o),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(o))):this.updateRequested=!1}hitTest(o,v){return Promise.resolve(null)}supportsSpatialReference(o){return!0}canResume(){return!!this.spatialReferenceSupported&&!!super.canResume()&&this.visibleAtCurrentScale}getSuspendInfo(){const o=super.getSuspendInfo(),v=!this.spatialReferenceSupported,P=this.visibleAtCurrentScale;return v&&(o.spatialReferenceNotSupported=v),P&&(o.outsideScaleRange=P),o}};return(0,t._)([(0,r.Cb)()],_.prototype,"attached",void 0),(0,t._)([(0,r.Cb)({type:W,set(o){const v=(0,R.Z)(o,this._get("clips"),W);this._set("clips",v)}})],_.prototype,"clips",void 0),(0,t._)([(0,r.Cb)()],_.prototype,"container",void 0),(0,t._)([(0,r.Cb)()],_.prototype,"moving",void 0),(0,t._)([(0,r.Cb)({readOnly:!0})],_.prototype,"spatialReferenceSupported",null),(0,t._)([(0,r.Cb)({readOnly:!0})],_.prototype,"updateParameters",void 0),(0,t._)([(0,r.Cb)()],_.prototype,"updateRequested",void 0),(0,t._)([(0,r.Cb)()],_.prototype,"updating",null),(0,t._)([(0,r.Cb)()],_.prototype,"view",void 0),(0,t._)([(0,r.Cb)({readOnly:!0})],_.prototype,"visibleAtCurrentScale",null),_=(0,t._)([(0,m.j)("esri.views.2d.layers.LayerView2D")],_),_}},36899:(B,O,e)=>{e.r(O),e.d(O,{default:()=>V});var t=e(15861),M=e(17626),R=e(88879),D=e(74333),p=e(62208),r=e(32917),b=(e(63290),e(90912),e(85931),e(8314),e(82255),e(76898)),T=e(37384),d=e(36275),C=e(35627),a=e(45611);const u="sublayers",c="layerView",S=Object.freeze({remove(){},pause(){},resume(){}});let A=class extends((0,T.y)(a.Z)){constructor(){super(...arguments),this._highlightIds=new Map}fetchPopupFeatures(s){var i=this;return(0,t.Z)(function*(){return Array.from(i.graphicsViews(),n=>n.hitTest(s).filter(h=>!!h.popupTemplate)).flat()})()}*graphicsViews(){(0,p.pC)(this._graphicsViewsFeatureCollectionMap)?yield*this._graphicsViewsFeatureCollectionMap.keys():(0,p.pC)(this._graphicsViews)?yield*this._graphicsViews:yield*[]}hitTest(s,i){var n=this;return(0,t.Z)(function*(){return Array.from(n.graphicsViews(),h=>{const f=h.hitTest(s);if((0,p.pC)(n._graphicsViewsFeatureCollectionMap)){const l=n._graphicsViewsFeatureCollectionMap.get(h);for(const E of f)!E.popupTemplate&&l.popupTemplate&&(E.popupTemplate=l.popupTemplate)}return f}).flat().map(h=>({type:"graphic",graphic:h,layer:n.layer,mapPoint:s}))})()}highlight(s){let i;return"number"==typeof s?i=[s]:s instanceof R.Z?i=[s.uid]:Array.isArray(s)&&s.length>0?i="number"==typeof s[0]?s:s.map(n=>n&&n.uid):D.Z.isCollection(s)&&(i=s.map(n=>n&&n.uid).toArray()),i=i.filter(n=>null!=n),i.length?(this._addHighlight(i),{remove:()=>{this._removeHighlight(i)}}):S}update(s){for(const i of this.graphicsViews())i.processUpdate(s)}attach(){const s=this.view,i=()=>this.requestUpdate(),n=this.layer.featureCollections;if((0,p.pC)(n)&&n.length){this._graphicsViewsFeatureCollectionMap=new Map;for(const h of n){const f=new d.Z(this.view.featuresTilingScheme);f.fadeTransitionEnabled=!0;const l=new C.Z({view:s,graphics:h.source,renderer:h.renderer,requestUpdateCallback:i,container:f});this._graphicsViewsFeatureCollectionMap.set(l,h),this.container.addChild(l.container),this.handles.add([(0,r.YP)(()=>h.visible,E=>l.container.visible=E,r.nn),(0,r.YP)(()=>l.updating,()=>this.notifyChange("updating"),r.nn)],c)}this._updateHighlight()}else(0,p.pC)(this.layer.sublayers)&&this.handles.add((0,r.on)(()=>this.layer.sublayers,"change",()=>this._createGraphicsViews(),{onListenerAdd:()=>this._createGraphicsViews(),onListenerRemove:()=>this._destroyGraphicsViews()}),u)}detach(){this._destroyGraphicsViews(),this.handles.remove(u)}moveStart(){}moveEnd(){}viewChange(){for(const s of this.graphicsViews())s.viewChange()}isUpdating(){for(const s of this.graphicsViews())if(s.updating)return!0;return!1}_destroyGraphicsViews(){this.container.removeAllChildren(),this.handles.remove(c);for(const s of this.graphicsViews())s.destroy();this._graphicsViews=null,this._graphicsViewsFeatureCollectionMap=null}_createGraphicsViews(){if(this._destroyGraphicsViews(),(0,p.Wi)(this.layer.sublayers))return;const s=[],i=this.view,n=()=>this.requestUpdate();for(const h of this.layer.sublayers){const f=new d.Z(this.view.featuresTilingScheme);f.fadeTransitionEnabled=!0;const l=new C.Z({view:i,graphics:h.graphics,requestUpdateCallback:n,container:f});this.handles.add([h.on("graphic-update",l.graphicUpdateHandler),(0,r.YP)(()=>h.visible,E=>l.container.visible=E,r.nn),(0,r.YP)(()=>l.updating,()=>this.notifyChange("updating"),r.nn)],c),this.container.addChild(l.container),s.push(l)}this._graphicsViews=s,this._updateHighlight()}_addHighlight(s){for(const i of s)if(this._highlightIds.has(i)){const n=this._highlightIds.get(i);this._highlightIds.set(i,n+1)}else this._highlightIds.set(i,1);this._updateHighlight()}_removeHighlight(s){for(const i of s)if(this._highlightIds.has(i)){const n=this._highlightIds.get(i)-1;0===n?this._highlightIds.delete(i):this._highlightIds.set(i,n)}this._updateHighlight()}_updateHighlight(){const s=Array.from(this._highlightIds.keys());for(const i of this.graphicsViews())i.setHighlight(s)}};A=(0,M._)([(0,b.j)("esri.views.2d.layers.MapNotesLayerView2D")],A);const V=A},45611:(B,O,e)=>{e.d(O,{Z:()=>C});var t=e(17626),M=e(14517),R=e(61885),D=e(80542),p=e(61996),r=e(63290),I=e(62208),j=e(60330),g=e(77712),T=(e(85931),e(8314),e(90912),e(76898));let d=class extends((0,D.p)((0,p.IG)((0,j.v)(R.Z.EventedMixin(M.Z))))){constructor(a){super(a),this.layer=null,this.parent=null}initialize(){this.when().catch(a=>{if("layerview:create-error"!==a.name){const u=this.layer&&this.layer.id||"no id",c=this.layer&&this.layer.title||"no title";r.Z.getLogger(this.declaredClass).error("#resolve()",`Failed to resolve layer view (layer title: '${c}', id: '${u}')`,a)}})}get fullOpacity(){return(0,I.Pt)(this.get("layer.opacity"),1)*(0,I.Pt)(this.get("parent.fullOpacity"),1)}get suspended(){return!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){var a;return!this.suspended&&!0===(null==(a=this.layer)?void 0:a.legendEnabled)}get updating(){var a;return!(!(null==(a=this.updatingHandles)?void 0:a.updating)&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get visible(){var a;return!0===(null==(a=this.layer)?void 0:a.visible)}set visible(a){void 0!==a?this._override("visible",a):this._clearOverride("visible")}canResume(){var a,u,c;return this.visible&&(null==(a=this.layer)?void 0:a.loaded)&&!(null==(u=this.parent)?void 0:u.suspended)&&(null==(c=this.view)?void 0:c.ready)||!1}getSuspendInfo(){const a=this.parent&&this.parent.suspended?this.parent.suspendInfo:{};return this.view&&this.view.ready||(a.viewNotReady=!0),this.layer&&this.layer.loaded||(a.layerNotLoaded=!0),this.visible||(a.layerInvisible=!0),a}isUpdating(){return!1}};(0,t._)([(0,g.Cb)()],d.prototype,"fullOpacity",null),(0,t._)([(0,g.Cb)()],d.prototype,"layer",void 0),(0,t._)([(0,g.Cb)()],d.prototype,"parent",void 0),(0,t._)([(0,g.Cb)({readOnly:!0})],d.prototype,"suspended",null),(0,t._)([(0,g.Cb)({readOnly:!0})],d.prototype,"suspendInfo",null),(0,t._)([(0,g.Cb)({readOnly:!0})],d.prototype,"legendEnabled",null),(0,t._)([(0,g.Cb)({type:Boolean,readOnly:!0})],d.prototype,"updating",null),(0,t._)([(0,g.Cb)({readOnly:!0})],d.prototype,"updatingProgress",null),(0,t._)([(0,g.Cb)()],d.prototype,"visible",null),(0,t._)([(0,g.Cb)()],d.prototype,"view",void 0),d=(0,t._)([(0,T.j)("esri.views.layers.LayerView")],d);const C=d}}]);