"use strict";var ht=Object.defineProperty,ft=Object.defineProperties,mt=Object.getOwnPropertyDescriptors,_e=Object.getOwnPropertySymbols,gt=Object.prototype.hasOwnProperty,Ft=Object.prototype.propertyIsEnumerable,ve=(S,F,i)=>F in S?ht(S,F,{enumerable:!0,configurable:!0,writable:!0,value:i}):S[F]=i,u=(S,F)=>{for(var i in F||(F={}))gt.call(F,i)&&ve(S,i,F[i]);if(_e)for(var i of _e(F))Ft.call(F,i)&&ve(S,i,F[i]);return S},g=(S,F)=>ft(S,mt(F));(self.webpackChunkchasse_pwa_front=self.webpackChunkchasse_pwa_front||[]).push([[114],{87757:(S,F,i)=>{i.d(F,{g:()=>p});const p={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},30114:(S,F,i)=>{i.r(F),i.d(F,{default:()=>yt});var p=i(15861),R=i(17626),E=(i(29132),i(88879)),O=i(84792),v=i(97478),_=i(26584),I=i(8314),T=i(2076),q=i(47996),m=i(62208),b=i(94113),Q=i(10699),A=i(21726),x=i(77712),V=(i(85931),i(90912),i(76898)),W=i(2004),he=i(91179),Ie=i(56554),fe=i(15283),be=i(2865),j=i(2618),Ce=i(94573),Ee=i(33696),me=i(82054);function Te(r,e){return e}function $(r,e,t,s){switch(t){case 0:return J(r,e+s,0);case 1:return"lowerLeft"===r.originPosition?J(r,e+s,1):function Ze({translate:r,scale:e},t,s){return r[s]-t*e[s]}(r,e+s,1)}}function ge(r,e,t,s){return 2===t?J(r,e,2):$(r,e,t,s)}function je(r,e,t,s){return 2===t?J(r,e,3):$(r,e,t,s)}function De(r,e,t,s){return 3===t?J(r,e,3):ge(r,e,t,s)}function J({translate:r,scale:e},t,s){return r[s]+t*e[s]}class Pe{constructor(e){this.options=e,this.geometryTypes=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"],this.previousCoordinate=[0,0],this.transform=null,this.applyTransform=Te,this.lengths=[],this.currentLengthIndex=0,this.toAddInCurrentPath=0,this.vertexDimension=0,this.coordinateBuffer=null,this.coordinateBufferPtr=0,this._attributesConstructor=()=>{}}createFeatureResult(){return{fields:[],features:[]}}finishFeatureResult(e){if(this.options.applyTransform&&(e.transform=null),this._attributesConstructor=()=>{},this.coordinateBuffer=null,this.lengths.length=0,!e.hasZ)return;const t=(0,Ee.k)(e.geometryType,this.options.sourceSpatialReference,e.spatialReference);if(!(0,m.Wi)(t))for(const s of e.features)t(s.geometry)}createSpatialReference(){return{}}addField(e,t){e.fields.push(t);const s=e.fields.map(n=>n.name);this._attributesConstructor=function(){for(const n of s)this[n]=null}}addFeature(e,t){e.features.push(t)}prepareFeatures(e){switch(this.transform=e.transform,this.options.applyTransform&&e.transform&&(this.applyTransform=this._deriveApplyTransform(e)),this.vertexDimension=2,e.hasZ&&this.vertexDimension++,e.hasM&&this.vertexDimension++,e.geometryType){case"esriGeometryPoint":this.addCoordinate=(t,s,n)=>this.addCoordinatePoint(t,s,n),this.createGeometry=t=>this.createPointGeometry(t);break;case"esriGeometryPolygon":this.addCoordinate=(t,s,n)=>this._addCoordinatePolygon(t,s,n),this.createGeometry=t=>this._createPolygonGeometry(t);break;case"esriGeometryPolyline":this.addCoordinate=(t,s,n)=>this._addCoordinatePolyline(t,s,n),this.createGeometry=t=>this._createPolylineGeometry(t);break;case"esriGeometryMultipoint":this.addCoordinate=(t,s,n)=>this._addCoordinateMultipoint(t,s,n),this.createGeometry=t=>this._createMultipointGeometry(t);break;default:(0,Ce.Bg)(e.geometryType)}}createFeature(){return this.lengths.length=0,this.currentLengthIndex=0,this.previousCoordinate[0]=0,this.previousCoordinate[1]=0,this.coordinateBuffer=null,this.coordinateBufferPtr=0,{attributes:new this._attributesConstructor}}allocateCoordinates(){}addLength(e,t,s){0===this.lengths.length&&(this.toAddInCurrentPath=t),this.lengths.push(t)}addQueryGeometry(e,t){const{queryGeometry:s,queryGeometryType:n}=t,l=(0,me.$g)(s.clone(),s,!1,!1,this.transform),d=(0,me.di)(l,n,!1,!1);e.queryGeometryType=n,e.queryGeometry=u({},d)}createPointGeometry(e){const t={x:0,y:0,spatialReference:e.spatialReference};return e.hasZ&&(t.z=0),e.hasM&&(t.m=0),t}addCoordinatePoint(e,t,s){switch(t=this.applyTransform(this.transform,t,s,0),s){case 0:e.x=t;break;case 1:e.y=t;break;case 2:"z"in e?e.z=t:e.m=t;break;case 3:e.m=t}}_transformPathLikeValue(e,t){let s=0;return t<=1&&(s=this.previousCoordinate[t],this.previousCoordinate[t]+=e),this.applyTransform(this.transform,e,t,s)}_addCoordinatePolyline(e,t,s){this._dehydratedAddPointsCoordinate(e.paths,t,s)}_addCoordinatePolygon(e,t,s){this._dehydratedAddPointsCoordinate(e.rings,t,s)}_addCoordinateMultipoint(e,t,s){0===s&&e.points.push([]);const n=this._transformPathLikeValue(t,s);e.points[e.points.length-1].push(n)}_createPolygonGeometry(e){return{rings:[[]],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}}_createPolylineGeometry(e){return{paths:[[]],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}}_createMultipointGeometry(e){return{points:[],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}}_dehydratedAddPointsCoordinate(e,t,s){0===s&&0==this.toAddInCurrentPath--&&(e.push([]),this.toAddInCurrentPath=this.lengths[++this.currentLengthIndex]-1,this.previousCoordinate[0]=0,this.previousCoordinate[1]=0);const n=this._transformPathLikeValue(t,s),l=e[e.length-1];0===s&&(this.coordinateBufferPtr=0,this.coordinateBuffer=new Array(this.vertexDimension),l.push(this.coordinateBuffer)),this.coordinateBuffer[this.coordinateBufferPtr++]=n}_deriveApplyTransform(e){const{hasZ:t,hasM:s}=e;return t&&s?De:t?ge:s?je:$}}var Fe=i(20477),K=i(17253),H=i(84952);function Y(){return(Y=(0,p.Z)(function*(r,e,t){const s=(0,j.en)(r),n=u({},t),l=H.Z.from(e),d=!l.quantizationParameters,{data:c}=yield(0,Fe.executeQueryPBF)(s,l,new Pe({sourceSpatialReference:l.sourceSpatialReference,applyTransform:d}),n);return c})).apply(this,arguments)}var Ae=i(24263),w=i(76391),qe=i(87183);function Me(r){const e=r.toJSON();return e.attachmentTypes&&(e.attachmentTypes=e.attachmentTypes.join(",")),e.keywords&&(e.keywords=e.keywords.join(",")),e.globalIds&&(e.globalIds=e.globalIds.join(",")),e.objectIds&&(e.objectIds=e.objectIds.join(",")),e.size&&(e.size=e.size.join(",")),e}function xe(r,e){const t={};for(const s of r){const{parentObjectId:n,parentGlobalId:l,attachmentInfos:d}=s;for(const c of d){const{id:y}=c,h=(0,A.qg)((0,Ae.Dp)(`${e}/${n}/attachments/${y}`)),f=qe.Z.fromJSON(c);f.set({url:h,parentObjectId:n,parentGlobalId:l}),t[n]?t[n].push(f):t[n]=[f]}}return t}function Qe(r,e,t){let s={query:(0,w.A)(u(g(u({},r.query),{f:"json"}),Me(e)))};return t&&(s=g(u(u({},t),s),{query:u(u({},t.query),s.query)})),(0,O.default)(r.path+"/queryAttachments",s)}var Ge=i(67736);function k(){return(k=(0,p.Z)(function*(r,e,t){const s=(0,j.en)(r);return Qe(s,Ge.Z.from(e),u({},t)).then(n=>xe(n.data.attachmentGroups,s.path))})).apply(this,arguments)}var Je=i(90463);function ee(){return(ee=(0,p.Z)(function*(r,e,t){const s=(0,j.en)(r);return(0,Fe.executeQueryForExtent)(s,H.Z.from(e),u({},t)).then(n=>({count:n.data.count,extent:W.Z.fromJSON(n.data.extent)}))})).apply(this,arguments)}var Be=i(24865);function Le(r,e){const t=r.toJSON();return t.objectIds&&(t.objectIds=t.objectIds.join(",")),t.orderByFields&&(t.orderByFields=t.orderByFields.join(",")),t.outFields&&!(null==e?void 0:e.returnCountOnly)?t.outFields=t.outFields.includes("*")?"*":t.outFields.join(","):delete t.outFields,t.outSpatialReference&&(t.outSR=t.outSR.wkid||JSON.stringify(t.outSR.toJSON()),delete t.outSpatialReference),t.dynamicDataSource&&(t.layer=JSON.stringify({source:t.dynamicDataSource}),delete t.dynamicDataSource),t}function ze(r,e,t){return te.apply(this,arguments)}function te(){return(te=(0,p.Z)(function*(r,e,t){const s=yield Oe(r,e,t),n=s.data,l=n.geometryType,d=n.spatialReference,c={};for(const y of n.relatedRecordGroups){const h={fields:void 0,objectIdFieldName:void 0,geometryType:l,spatialReference:d,hasZ:!!n.hasZ,hasM:!!n.hasM,features:y.relatedRecords};if(null!=y.objectId)c[y.objectId]=h;else for(const f in y)y.hasOwnProperty(f)&&"relatedRecords"!==f&&(c[y[f]]=h)}return g(u({},s),{data:c})})).apply(this,arguments)}function Ve(r,e,t){return re.apply(this,arguments)}function re(){return(re=(0,p.Z)(function*(r,e,t){const s=yield Oe(r,e,t,{returnCountOnly:!0}),n=s.data,l={};for(const d of n.relatedRecordGroups)null!=d.objectId&&(l[d.objectId]=d.count);return g(u({},s),{data:l})})).apply(this,arguments)}function Oe(r,e){return se.apply(this,arguments)}function se(){return(se=(0,p.Z)(function*(r,e,t={},s){const n=(0,w.A)(u(u(g(u({},r.query),{f:"json"}),s),Le(e,s)));return(0,O.default)(r.path+"/queryRelatedRecords",g(u({},t),{query:u(u({},t.query),n)}))})).apply(this,arguments)}var B=i(67010);function ne(){return(ne=(0,p.Z)(function*(r,e,t){return e=B.Z.from(e),ze((0,j.en)(r),e,t).then(n=>{const l=n.data,d={};return Object.keys(l).forEach(c=>d[c]=K.default.fromJSON(l[c])),d})})).apply(this,arguments)}function oe(){return(oe=(0,p.Z)(function*(r,e,t){return e=B.Z.from(e),Ve((0,j.en)(r),e,u({},t)).then(n=>n.data)})).apply(this,arguments)}var Ke=i(13924),He=i(61515);const Se="Layer does not support extent calculation.";function Ye(r,e,t,s){return ae.apply(this,arguments)}function ae(){return(ae=(0,p.Z)(function*(r,e,t,s){const n=yield L(r,e,"json",s);return(0,He.p)(e,t,n.data),n})).apply(this,arguments)}function we(r,e,t){return ie.apply(this,arguments)}function ie(){return(ie=(0,p.Z)(function*(r,e,t){return(0,m.pC)(e.timeExtent)&&e.timeExtent.isEmpty?{data:{objectIds:[]}}:L(r,e,"json",t,{returnIdsOnly:!0})})).apply(this,arguments)}function ke(r,e,t){return ue.apply(this,arguments)}function ue(){return(ue=(0,p.Z)(function*(r,e,t){return(0,m.pC)(e.timeExtent)&&e.timeExtent.isEmpty?{data:{count:0,extent:null}}:L(r,e,"json",t,{returnExtentOnly:!0,returnCountOnly:!0}).then(s=>{const n=s.data;if(n.hasOwnProperty("extent"))return s;if(n.features)throw new Error(Se);if(n.hasOwnProperty("count"))throw new Error(Se);return s})})).apply(this,arguments)}function et(r,e,t){return(0,m.pC)(e.timeExtent)&&e.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):L(r,e,"json",t,{returnIdsOnly:!0,returnCountOnly:!0})}function L(r,e,t,s={},n={}){const l="string"==typeof r?(0,A.mN)(r):r,d=e.geometry?[e.geometry]:[];return s.responseType="pbf"===t?"array-buffer":"json",(0,Ke.aX)(d,null,s).then(c=>{const y=c&&c[0];(0,m.pC)(y)&&((e=e.clone()).geometry=y);const h=(0,w.A)(u(u(g(u({},l.query),{f:t}),n),function Xe(r,e){var l,d;const t=r.geometry,s=r.toJSON(),n=s;if((0,m.pC)(t)&&(n.geometry=JSON.stringify(t),n.geometryType=(0,he.Ji)(t),n.inSR=t.spatialReference.wkid||JSON.stringify(t.spatialReference)),(null==(l=s.topFilter)?void 0:l.groupByFields)&&(n.topFilter.groupByFields=s.topFilter.groupByFields.join(",")),(null==(d=s.topFilter)?void 0:d.orderByFields)&&(n.topFilter.orderByFields=s.topFilter.orderByFields.join(",")),s.topFilter&&(n.topFilter=JSON.stringify(n.topFilter)),s.objectIds&&(n.objectIds=s.objectIds.join(",")),s.orderByFields&&(n.orderByFields=s.orderByFields.join(",")),s.outFields&&!((null==e?void 0:e.returnCountOnly)||(null==e?void 0:e.returnExtentOnly)||(null==e?void 0:e.returnIdsOnly))?n.outFields=s.outFields.includes("*")?"*":s.outFields.join(","):delete n.outFields,s.outSR?n.outSR=s.outSR.wkid||JSON.stringify(s.outSR):t&&s.returnGeometry&&(n.outSR=n.inSR),s.returnGeometry&&delete s.returnGeometry,s.timeExtent){const c=s.timeExtent,{start:y,end:h}=c;null==y&&null==h||(n.time=y===h?y:`${null==y?"null":y},${null==h?"null":h}`),delete s.timeExtent}return n}(e,n)));return(0,O.default)((0,A.v_)(l.path,"queryTopFeatures"),g(u({},s),{query:u(u({},h),s.query)}))})}var z=i(6871);function le(){return(le=(0,p.Z)(function*(r,e,t,s){const n=(0,j.en)(r),l=u({},s),{data:d}=yield Ye(n,z.Z.from(e),t,l);return K.default.fromJSON(d)})).apply(this,arguments)}function de(){return(de=(0,p.Z)(function*(r,e,t){const s=(0,j.en)(r);return(yield we(s,z.Z.from(e),u({},t))).data.objectIds})).apply(this,arguments)}function ce(){return(ce=(0,p.Z)(function*(r,e,t){const s=(0,j.en)(r),n=yield ke(s,z.Z.from(e),u({},t));return{count:n.data.count,extent:W.Z.fromJSON(n.data.extent)}})).apply(this,arguments)}function pe(){return(pe=(0,p.Z)(function*(r,e,t){const s=(0,j.en)(r);return(yield et(s,z.Z.from(e),u({},t))).data.count})).apply(this,arguments)}var ot=i(14517);let G=class extends ot.Z{constructor(...r){super(...r),this.requestOptions=null,this.url=null}normalizeCtorArgs(r,e){return"string"!=typeof r?r:u({url:r},e)}get parsedUrl(){return this._parseUrl(this.url)}_parseUrl(r){return r?(0,A.mN)(r):null}_encode(r,e,t){const s={};for(const n in r){if("declaredClass"===n)continue;const l=r[n];if(null!=l&&"function"!=typeof l)if(Array.isArray(l)){s[n]=[];for(let d=0;d<l.length;d++)s[n][d]=this._encode(l[d])}else if("object"==typeof l)if(l.toJSON){const d=l.toJSON(t&&t[n]);s[n]=e?d:JSON.stringify(d)}else s[n]=e?l:JSON.stringify(l);else s[n]=l}return s}};(0,R._)([(0,x.Cb)({readOnly:!0})],G.prototype,"parsedUrl",null),(0,R._)([(0,x.Cb)()],G.prototype,"requestOptions",void 0),(0,R._)([(0,x.Cb)({type:String})],G.prototype,"url",void 0),G=(0,R._)([(0,V.j)("esri.tasks.Task")],G);const at=G;let D=class extends at{constructor(r){super(r),this.dynamicDataSource=null,this.fieldsIndex=null,this.format="json",this.gdbVersion=null,this.infoFor3D=null,this.sourceSpatialReference=null}execute(r,e){return this.executeJSON(r,e).then(t=>this.featureSetFromJSON(r,t,e))}executeJSON(r,e){var t=this;return(0,p.Z)(function*(){var h;const s=u(u({},t.requestOptions),e),n=t._normalizeQuery(r),l=null!=(null==(h=r.outStatistics)?void 0:h[0]),d=(0,I.Z)("featurelayer-pbf-statistics"),c=!l||d;let y;if("pbf"===t.format&&c)try{y=yield function Re(r,e,t){return Y.apply(this,arguments)}(t.url,n,s)}catch(f){if("query:parsing-pbf"!==f.name)throw f;t.format="json"}return"json"!==t.format&&c||(y=yield(0,be.F)(t.url,n,s)),t._normalizeFields(y.fields),y})()}featureSetFromJSON(r,e,t){var s=this;return(0,p.Z)(function*(){if(!s._queryIs3DObjectFormat(r)||(0,m.Wi)(s.infoFor3D)||!e.features||!e.features.length)return K.default.fromJSON(e);const{meshFeatureSetFromJSON:n}=yield(0,Q.Hl)(Promise.all([i.e(479),i.e(853),i.e(5678)]).then(i.bind(i,25678)),t);return n(r,s.infoFor3D,e)})()}executeForCount(r,e){const t=u(u({},this.requestOptions),e),s=this._normalizeQuery(r);return(0,Je.P)(this.url,s,t)}executeForExtent(r,e){const t=u(u({},this.requestOptions),e),s=this._normalizeQuery(r);return function Ue(r,e,t){return ee.apply(this,arguments)}(this.url,s,t)}executeForIds(r,e){const t=u(u({},this.requestOptions),e),s=this._normalizeQuery(r);return(0,Be.G)(this.url,s,t)}executeRelationshipQuery(r,e){r=B.Z.from(r);const t=u(u({},this.requestOptions),e);return(this.gdbVersion||this.dynamicDataSource)&&((r=r.clone()).gdbVersion=r.gdbVersion||this.gdbVersion,r.dynamicDataSource=r.dynamicDataSource||this.dynamicDataSource),function We(r,e,t){return ne.apply(this,arguments)}(this.url,r,t)}executeRelationshipQueryForCount(r,e){r=B.Z.from(r);const t=u(u({},this.requestOptions),e);return(this.gdbVersion||this.dynamicDataSource)&&((r=r.clone()).gdbVersion=r.gdbVersion||this.gdbVersion,r.dynamicDataSource=r.dynamicDataSource||this.dynamicDataSource),function $e(r,e,t){return oe.apply(this,arguments)}(this.url,r,t)}executeAttachmentQuery(r,e){const t=u(u({},this.requestOptions),e);return function Ne(r,e,t){return k.apply(this,arguments)}(this.url,r,t)}executeTopFeaturesQuery(r,e){const t=u(u({},this.requestOptions),e);return function tt(r,e,t,s){return le.apply(this,arguments)}(this.parsedUrl,r,this.sourceSpatialReference,t)}executeForTopIds(r,e){const t=u(u({},this.requestOptions),e);return function rt(r,e,t){return de.apply(this,arguments)}(this.parsedUrl,r,t)}executeForTopExtents(r,e){const t=u(u({},this.requestOptions),e);return function st(r,e,t){return ce.apply(this,arguments)}(this.parsedUrl,r,t)}executeForTopCount(r,e){const t=u(u({},this.requestOptions),e);return function nt(r,e,t){return pe.apply(this,arguments)}(this.parsedUrl,r,t)}_normalizeQuery(r){let e=H.Z.from(r);if(e.sourceSpatialReference=e.sourceSpatialReference||this.sourceSpatialReference,(this.gdbVersion||this.dynamicDataSource)&&(e=e===r?e.clone():e,e.gdbVersion=r.gdbVersion||this.gdbVersion,e.dynamicDataSource=r.dynamicDataSource?fe.n.from(r.dynamicDataSource):this.dynamicDataSource),(0,m.pC)(this.infoFor3D)&&this._queryIs3DObjectFormat(r)){e=e===r?e.clone():e,e.formatOf3DObjects=null;for(const t of this.infoFor3D.queryFormats){if("3D_glb"===t.id){e.formatOf3DObjects=t.id;break}"3D_gltf"!==t.id||e.formatOf3DObjects||(e.formatOf3DObjects=t.id)}if(!e.formatOf3DObjects)throw new _.Z("query:unsupported-3d-query-formats","Could not find any supported 3D object query format. Only supported formats are 3D_glb and 3D_gltf");if((0,m.Wi)(e.outFields)||!e.outFields.includes("*")){e=e===r?e.clone():e,(0,m.Wi)(e.outFields)&&(e.outFields=[]);const{originX:t,originY:s,originZ:n,translationX:l,translationY:d,translationZ:c,scaleX:y,scaleY:h,scaleZ:f,rotationX:Z,rotationY:P,rotationZ:C,rotationDeg:U}=this.infoFor3D.transformFieldRoles;e.outFields.push(t,s,n,l,d,c,y,h,f,Z,P,C,U)}}return e}_normalizeFields(r){if((0,m.pC)(this.fieldsIndex)&&(0,m.pC)(r))for(const e of r){const t=this.fieldsIndex.get(e.name);t&&Object.assign(e,t.toJSON())}}_queryIs3DObjectFormat(r){return(0,m.pC)(this.infoFor3D)&&r.returnGeometry&&"xyFootprint"!==r.multipatchOption&&!r.outStatistics}};(0,R._)([(0,x.Cb)({type:fe.n})],D.prototype,"dynamicDataSource",void 0),(0,R._)([(0,x.Cb)()],D.prototype,"fieldsIndex",void 0),(0,R._)([(0,x.Cb)()],D.prototype,"format",void 0),(0,R._)([(0,x.Cb)()],D.prototype,"gdbVersion",void 0),(0,R._)([(0,x.Cb)()],D.prototype,"infoFor3D",void 0),(0,R._)([(0,x.Cb)()],D.prototype,"sourceSpatialReference",void 0),D=(0,R._)([(0,V.j)("esri.tasks.QueryTask")],D);const it=D;var ut=i(20514),lt=i(65234);const dt=new T.X({originalAndCurrentFeatures:"original-and-current-features",none:"none"});function ye(){return(ye=(0,p.Z)(function*(r){return"string"==typeof r?(0,A.sJ)(r)||{data:r}:new Promise((e,t)=>{const s=new FileReader;s.readAsDataURL(r),s.onload=()=>e((0,A.sJ)(s.result)),s.onerror=n=>t(n)})})).apply(this,arguments)}const pt=new Set(["Feature Layer","Table"]);let N=class extends q.Z{constructor(){var r;super(...arguments),r=this,this.type="feature-layer",this.refresh=(0,Q.Ds)((0,p.Z)(function*(){var s,n;yield r.load();const e=null==(s=r.sourceJSON.editingInfo)?void 0:s.lastEditDate;if(null==e)return{dataChanged:!0,updates:{}};try{yield r._fetchService(null)}catch(l){return{dataChanged:!0,updates:{}}}const t=e!==(null==(n=r.sourceJSON.editingInfo)?void 0:n.lastEditDate);return{dataChanged:t,updates:t?{editingInfo:r.sourceJSON.editingInfo,extent:r.sourceJSON.extent}:null}}))}load(r){const e=(0,m.pC)(r)?r.signal:null;return this.addResolvingPromise(this._fetchService(this.layer.sourceJSON,e)),Promise.resolve(this)}get queryTask(){const{capabilities:{query:{supportsFormatPBF:r}},parsedUrl:e,dynamicDataSource:t,infoFor3D:s,gdbVersion:n,spatialReference:l,fieldsIndex:d}=this.layer,c=(0,I.Z)("featurelayer-pbf")&&r&&(0,m.Wi)(s)?"pbf":"json";return new it({url:e.path,format:c,fieldsIndex:d,infoFor3D:s,dynamicDataSource:t,gdbVersion:n,sourceSpatialReference:l})}addAttachment(r,e){var t=this;return(0,p.Z)(function*(){yield t.load();const s=r.attributes[t.layer.objectIdField],n=t.layer.parsedUrl.path+"/"+s+"/addAttachment",l=t._getLayerRequestOptions(),d=t._getFormDataForAttachment(e,l.query);try{const c=yield(0,O.default)(n,{body:d});return t._createFeatureEditResult(c.data.addAttachmentResult)}catch(c){throw t._createAttachmentErrorResult(s,c)}})()}updateAttachment(r,e,t){var s=this;return(0,p.Z)(function*(){yield s.load();const n=r.attributes[s.layer.objectIdField],l=s.layer.parsedUrl.path+"/"+n+"/updateAttachment",d=s._getLayerRequestOptions({query:{attachmentId:e}}),c=s._getFormDataForAttachment(t,d.query);try{const y=yield(0,O.default)(l,{body:c});return s._createFeatureEditResult(y.data.updateAttachmentResult)}catch(y){throw s._createAttachmentErrorResult(n,y)}})()}applyEdits(r,e){var t=this;return(0,p.Z)(function*(){yield t.load();const s=r.addFeatures.map(t._serializeFeature,t),n=r.updateFeatures.map(t._serializeFeature,t),l=t._getFeatureIds(r.deleteFeatures,null==e?void 0:e.globalIdUsed);(0,ut.P)(s,n,t.layer.spatialReference);const d=[],c=[],y=[...r.deleteAttachments];for(const U of r.addAttachments)d.push(yield t._serializeAttachment(U));for(const U of r.updateAttachments)c.push(yield t._serializeAttachment(U));const h=d.length||c.length||y.length?{adds:d,updates:c,deletes:y}:null,f={gdbVersion:(null==e?void 0:e.gdbVersion)||t.layer.gdbVersion,rollbackOnFailure:null==e?void 0:e.rollbackOnFailureEnabled,useGlobalIds:null==e?void 0:e.globalIdUsed,returnEditMoment:null==e?void 0:e.returnEditMoment,usePreviousEditMoment:null==e?void 0:e.usePreviousEditMoment,sessionId:null==e?void 0:e.sessionId};(null==e?void 0:e.returnServiceEditsOption)?(f.edits=JSON.stringify([{id:t.layer.layerId,adds:s,updates:n,deletes:l,attachments:h}]),f.returnServiceEditsOption=dt.toJSON(null==e?void 0:e.returnServiceEditsOption),f.returnServiceEditsInSourceSR=null==e?void 0:e.returnServiceEditsInSourceSR):(f.adds=s.length?JSON.stringify(s):null,f.updates=n.length?JSON.stringify(n):null,f.deletes=l.length?(null==e?void 0:e.globalIdUsed)?JSON.stringify(l):l.join(","):null,f.attachments=h&&JSON.stringify(h));const Z=t._getLayerRequestOptions({method:"post",query:f}),P=(null==e?void 0:e.returnServiceEditsOption)?t.layer.url:t.layer.parsedUrl.path,C=yield(0,O.default)(P+"/applyEdits",Z);return t._createEditsResult(C)})()}deleteAttachments(r,e){var t=this;return(0,p.Z)(function*(){yield t.load();const s=r.attributes[t.layer.objectIdField],n=t.layer.parsedUrl.path+"/"+s+"/deleteAttachments";try{return(yield(0,O.default)(n,t._getLayerRequestOptions({query:{attachmentIds:e.join(",")},method:"post"}))).data.deleteAttachmentResults.map(t._createFeatureEditResult)}catch(l){throw t._createAttachmentErrorResult(s,l)}})()}fetchRecomputedExtents(r={}){var e=this;return this.load({signal:r.signal}).then((0,p.Z)(function*(){const s=e._getLayerRequestOptions(g(u({},r),{query:{returnUpdates:!0}})),{layerId:n,url:l}=e.layer,{data:d}=yield(0,O.default)(`${l}/${n}`,s),{id:c,extent:y,fullExtent:h,timeExtent:f}=d,Z=y||h;return{id:c,fullExtent:Z&&W.Z.fromJSON(Z),timeExtent:f&&v.Z.fromJSON({start:f[0],end:f[1]})}}))}queryAttachments(r,e={}){var t=this;return(0,p.Z)(function*(){const{parsedUrl:s}=t.layer,n=s.path;yield t.load();const l=t._getLayerRequestOptions(e);if(!t.layer.get("capabilities.operations.supportsQueryAttachments")){const{objectIds:d}=r,c=[];for(const y of d)c.push((0,O.default)(n+"/"+y+"/attachments",l));return Promise.all(c).then(y=>d.map((h,f)=>({parentObjectId:h,attachmentInfos:y[f].data.attachmentInfos}))).then(y=>xe(y,n))}return t.queryTask.executeAttachmentQuery(r,l)})()}queryFeatures(r,e){var t=this;return(0,p.Z)(function*(){return yield t.load(),t.queryTask.execute(r,g(u({},e),{query:t._createRequestQueryOptions(e)}))})()}queryFeaturesJSON(r,e){var t=this;return(0,p.Z)(function*(){return yield t.load(),t.queryTask.executeJSON(r,g(u({},e),{query:t._createRequestQueryOptions(e)}))})()}queryObjectIds(r,e){var t=this;return(0,p.Z)(function*(){return yield t.load(),t.queryTask.executeForIds(r,g(u({},e),{query:t._createRequestQueryOptions(e)}))})()}queryFeatureCount(r,e){var t=this;return(0,p.Z)(function*(){return yield t.load(),t.queryTask.executeForCount(r,g(u({},e),{query:t._createRequestQueryOptions(e)}))})()}queryExtent(r,e){var t=this;return(0,p.Z)(function*(){return yield t.load(),t.queryTask.executeForExtent(r,g(u({},e),{query:t._createRequestQueryOptions(e)}))})()}queryRelatedFeatures(r,e){var t=this;return(0,p.Z)(function*(){return yield t.load(),t.queryTask.executeRelationshipQuery(r,g(u({},e),{query:t._createRequestQueryOptions(e)}))})()}queryRelatedFeaturesCount(r,e){var t=this;return(0,p.Z)(function*(){return yield t.load(),t.queryTask.executeRelationshipQueryForCount(r,g(u({},e),{query:t._createRequestQueryOptions(e)}))})()}queryTopFeatures(r,e){var t=this;return(0,p.Z)(function*(){return yield t.load(),t.queryTask.executeTopFeaturesQuery(r,g(u({},e),{query:t._createRequestQueryOptions(e)}))})()}queryTopObjectIds(r,e){var t=this;return(0,p.Z)(function*(){return yield t.load(),t.queryTask.executeForTopIds(r,g(u({},e),{query:t._createRequestQueryOptions(e)}))})()}queryTopExtents(r,e){var t=this;return(0,p.Z)(function*(){return yield t.load(),t.queryTask.executeForTopExtents(r,g(u({},e),{query:t._createRequestQueryOptions(e)}))})()}queryTopCount(r,e){var t=this;return(0,p.Z)(function*(){return yield t.load(),t.queryTask.executeForTopCount(r,g(u({},e),{query:t._createRequestQueryOptions(e)}))})()}_createRequestQueryOptions(r){const e=u(g(u({},this.layer.customParameters),{token:this.layer.apiKey}),null==r?void 0:r.query);return this.layer.datesInUnknownTimezone&&(e.timeReferenceUnknownClient=!0),e}_fetchService(r,e){var t=this;return(0,p.Z)(function*(){if(!r){const{data:n}=yield(0,O.default)(t.layer.parsedUrl.path,t._getLayerRequestOptions({query:(0,I.Z)("featurelayer-advanced-symbols")?{returnAdvancedSymbols:!0}:{},signal:e}));r=n}t.sourceJSON=t._patchServiceJSON(r);const s=r.type;if(!pt.has(s))throw new _.Z("feature-layer-source:unsupported-type",`Source type "${s}" is not supported`)})()}_patchServiceJSON(r){var e;if("Table"!==r.type&&r.geometryType&&!(null==(e=null==r?void 0:r.drawingInfo)?void 0:e.renderer)&&!r.defaultSymbol){const t=(0,Ie.bU)(r.geometryType).renderer;(0,b.RB)("drawingInfo.renderer",t,r)}return"esriGeometryMultiPatch"===r.geometryType&&r.infoFor3D&&(r.geometryType="mesh"),r}_serializeFeature(r){const{geometry:e,attributes:t}=r;return(0,m.Wi)(e)?{attributes:t}:"mesh"===e.type||"extent"===e.type?null:{geometry:e.toJSON(),attributes:t}}_serializeAttachment(r){var e=this;return(0,p.Z)(function*(){const{feature:t,attachment:s}=r,{globalId:n,name:l,contentType:d,data:c,uploadId:y}=s,h={globalId:n,parentGlobalId:null,contentType:null,name:null,uploadId:null,data:null};if(t&&(h.parentGlobalId="attributes"in t?t.attributes&&t.attributes[e.layer.globalIdField]:t.globalId),y)h.uploadId=y;else if(c){const f=yield function ct(r){return ye.apply(this,arguments)}(c);h.contentType=f.mediaType,h.data=f.data,c instanceof File&&(h.name=c.name)}return l&&(h.name=l),d&&(h.contentType=d),h})()}_getFeatureIds(r,e){const t=r[0];return t?this._canUseGlobalIds(e,r)?this._getGlobalIdsFromFeatureIdentifier(r):"objectId"in t?this._getObjectIdsFromFeatureIdentifier(r):this._getIdsFromFeatures(r):[]}_getIdsFromFeatures(r){const e=this.layer.objectIdField;return r.map(t=>t.attributes&&t.attributes[e])}_canUseGlobalIds(r,e){return r&&"globalId"in e[0]}_getObjectIdsFromFeatureIdentifier(r){return r.map(e=>e.objectId)}_getGlobalIdsFromFeatureIdentifier(r){return r.map(e=>e.globalId)}_createEditsResult(r){const e=r.data,{layerId:t}=this.layer,s=[];let n=null;if(Array.isArray(e))for(const c of e)s.push({id:c.id,editedFeatures:c.editedFeatures}),c.id===t&&(n={addResults:c.addResults,updateResults:c.updateResults,deleteResults:c.deleteResults,attachments:c.attachments,editMoment:c.editMoment});else n=e;const l=null==n?void 0:n.attachments,d={addFeatureResults:n.addResults?n.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:n.updateResults?n.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:n.deleteResults?n.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:l&&l.addResults?l.addResults.map(this._createFeatureEditResult,this):[],updateAttachmentResults:l&&l.updateResults?l.updateResults.map(this._createFeatureEditResult,this):[],deleteAttachmentResults:l&&l.deleteResults?l.deleteResults.map(this._createFeatureEditResult,this):[]};if(n.editMoment&&(d.editMoment=n.editMoment),s.length>0){d.editedFeatureResults=[];for(const c of s){const{adds:y,updates:h,deletes:f,spatialReference:Z}=c.editedFeatures,P=Z?new lt.Z(Z):null;d.editedFeatureResults.push({layerId:c.id,editedFeatures:{adds:(null==y?void 0:y.map(C=>this._createEditedFeature(C,P)))||[],updates:(null==h?void 0:h.map(C=>({original:this._createEditedFeature(C[0],P),current:this._createEditedFeature(C[1],P)})))||[],deletes:(null==f?void 0:f.map(C=>this._createEditedFeature(C,P)))||[],spatialReference:P}})}}return d}_createEditedFeature(r,e){return new E.Z({attributes:r.attributes,geometry:(0,he.im)(g(u({},r.geometry),{spatialReference:e}))})}_createFeatureEditResult(r){const e=!0===r.success?null:r.error||{code:void 0,description:void 0};return{objectId:r.objectId,globalId:r.globalId,error:e?new _.Z("feature-layer-source:edit-failure",e.description,{code:e.code}):null}}_createAttachmentErrorResult(r,e){return{objectId:r,globalId:null,error:new _.Z("feature-layer-source:attachment-failure",e.details.messages&&e.details.messages[0]||e.message,{code:e.details.httpStatus||e.details.messageCode})}}_getFormDataForAttachment(r,e){const t=r instanceof FormData?r:r&&r.elements?new FormData(r):null;if(t)for(const s in e){const n=e[s];null!=n&&(t.set?t.set(s,n):t.append(s,n))}return t}_getLayerRequestOptions(r={}){const{parsedUrl:e,gdbVersion:t,dynamicDataSource:s}=this.layer;return g(u({},r),{query:u(g(u({gdbVersion:t,layer:s?JSON.stringify({source:s}):void 0},e.query),{f:"json"}),this._createRequestQueryOptions(r)),responseType:"json"})}};(0,R._)([(0,x.Cb)()],N.prototype,"type",void 0),(0,R._)([(0,x.Cb)({constructOnly:!0})],N.prototype,"layer",void 0),(0,R._)([(0,x.Cb)({readOnly:!0})],N.prototype,"queryTask",null),N=(0,R._)([(0,V.j)("esri.layers.graphics.sources.FeatureLayerSource")],N);const yt=N},56554:(S,F,i)=>{i.d(F,{Dm:()=>I,Hq:()=>T,MS:()=>q,bU:()=>O});var p=i(8314),R=i(58817),M=i(87757),E=i(24837);function O(m){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===m||"esriGeometryMultipoint"===m?E.I4:"esriGeometryPolyline"===m?E.ET:E.lF}}}const v=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let _=1;function I(m,b){if((0,p.Z)("esri-csp-restrictions"))return()=>u({[b]:null},m);try{let Q=`this.${b} = null;`;for(const x in m)Q+=`this${v.test(x)?`.${x}`:`["${x}"]`} = ${JSON.stringify(m[x])};`;const A=new Function(`\n      return class AttributesClass$${_++} {\n        constructor() {\n          ${Q};\n        }\n      }\n    `)();return()=>new A}catch(Q){return()=>u({[b]:null},m)}}function T(m={}){return[{name:"New Feature",description:"",prototype:{attributes:(0,R.d9)(m)}}]}function q(m,b){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:m},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:b,supportsDelete:b,supportsEditing:b,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:b,supportsExceedsLimitStatistics:!0},query:M.g,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:b,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1}}}},90463:(S,F,i)=>{i.d(F,{P:()=>O});var p=i(15861),R=i(2618),M=i(20477),E=i(84952);function O(_,I,T){return v.apply(this,arguments)}function v(){return(v=(0,p.Z)(function*(_,I,T){const q=(0,R.en)(_);return(0,M.executeQueryForCount)(q,E.Z.from(I),u({},T)).then(m=>m.data.count)})).apply(this,arguments)}},24865:(S,F,i)=>{i.d(F,{G:()=>O});var p=i(15861),R=i(2618),M=i(20477),E=i(84952);function O(_,I,T){return v.apply(this,arguments)}function v(){return(v=(0,p.Z)(function*(_,I,T){const q=(0,R.en)(_);return(0,M.executeQueryForIds)(q,E.Z.from(I),u({},T)).then(m=>m.data.objectIds)})).apply(this,arguments)}}}]);