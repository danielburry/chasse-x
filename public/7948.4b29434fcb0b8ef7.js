"use strict";var sr=Object.defineProperty,or=Object.defineProperties,ar=Object.getOwnPropertyDescriptors,U=Object.getOwnPropertySymbols,ir=Object.prototype.hasOwnProperty,_r=Object.prototype.propertyIsEnumerable,j=(O,_,r)=>_ in O?sr(O,_,{enumerable:!0,configurable:!0,writable:!0,value:r}):O[_]=r,p=(O,_)=>{for(var r in _||(_={}))ir.call(_,r)&&j(O,r,_[r]);if(U)for(var r of U(_))_r.call(_,r)&&j(O,r,_[r]);return O},D=(O,_)=>or(O,ar(_));(self.webpackChunkchasse_pwa_front=self.webpackChunkchasse_pwa_front||[]).push([[7948],{48887:(O,_,r)=>{r.r(_),r.d(_,{default:()=>tr});var f=r(15861),o=r(17626),v=r(84792),u=r(97478),E=r(26584),M=r(80542),I=r(47877),A=r(62208),S=r(99959),T=r(10699),l=r(77712),x=(r(85931),r(8314),r(90912)),K=r(68653),B=r(76898),W=r(99433),g=r(31283),b=r(2004),F=r(83137),N=r(44917),J=r(50085),Z=r(19027),V=r(65088),$=r(552),G=r(50107),z=r(49286),H=r(6647),Q=r(30346),Y=r(99555),X=r(66120),w=r(97941),k=r(13812),q=r(14772),rr=r(39058),R=r(13410),er=r(5676);let a=class extends((0,$.h)((0,w.n)((0,Y.M)((0,X.x)((0,Z.O)((0,V.Y)((0,z.q)((0,H.I)((0,S.R)((0,Q.Q)((0,J.V)((0,G.N)((0,M.p)(N.Z)))))))))))))){constructor(...e){super(...e),this.datesInUnknownTimezone=!1,this.dpi=96,this.gdbVersion=null,this.imageFormat="png24",this.imageMaxHeight=2048,this.imageMaxWidth=2048,this.imageTransparency=!0,this.isReference=null,this.labelsVisible=!1,this.operationalLayerType="ArcGISMapServiceLayer",this.sourceJSON=null,this.sublayers=null,this.type="map-image",this.url=null}normalizeCtorArgs(e,t){return"string"==typeof e?p({url:e},t):e}load(e){const t=(0,A.pC)(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Map Service"]},e).catch(T.r9).then(()=>this._fetchService(t))),Promise.resolve(this)}readImageFormat(e,t){const c=t.supportedImageFormatTypes;return c&&c.includes("PNG32")?"png32":"png24"}writeSublayers(e,t,c,s){if(!this.loaded||!e)return;const i=e.slice().reverse().flatten(({sublayers:n})=>n&&n.toArray().reverse()).toArray();let y=!1;if(this.capabilities&&this.capabilities.operations.supportsExportMap&&this.capabilities.exportMap.supportsDynamicLayers){const n=(0,g.M9)(s.origin);if(n===g.s3.PORTAL_ITEM){const P=this.createSublayersForOrigin("service").sublayers;y=(0,R.QV)(i,P,g.s3.SERVICE)}else if(n>g.s3.PORTAL_ITEM){const P=this.createSublayersForOrigin("portal-item");y=(0,R.QV)(i,P.sublayers,(0,g.M9)(P.origin))}}const d=[],h=p({writeSublayerStructure:y},s);let m=y;i.forEach(n=>{const P=n.write({},h);d.push(P),m=m||"user"===n.originOf("visible")}),d.some(n=>Object.keys(n).length>1)&&(t.layers=d),m&&(t.visibleLayers=i.filter(n=>n.visible).map(n=>n.id))}createExportImageParameters(e,t,c,s){const i=s&&s.pixelRatio||1;e&&this.version>=10&&(e=e.clone().shiftCentralMeridian());const y=new q.R({layer:this,floors:null==s?void 0:s.floors,scale:(0,F.yZ)({extent:e,width:t})*i}),d=y.toJSON();y.destroy();const h=!s||!s.rotation||this.version<10.3?{}:{rotation:-s.rotation},m=e&&e.spatialReference,n=m.wkid||JSON.stringify(m.toJSON());d.dpi*=i;const P={};if(null==s?void 0:s.timeExtent){const{start:C,end:L}=s.timeExtent.toJSON();P.time=C&&L&&C===L?""+C:`${null==C?"null":C},${null==L?"null":L}`}else this.timeInfo&&!this.timeInfo.hasLiveData&&(P.time="null,null");return p(p(p({bbox:e&&e.xmin+","+e.ymin+","+e.xmax+","+e.ymax,bboxSR:n,imageSR:n,size:t+","+c},d),h),P)}fetchImage(e,t,c,s){var i=this;return(0,f.Z)(function*(){var h;const y={responseType:"image",signal:null!=(h=null==s?void 0:s.signal)?h:null,query:D(p(p(D(p(p({},i.parsedUrl.query),i.createExportImageParameters(e,t,c,s)),{f:"image"}),i.refreshParameters),i.customParameters),{token:i.apiKey})},d=i.parsedUrl.path+"/export";if(null!=y.query.dynamicLayers&&!i.capabilities.exportMap.supportsDynamicLayers)throw new E.Z("mapimagelayer:dynamiclayer-not-supported",`service ${i.url} doesn't support dynamic layers, which is required to be able to change the sublayer's order, rendering, labeling or source.`,{query:y.query});return(0,v.default)(d,y).then(m=>m.data).catch(m=>{throw(0,T.D_)(m)?m:new E.Z("mapimagelayer:image-fetch-error",`Unable to load image: ${d}`,{error:m})})})()}fetchRecomputedExtents(e={}){var t=this;return(0,f.Z)(function*(){const c=D(p({},e),{query:D(p({returnUpdates:!0,f:"json"},t.customParameters),{token:t.apiKey})}),{data:s}=yield(0,v.default)(t.url,c),{extent:i,fullExtent:y,timeExtent:d}=s,h=i||y;return{fullExtent:h&&b.Z.fromJSON(h),timeExtent:d&&u.Z.fromJSON({start:d[0],end:d[1]})}})()}loadAll(){return(0,I.G)(this,e=>{e(this.allSublayers)})}serviceSupportsSpatialReference(e){return(0,er.D)(this,e)}_fetchService(e){var t=this;return(0,f.Z)(function*(){if(t.sourceJSON)return void t.read(t.sourceJSON,{origin:"service",url:t.parsedUrl});const{data:c,ssl:s}=yield(0,v.default)(t.parsedUrl.path,{query:D(p(p({f:"json"},t.parsedUrl.query),t.customParameters),{token:t.apiKey}),signal:e});s&&(t.url=t.url.replace(/^http:/i,"https:")),t.sourceJSON=c,t.read(c,{origin:"service",url:t.parsedUrl})})()}};(0,o._)([(0,l.Cb)({type:Boolean})],a.prototype,"datesInUnknownTimezone",void 0),(0,o._)([(0,l.Cb)()],a.prototype,"dpi",void 0),(0,o._)([(0,l.Cb)()],a.prototype,"gdbVersion",void 0),(0,o._)([(0,l.Cb)()],a.prototype,"imageFormat",void 0),(0,o._)([(0,K.r)("imageFormat",["supportedImageFormatTypes"])],a.prototype,"readImageFormat",null),(0,o._)([(0,l.Cb)({json:{origins:{service:{read:{source:"maxImageHeight"}}}}})],a.prototype,"imageMaxHeight",void 0),(0,o._)([(0,l.Cb)({json:{origins:{service:{read:{source:"maxImageWidth"}}}}})],a.prototype,"imageMaxWidth",void 0),(0,o._)([(0,l.Cb)()],a.prototype,"imageTransparency",void 0),(0,o._)([(0,l.Cb)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],a.prototype,"isReference",void 0),(0,o._)([(0,l.Cb)({json:{read:!1,write:!1}})],a.prototype,"labelsVisible",void 0),(0,o._)([(0,l.Cb)({type:["ArcGISMapServiceLayer"]})],a.prototype,"operationalLayerType",void 0),(0,o._)([(0,l.Cb)({json:{read:!1,write:!1}})],a.prototype,"popupEnabled",void 0),(0,o._)([(0,l.Cb)()],a.prototype,"sourceJSON",void 0),(0,o._)([(0,l.Cb)({json:{write:{ignoreOrigin:!0}}})],a.prototype,"sublayers",void 0),(0,o._)([(0,W.c)("sublayers",{layers:{type:[rr.Z]},visibleLayers:{type:[x.z8]}})],a.prototype,"writeSublayers",null),(0,o._)([(0,l.Cb)({type:["show","hide","hide-children"]})],a.prototype,"listMode",void 0),(0,o._)([(0,l.Cb)({json:{read:!1},readOnly:!0,value:"map-image"})],a.prototype,"type",void 0),(0,o._)([(0,l.Cb)(k.HQ)],a.prototype,"url",void 0),a=(0,o._)([(0,B.j)("esri.layers.MapImageLayer")],a);const tr=a},59990:(O,_,r)=>{function f(u){var M;const E=u.layer;return"floorInfo"in E&&(null==(M=E.floorInfo)?void 0:M.floorField)&&"floors"in u.view?v(u.view.floors,E.floorInfo.floorField):null}function o(u,E){var M;return"floorInfo"in E&&(null==(M=E.floorInfo)?void 0:M.floorField)?v(u,E.floorInfo.floorField):null}function v(u,E){if(!(null==u?void 0:u.length))return null;const M=u.filter(I=>""!==I).map(I=>`'${I}'`);return M.push("''"),`${E} IN (${M.join(",")}) OR ${E} IS NULL`}r.d(_,{c:()=>f,f:()=>o})}}]);